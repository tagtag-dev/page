import"./ScrollArea-CW0-18Hy.js";import"./RovingFocusItem-DihGLheP.js";import{t as e}from"./button-Bo4o88Eb.js";import"./Presence-CX2vXdhf.js";import"./defu-BJL4Fjh2.js";import"./usePrimitiveElement-bvCn2QxH.js";import"./TabsTrigger-EHjOJe4X.js";import{Ct as t,Di as ee,Ea as te,Gi as ne,Jn as n,Kn as r,M as i,Mn as a,S as o,Ti as s,Ui as c,Yi as l,_i as u,_t as d,bi as f,bt as p,da as m,fi as re,ga as h,ka as g,oa as _,pt as ie,vi as v,wa as y,wi as b,xi as x,yi as S,z as C}from"./index-D9LA8apy.js";import"./en_US-N9Q-_HQi.js";import"./common-rttX-sZZ.js";import"./zh_CN-RQJLYl9H.js";import"./useTabBar-WvhELTvw.js";import{n as ae,t as oe}from"./CardContent-bGWyUVF7.js";import{n as se,t as ce}from"./CardTitle-9YsRePqj.js";import{s as w,w as T}from"./dist-guKItzxh.js";import{t as le}from"./TTable-BJXg8Gts.js";import{t as E}from"./TForm-De-AxzjP.js";import"./Input-DxyLxkUT.js";import"./TIcon-DpsAxes7.js";import{t as D}from"./TModal-l0DmcJma.js";import{n as ue,r as O}from"./composables-B_2v-ght.js";import"./constants-BrhrixW3.js";var de={class:`space-y-6`},fe={class:`flex flex-col sm:flex-row sm:items-center justify-between gap-4`},pe={class:`flex flex-wrap gap-3`},k={class:`flex items-baseline gap-2`},A={class:`text-lg font-semibold`},j={class:`text-xs text-muted-foreground`},M={class:`bg-muted/30 rounded-lg p-4`},me={class:`flex flex-col lg:flex-row lg:items-center gap-4`},N={class:`flex-1`},P={key:0,class:`flex items-center gap-2 lg:border-l lg:pl-4`},F={class:`text-sm text-muted-foreground`},I={class:`flex items-center justify-between`},L={class:`flex items-center gap-3`},R={class:`text-xs text-muted-foreground bg-muted px-2 py-0.5 rounded-full`},z={class:`flex items-center gap-2 text-sm text-muted-foreground`},he={class:`font-mono font-medium`},ge={class:`font-medium`},_e={class:`text-xs text-muted-foreground`},ve={class:`font-medium text-primary`},ye={class:`flex flex-col items-center justify-center py-12 text-muted-foreground`},be={class:`w-16 h-16 rounded-full bg-muted flex items-center justify-center mb-4`},xe={key:0,class:`space-y-6`},Se={class:`flex items-center justify-between p-4 bg-muted/50 rounded-lg`},Ce={class:`font-mono font-medium`},we={class:`space-y-3`},Te={class:`grid grid-cols-2 gap-4 text-sm`},Ee={class:`col-span-2`},De={class:`space-y-3`},Oe={class:`grid grid-cols-2 gap-4 text-sm`},ke={class:`font-medium text-primary`},Ae={class:`col-span-2`},je={key:0,class:`space-y-3`},Me={class:`text-sm text-muted-foreground p-3 bg-muted/50 rounded-lg`},Ne={class:`flex justify-end gap-2 pt-4 border-t`},B=ee({__name:`Orders`,setup(ee){let{data:B,loading:Pe,searchQuery:V,filters:H,currentPage:Fe,pageSize:Ie,total:Le,statistics:U,fetchData:W,goToPage:Re,setPageSize:ze,addData:Be,updateData:Ve,removeData:He,batchRemoveData:Ue}=ue({apiCall:async e=>await a.getOrders(e)||{list:[],total:0,page:1,pageSize:10},apiCallParams:e=>({page:e.page,pageSize:e.pageSize,search:e.searchQuery,status:e.filters.status}),statisticsFn:e=>({total:e.length,pending:e.filter(e=>e.status===r.PENDING).length,processing:e.filter(e=>e.status===r.PROCESSING).length,completed:e.filter(e=>e.status===r.COMPLETED).length,cancelled:e.filter(e=>e.status===r.CANCELLED).length,totalAmount:e.reduce((e,t)=>e+(t.total||0),0)})}),{mutate:We}=O({mutationFn:e=>a.createOrder({customer:e.customer,email:e.email,phone:e.phone,address:e.address,total:Number(e.total),items:Number(e.items),status:e.status,note:e.note}),onSuccess:()=>{J.value=!1,Z.value={customer:``,email:``,phone:``,address:``,total:0,items:1,status:r.PENDING,note:``},W()}}),{mutate:Ge,loading:Ke}=O({mutationFn:e=>a.deleteOrder(e),onSuccess:()=>W()}),{mutate:qe}=O({mutationFn:e=>a.batchDeleteOrders(e),onSuccess:()=>{K.value?.clearSelection(),W()}}),Je=u(()=>{let e=U.value||{};return[{title:`总订单`,value:e.total||0,icon:o,color:`text-blue-500`,bgColor:`bg-blue-50`},{title:`待处理`,value:e.pending||0,icon:d,color:`text-yellow-500`,bgColor:`bg-yellow-50`},{title:`处理中`,value:e.processing||0,icon:C,color:`text-purple-500`,bgColor:`bg-purple-50`},{title:`已完成`,value:e.completed||0,icon:t,color:`text-green-500`,bgColor:`bg-green-50`}]}),G=h({keyword:``,status:``}),Ye={layout:`inline`,fields:[{name:`keyword`,type:`input`,label:``,placeholder:`搜索订单号、客户...`,className:`w-[240px]`},{name:`status`,type:`select`,label:``,placeholder:`全部状态`,options:[{label:`全部状态`,value:``},{label:n.ORDER.PENDING.text,value:n.ORDER.PENDING.value},{label:n.ORDER.PROCESSING.text,value:n.ORDER.PROCESSING.value},{label:n.ORDER.COMPLETED.text,value:n.ORDER.COMPLETED.value},{label:n.ORDER.CANCELLED.text,value:n.ORDER.CANCELLED.value}],className:`w-[140px]`}],searchConfig:{enabled:!0,collapsed:!1,collapseThreshold:3,showCollapseButton:!1,searchText:`搜索`,resetText:`重置`,showReset:!0,onSearch:e=>{V.value=e.keyword||``,H.value={status:e.status}},onReset:()=>{V.value=``,H.value={}}}},K=h(),Xe=u(()=>({columns:[{title:`订单号`,dataIndex:`orderNo`,width:150,slot:`orderNo`},{title:`客户信息`,dataIndex:`customer`,width:180,slot:`customer`},{title:`商品数量`,dataIndex:`items`,width:100,align:`center`},{title:`订单金额`,dataIndex:`total`,width:120,slot:`total`,sorter:!0},{title:`状态`,dataIndex:`status`,width:120,slot:`status`,filters:[{text:n.ORDER.PENDING.text,value:n.ORDER.PENDING.value},{text:n.ORDER.PROCESSING.text,value:n.ORDER.PROCESSING.value},{text:n.ORDER.COMPLETED.text,value:n.ORDER.COMPLETED.value},{text:n.ORDER.CANCELLED.text,value:n.ORDER.CANCELLED.value}]},{title:`下单日期`,dataIndex:`date`,width:120,sorter:!0},{title:`收货地址`,dataIndex:`address`,width:200,ellipsis:!0}],pagination:{pageSize:10,show:!0,showSizeChanger:!0,showQuickJumper:!0},rowSelection:{type:`checkbox`,show:!0},actions:[{text:`查看`,type:`primary`,onClick:e=>Qe(e)},{text:`删除`,type:`danger`,confirm:!0,confirmText:`确定要删除该订单吗？此操作不可恢复。`,onClick:e=>Q(e.id)}],actionWidth:150,actionFixed:`right`})),q=u(()=>B.value.map(e=>({...e,key:e.id}))),J=h(!1),Y=h(!1),X=h(null),Z=h({customer:``,email:``,phone:``,address:``,total:0,items:1,status:r.PENDING,note:``}),Ze={layout:`horizontal`,labelCol:{span:6},wrapperCol:{span:18},fields:[{name:`customer`,type:`input`,label:`客户姓名`,placeholder:`请输入客户姓名`,rules:[{required:!0,message:`客户姓名不能为空`}]},{name:`email`,type:`input`,label:`邮箱`,placeholder:`请输入邮箱`,rules:[{required:!0,message:`邮箱不能为空`},{type:`email`,message:`邮箱格式不正确`}]},{name:`phone`,type:`input`,label:`电话`,placeholder:`请输入电话`,rules:[{required:!0,message:`电话不能为空`}]},{name:`address`,type:`input`,label:`收货地址`,placeholder:`请输入收货地址`,rules:[{required:!0,message:`收货地址不能为空`}]},{name:`total`,type:`number`,label:`订单金额`,placeholder:`请输入订单金额`,rules:[{required:!0,message:`订单金额不能为空`}]},{name:`items`,type:`number`,label:`商品数量`,placeholder:`请输入商品数量`,rules:[{required:!0,message:`商品数量不能为空`}]},{name:`status`,type:`select`,label:`订单状态`,placeholder:`请选择状态`,options:[{label:n.ORDER.PENDING.text,value:n.ORDER.PENDING.value},{label:n.ORDER.PROCESSING.text,value:n.ORDER.PROCESSING.value},{label:n.ORDER.COMPLETED.text,value:n.ORDER.COMPLETED.value},{label:n.ORDER.CANCELLED.text,value:n.ORDER.CANCELLED.value}],rules:[{required:!0,message:`请选择订单状态`}]},{name:`note`,type:`textarea`,label:`备注`,placeholder:`请输入备注（可选）`}],actions:{showSubmit:!0,showReset:!0,submitText:`创建订单`,resetText:`取消`,align:`right`,onReset:()=>{J.value=!1}}};function Qe(e){X.value=e,Y.value=!0}function $e(e){We(e)}function Q(e){Ge(e)}let $=h([]),et=h([]);function tt(e,t){$.value=e,et.value=t}function nt(){if($.value.length===0){alert(`请先选择要删除的订单`);return}confirm(`确定要删除选中的 ${$.value.length} 个订单吗？`)&&qe($.value.map(String))}function rt(e){e.current!==void 0&&Re(e.current),e.pageSize!==void 0&&ze(e.pageSize)}return(ee,a)=>(c(),x(`div`,de,[v(`div`,fe,[a[9]||=v(`div`,null,[v(`h1`,{class:`text-3xl font-bold tracking-tight`},`订单管理`),v(`p`,{class:`text-muted-foreground mt-1.5 text-sm`},`查看和管理所有订单`)],-1),s(y(e),{class:`gap-2`,onClick:a[0]||=e=>J.value=!0},{default:_(()=>[s(y(i),{class:`h-4 w-4`}),a[8]||=b(` 创建订单 `,-1)]),_:1})]),s(y(D),{ref:`addModalRef`,open:y(J),"onUpdate:open":a[2]||=e=>m(J)?J.value=e:null,title:`创建新订单`,width:`560`,footer:null},{default:_(()=>[s(y(E),{ref:`formRef`,modelValue:y(Z),"onUpdate:modelValue":a[1]||=e=>m(Z)?Z.value=e:null,schema:Ze,onSubmit:$e},null,8,[`modelValue`])]),_:1},8,[`open`]),v(`div`,pe,[(c(!0),x(re,null,ne(y(Je),e=>(c(),x(`div`,{key:e.title,class:`flex items-center gap-3 px-4 py-2.5 bg-muted/50 rounded-lg hover:bg-muted/70 transition-colors`},[(c(),S(l(e.icon),{class:te([`h-4 w-4`,e.color])},null,8,[`class`])),v(`div`,k,[v(`span`,A,g(e.value),1),v(`span`,j,g(e.title),1)])]))),128))]),v(`div`,M,[v(`div`,me,[v(`div`,N,[s(y(E),{modelValue:y(G),"onUpdate:modelValue":a[3]||=e=>m(G)?G.value=e:null,schema:Ye},null,8,[`modelValue`])]),y($).length>0?(c(),x(`div`,P,[v(`span`,F,`已选 `+g(y($).length)+` 项`,1),s(y(e),{variant:`outline`,size:`sm`,class:`h-8 text-xs text-destructive hover:text-destructive`,onClick:nt},{default:_(()=>[...a[10]||=[b(` 批量删除 `,-1)]]),_:1})])):f(``,!0)])]),s(y(ae),{class:`border-0 shadow-sm`},{default:_(()=>[s(y(se),{class:`pb-4`},{default:_(()=>[v(`div`,I,[v(`div`,L,[s(y(ce),{class:`text-base font-semibold`},{default:_(()=>[...a[11]||=[b(`订单列表`,-1)]]),_:1}),v(`span`,R,` 共 `+g(y(q).length)+` 单 `,1)]),v(`div`,z,[s(y(ie),{class:`h-4 w-4`}),v(`span`,null,`总金额: ¥`+g((y(U).value?.totalAmount||0).toFixed(2)),1)])])]),_:1}),s(y(oe),{class:`pt-0`},{default:_(()=>[s(y(le),{ref_key:`tableRef`,ref:K,data:y(q),"onUpdate:data":a[5]||=e=>m(q)?q.value=e:null,schema:y(Xe),onSelectChange:tt,onChange:rt},{orderNo:_(e=>[v(`span`,he,g(e.text),1)]),customer:_(e=>[s(y(T),{direction:`vertical`,size:`small`},{default:_(()=>[v(`span`,ge,g(e.record.customer),1),v(`span`,_e,g(e.record.phone),1)]),_:2},1024)]),total:_(e=>[v(`span`,ve,`¥`+g(Number(e.text).toFixed(2)),1)]),status:_(e=>[s(y(w),{color:e.text===y(r).PENDING?`warning`:e.text===y(r).PROCESSING?`processing`:e.text===y(r).COMPLETED?`success`:`error`},{default:_(()=>[s(y(T),null,{default:_(()=>[(c(),S(l(e.text===y(r).PENDING?y(d):e.text===y(r).PROCESSING?y(C):e.text===y(r).COMPLETED?y(t):y(p)),{class:`h-3 w-3`})),b(` `+g(y(n).ORDER[e.text]?.text||e.text),1)]),_:2},1024)]),_:2},1032,[`color`])]),emptyText:_(()=>[v(`div`,ye,[v(`div`,be,[s(y(o),{class:`w-8 h-8 text-muted-foreground/50`})]),a[13]||=v(`p`,{class:`text-base font-medium mb-1`},`暂无订单数据`,-1),a[14]||=v(`p`,{class:`text-sm text-muted-foreground mb-4`},`开始创建您的第一个订单吧`,-1),s(y(e),{size:`sm`,onClick:a[4]||=e=>J.value=!0},{default:_(()=>[s(y(i),{class:`h-4 w-4 mr-1`}),a[12]||=b(` 创建订单 `,-1)]),_:1})])]),_:1},8,[`data`,`schema`])]),_:1})]),_:1}),s(y(D),{ref:`viewModalRef`,open:y(Y),"onUpdate:open":a[7]||=e=>m(Y)?Y.value=e:null,title:`订单详情`,width:`560`,footer:null},{default:_(()=>[y(X)?(c(),x(`div`,xe,[v(`div`,Se,[v(`div`,null,[a[15]||=v(`p`,{class:`text-sm text-muted-foreground`},`订单号`,-1),v(`p`,Ce,g(y(X).orderNo),1)]),s(y(w),{color:y(X).status===y(r).PENDING?`warning`:y(X).status===y(r).PROCESSING?`processing`:y(X).status===y(r).COMPLETED?`success`:`error`},{default:_(()=>[s(y(T),null,{default:_(()=>[(c(),S(l(y(X).status===y(r).PENDING?y(d):y(X).status===y(r).PROCESSING?y(C):y(X).status===y(r).COMPLETED?y(t):y(p)),{class:`h-3 w-3`})),b(` `+g(y(n).ORDER[y(X).status]?.text||y(X).status),1)]),_:1})]),_:1},8,[`color`])]),v(`div`,we,[a[19]||=v(`h4`,{class:`font-medium`},`客户信息`,-1),v(`div`,Te,[v(`div`,null,[a[16]||=v(`p`,{class:`text-muted-foreground`},`姓名`,-1),v(`p`,null,g(y(X).customer),1)]),v(`div`,null,[a[17]||=v(`p`,{class:`text-muted-foreground`},`电话`,-1),v(`p`,null,g(y(X).phone),1)]),v(`div`,Ee,[a[18]||=v(`p`,{class:`text-muted-foreground`},`邮箱`,-1),v(`p`,null,g(y(X).email),1)])])]),v(`div`,De,[a[24]||=v(`h4`,{class:`font-medium`},`订单信息`,-1),v(`div`,Oe,[v(`div`,null,[a[20]||=v(`p`,{class:`text-muted-foreground`},`商品数量`,-1),v(`p`,null,g(y(X).items)+` 件`,1)]),v(`div`,null,[a[21]||=v(`p`,{class:`text-muted-foreground`},`订单金额`,-1),v(`p`,ke,`¥`+g(y(X).total.toFixed(2)),1)]),v(`div`,null,[a[22]||=v(`p`,{class:`text-muted-foreground`},`下单日期`,-1),v(`p`,null,g(y(X).date),1)]),v(`div`,Ae,[a[23]||=v(`p`,{class:`text-muted-foreground`},`收货地址`,-1),v(`p`,null,g(y(X).address),1)])])]),y(X).note?(c(),x(`div`,je,[a[25]||=v(`h4`,{class:`font-medium`},`备注`,-1),v(`p`,Me,g(y(X).note),1)])):f(``,!0),v(`div`,Ne,[s(y(e),{variant:`outline`,onClick:a[6]||=e=>Y.value=!1},{default:_(()=>[...a[26]||=[b(` 关闭 `,-1)]]),_:1})])])):f(``,!0)]),_:1},8,[`open`])]))}});export{B as default};
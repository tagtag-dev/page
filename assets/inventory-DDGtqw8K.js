import"./ScrollArea-u7vgQcwr.js";import"./RovingFocusItem-tfPyown7.js";import"./Presence-CTcpkTiJ.js";import"./TabsTrigger-BVA-KY5p.js";import{Bi as e,Ha as t,Ii as n,J as r,Jn as i,Ki as a,Li as o,Lt as s,Pa as c,Ri as l,Ui as u,Wa as d,Wi as f,_ as p,c as m,ji as h,ka as g,la as _,pa as v,qa as y,sa as b,wa as x,zi as S}from"./index-Bdnse1ke.js";import"./en_US-B-0xvqcl.js";import"./common-B6eu2cAW.js";import"./zh_CN-o6dt8jMH.js";import"./useFullscreen-Cz-fRWjR.js";import"./_plugin-vue_export-helper-CuErARa7.js";import{t as C}from"./badge-CifgcTtr.js";import"./dist-CIVP1JAM.js";import"./theme-shared-CKGE9ZaP.js";import{t as w}from"./TTable-BqF1vWP0.js";import"./useTableColumns-ClPoF4Nv.js";import"./useResponsive-Drj8-vqi.js";import{t as T}from"./TForm-D3MGp7pF.js";import"./TIcon-BqmThimp.js";import{n as E,t as D}from"./CardContent-CE0o8nDP.js";import{n as O}from"./composables-cmucIgPx.js";var k={class:`space-y-6`},A={class:`flex flex-wrap gap-3`},j={class:`flex items-baseline gap-2`},M={class:`text-lg font-semibold`},N={class:`text-xs text-muted-foreground`},P={class:`bg-muted/40 border border-border/50 rounded-xl px-3 py-3`},F={class:`flex flex-col lg:flex-row lg:items-center gap-4`},ee={class:`flex-1`},I={key:0,class:`flex items-center gap-2 lg:border-l lg:pl-4`},L={class:`text-sm text-muted-foreground`},R={class:`font-medium`},z={class:`text-xs text-muted-foreground font-mono`},B={class:`flex flex-col items-center justify-center py-12 text-muted-foreground`},V={class:`w-16 h-16 rounded-full bg-muted flex items-center justify-center mb-4`},H=a({__name:`index`,setup(a){let{data:H,loading:te,searchQuery:U,filters:W,total:ne,statistics:G,fetchData:re}=O({apiCall:()=>i.getStock(),statisticsFn:e=>{let t=new Set(e.map(e=>e.warehouseId)).size;return{totalWarehouses:t,activeWarehouses:t,totalProducts:e.reduce((e,t)=>e+t.quantity,0),lowStockItems:e.filter(e=>e.available<e.minStock).length}}}),K=n(()=>{let e=new Set(H.value.map(e=>e.warehouseId));return Array.from(e).map(e=>({id:e,name:H.value.find(t=>t.warehouseId===e)?.warehouseName||`仓库 ${e}`}))}),q=n(()=>{let e=G.value||{};return[{title:`仓库总数`,value:e.totalWarehouses||0,icon:m,color:`text-blue-500`},{title:`运营中`,value:e.activeWarehouses||0,icon:s,color:`text-green-500`},{title:`库存总量`,value:e.totalProducts||0,icon:r,color:`text-purple-500`},{title:`库存预警`,value:e.lowStockItems||0,icon:p,color:`text-red-500`}]}),J=c({keyword:``,warehouse:``}),Y={layout:`inline`,fields:[{name:`keyword`,type:`input`,label:``,placeholder:`搜索商品名称、SKU...`,className:`w-[240px]`},{name:`warehouse`,type:`select`,label:``,placeholder:`全部仓库`,options:[{label:`全部仓库`,value:``},...K.value.map(e=>({label:e.name,value:e.id}))],className:`w-[140px]`}],searchConfig:{enabled:!0,collapsed:!1,showCollapseButton:!1,searchText:`搜索`,resetText:`重置`,showReset:!0,onSearch:e=>{U.value=e.keyword||``,W.value={warehouseId:e.warehouse}},onReset:()=>{U.value=``,W.value={}}}},X=n(()=>({columns:[{title:`商品信息`,dataIndex:`productName`,width:200,slot:`product`},{title:`仓库`,dataIndex:`warehouseName`,width:120},{title:`总库存`,dataIndex:`quantity`,width:100,sorter:!0},{title:`预留`,dataIndex:`reserved`,width:100},{title:`可用`,dataIndex:`available`,width:100,slot:`available`},{title:`库存状态`,dataIndex:`available`,width:120,slot:`status`},{title:`更新时间`,dataIndex:`lastUpdated`,width:120}],pagination:{pageSize:10,show:!0,showSizeChanger:!0},rowSelection:{type:`checkbox`,show:!0},showTotalBadge:!0})),Z=n(()=>H.value.map(e=>({...e,key:e.id}))),Q=c([]);function $(e){Q.value=e}return(n,i)=>(b(),e(`div`,k,[i[4]||=o(`div`,{class:`flex flex-col sm:flex-row sm:items-center justify-between gap-4`},[o(`div`,null,[o(`h1`,{class:`text-3xl font-bold tracking-tight`},`库存管理`),o(`p`,{class:`text-muted-foreground mt-1.5 text-sm`},`管理仓库和库存分布`)])],-1),o(`div`,A,[(b(!0),e(h,null,_(t(q),t=>(b(),e(`div`,{key:t.title,class:`flex items-center gap-3 px-4 py-2.5 bg-muted/50 rounded-lg hover:bg-muted/70 transition-colors`},[(b(),l(v(t.icon),{class:d([`h-4 w-4`,t.color])},null,8,[`class`])),o(`div`,j,[o(`span`,M,y(t.value),1),o(`span`,N,y(t.title),1)])]))),128))]),o(`div`,P,[o(`div`,F,[o(`div`,ee,[f(t(T),{modelValue:t(J),"onUpdate:modelValue":i[0]||=e=>g(J)?J.value=e:null,schema:Y},null,8,[`modelValue`])]),t(Q).length>0?(b(),e(`div`,I,[o(`span`,L,`已选 `+y(t(Q).length)+` 项`,1)])):S(``,!0)])]),f(t(E),{class:`bg-muted/40 border border-border/50 rounded-xl`},{default:x(()=>[f(t(D),{class:`pt-6`},{default:x(()=>[f(t(w),{ref:`tableRef`,data:t(Z),"onUpdate:data":i[1]||=e=>g(Z)?Z.value=e:null,schema:t(X),onSelectChange:$},{product:x(e=>[o(`div`,null,[o(`div`,R,y(e.text),1),o(`div`,z,y(e.record.sku),1)])]),available:x(e=>[o(`span`,{class:d([`font-medium`,e.record.available<=e.record.minStock?`text-red-500`:`text-green-500`])},y(e.text),3)]),status:x(e=>[f(t(C),{class:d({"bg-red-500/10 text-red-500 border-red-500/20":e.record.available<=e.record.minStock,"bg-yellow-500/10 text-yellow-500 border-yellow-500/20":e.record.available>e.record.minStock&&e.record.available<=e.record.minStock*1.5,"bg-green-500/10 text-green-500 border-green-500/20":e.record.available>e.record.minStock*1.5}),variant:`outline`},{default:x(()=>[u(y(e.record.available<=e.record.minStock?`库存不足`:e.record.available<=e.record.minStock*1.5?`库存偏低`:`库存充足`),1)]),_:2},1032,[`class`])]),emptyText:x(()=>[o(`div`,B,[o(`div`,V,[f(t(r),{class:`w-8 h-8 text-muted-foreground/50`})]),i[2]||=o(`p`,{class:`text-base font-medium mb-1`},`暂无库存数据`,-1),i[3]||=o(`p`,{class:`text-sm text-muted-foreground`},`请先添加仓库和商品`,-1)])]),_:1},8,[`data`,`schema`])]),_:1})]),_:1})]))}});export{H as default};
import"./ScrollArea-CW0-18Hy.js";import"./RovingFocusItem-DihGLheP.js";import{t as e}from"./button-Bo4o88Eb.js";import"./Presence-CX2vXdhf.js";import"./defu-BJL4Fjh2.js";import"./usePrimitiveElement-bvCn2QxH.js";import"./TabsTrigger-EHjOJe4X.js";import{An as t,Ct as n,Di as r,Ea as i,Gi as a,M as o,Ti as s,Ui as c,Yi as l,Yn as u,_i as d,da as f,f as p,fi as m,ga as h,ka as g,oa as _,rt as v,vi as y,vt as b,wa as x,wi as S,xi as C,yi as w}from"./index-D9LA8apy.js";import"./en_US-N9Q-_HQi.js";import"./common-rttX-sZZ.js";import"./zh_CN-RQJLYl9H.js";import"./useTabBar-WvhELTvw.js";import{t as T}from"./badge-DoBLqkFL.js";import{n as E,t as D}from"./CardContent-bGWyUVF7.js";import"./dist-guKItzxh.js";import{t as O}from"./TTable-BJXg8Gts.js";import{t as k}from"./TForm-De-AxzjP.js";import"./Input-DxyLxkUT.js";import"./TIcon-DpsAxes7.js";import{t as A}from"./TModal-l0DmcJma.js";import{n as j}from"./composables-B_2v-ght.js";import"./constants-BrhrixW3.js";var M={class:`space-y-6`},N={class:`flex flex-col sm:flex-row sm:items-center justify-between gap-4`},P={class:`flex flex-wrap gap-3`},F={class:`flex items-baseline gap-2`},I={class:`text-lg font-semibold`},L={class:`text-xs text-muted-foreground`},R={class:`bg-muted/30 rounded-lg p-4`},z={class:`flex flex-col lg:flex-row lg:items-center gap-4`},B={class:`flex-1`},V={class:`font-medium`},H={class:`text-xs text-muted-foreground font-mono`},U={class:`flex flex-col items-center justify-center py-12 text-muted-foreground`},W={class:`w-16 h-16 rounded-full bg-muted flex items-center justify-center mb-4`},G=r({__name:`Stock`,setup(r){let{data:G}=j({apiCall:()=>t.getStock()}),K=d(()=>{let e=new Set(G.value.map(e=>e.warehouseId));return Array.from(e).map(e=>({id:e,name:G.value.find(t=>t.warehouseId===e)?.warehouseName||`仓库 ${e}`}))}),q=h([{id:`1`,productName:`高级无线耳机`,sku:`SKU-001`,warehouseName:`北京仓库`,systemStock:45,actualStock:43,difference:-2,reason:`损坏报废`,operator:`张三`,checkTime:`2024-02-01 10:30`,status:`adjusted`},{id:`2`,productName:`智能手表 Pro`,sku:`SKU-002`,warehouseName:`北京仓库`,systemStock:23,actualStock:25,difference:2,reason:`入库未登记`,operator:`张三`,checkTime:`2024-02-01 11:00`,status:`adjusted`},{id:`3`,productName:`便携式充电宝`,sku:`SKU-003`,warehouseName:`上海仓库`,systemStock:156,actualStock:156,difference:0,reason:`-`,operator:`李四`,checkTime:`2024-02-02 09:00`,status:`confirmed`}]),J=d(()=>{let e=q.value.length,t=q.value.filter(e=>e.status===`pending`).length,r=q.value.filter(e=>e.status===`adjusted`).length,i=q.value.filter(e=>e.status===`confirmed`).length;return[{title:`盘点记录`,value:e,icon:b,color:`text-blue-500`},{title:`待确认`,value:t,icon:p,color:`text-yellow-500`},{title:`已调整`,value:r,icon:v,color:`text-purple-500`},{title:`已确认`,value:i,icon:n,color:`text-green-500`}]}),Y=h({keyword:``,warehouse:``}),X={layout:`inline`,fields:[{name:`keyword`,type:`input`,label:``,placeholder:`搜索商品名称、SKU...`,className:`w-[240px]`},{name:`warehouse`,type:`select`,label:``,placeholder:`全部仓库`,options:[{label:`全部仓库`,value:``},...K.value.map(e=>({label:e.name,value:e.id}))],className:`w-[140px]`}],searchConfig:{enabled:!0,collapsed:!1,showCollapseButton:!1,searchText:`搜索`,resetText:`重置`,showReset:!0}},Z=d(()=>({columns:[{title:`商品信息`,dataIndex:`productName`,width:200,slot:`product`},{title:`仓库`,dataIndex:`warehouseName`,width:120},{title:`系统库存`,dataIndex:`systemStock`,width:100},{title:`实际库存`,dataIndex:`actualStock`,width:100},{title:`差异`,dataIndex:`difference`,width:100,slot:`difference`},{title:`原因`,dataIndex:`reason`,width:150},{title:`盘点时间`,dataIndex:`checkTime`,width:150},{title:`状态`,dataIndex:`status`,width:100,slot:`status`}],pagination:{pageSize:10,show:!0,showSizeChanger:!0},rowSelection:{type:`checkbox`,show:!0},showTotalBadge:!0})),Q=h(!1),$=h({productId:``,warehouseId:``,actualStock:0,reason:``}),ee={layout:`horizontal`,labelCol:{span:6},wrapperCol:{span:18},fields:[{name:`productId`,type:`select`,label:`商品`,placeholder:`请选择商品`,options:G.value.map(e=>({label:e.productName,value:e.id})),rules:[{required:!0,message:`请选择商品`}]},{name:`warehouseId`,type:`select`,label:`仓库`,placeholder:`请选择仓库`,options:K.value.map(e=>({label:e.name,value:e.id})),rules:[{required:!0,message:`请选择仓库`}]},{name:`actualStock`,type:`number`,label:`实际库存`,placeholder:`请输入实际库存数量`,rules:[{required:!0,message:`请输入实际库存`}]},{name:`reason`,type:`textarea`,label:`差异原因`,placeholder:`请输入差异原因（可选）`}],actions:{showSubmit:!0,showReset:!0,submitText:`提交盘点`,resetText:`取消`,align:`right`,onReset:()=>{Q.value=!1}}};function te(e){Q.value=!1,$.value={productId:``,warehouseId:``,actualStock:0,reason:``}}let ne=h([]);function re(e){ne.value=e}return(t,n)=>(c(),C(`div`,M,[y(`div`,N,[n[7]||=y(`div`,null,[y(`h1`,{class:`text-3xl font-bold tracking-tight`},`库存盘点`),y(`p`,{class:`text-muted-foreground mt-1.5 text-sm`},`定期盘点库存，确保账实相符`)],-1),s(x(e),{class:`gap-2`,onClick:n[0]||=e=>Q.value=!0},{default:_(()=>[s(x(o),{class:`h-4 w-4`}),n[6]||=S(` 新增盘点 `,-1)]),_:1})]),s(x(A),{open:x(Q),"onUpdate:open":n[2]||=e=>f(Q)?Q.value=e:null,title:`新增盘点`,width:`560`,footer:null},{default:_(()=>[s(x(k),{modelValue:x($),"onUpdate:modelValue":n[1]||=e=>f($)?$.value=e:null,schema:ee,onSubmit:te},null,8,[`modelValue`])]),_:1},8,[`open`]),y(`div`,P,[(c(!0),C(m,null,a(x(J),e=>(c(),C(`div`,{key:e.title,class:`flex items-center gap-3 px-4 py-2.5 bg-muted/50 rounded-lg hover:bg-muted/70 transition-colors`},[(c(),w(l(e.icon),{class:i([`h-4 w-4`,e.color])},null,8,[`class`])),y(`div`,F,[y(`span`,I,g(e.value),1),y(`span`,L,g(e.title),1)])]))),128))]),y(`div`,R,[y(`div`,z,[y(`div`,B,[s(x(k),{modelValue:x(Y),"onUpdate:modelValue":n[3]||=e=>f(Y)?Y.value=e:null,schema:X},null,8,[`modelValue`])])])]),s(x(E),{class:`border-0 shadow-sm`},{default:_(()=>[s(x(D),{class:`pt-6`},{default:_(()=>[s(x(O),{ref:`tableRef`,data:x(q),"onUpdate:data":n[5]||=e=>f(q)?q.value=e:null,schema:x(Z),onSelectChange:re},{product:_(e=>[y(`div`,null,[y(`div`,V,g(e.text),1),y(`div`,H,g(e.record.sku),1)])]),difference:_(e=>[y(`span`,{class:i([`font-medium`,e.text>0?`text-green-500`:e.text<0?`text-red-500`:`text-gray-500`])},g(e.text>0?`+`:``)+g(e.text),3)]),status:_(e=>[s(x(T),{class:i({"bg-yellow-500/10 text-yellow-500 border-yellow-500/20":e.text===x(u).PENDING,"bg-purple-500/10 text-purple-500 border-purple-500/20":e.text===x(u).ADJUSTED,"bg-green-500/10 text-green-500 border-green-500/20":e.text===x(u).CONFIRMED}),variant:`outline`},{default:_(()=>[S(g(e.text===x(u).PENDING?`待确认`:e.text===x(u).ADJUSTED?`已调整`:`已确认`),1)]),_:2},1032,[`class`])]),emptyText:_(()=>[y(`div`,U,[y(`div`,W,[s(x(b),{class:`w-8 h-8 text-muted-foreground/50`})]),n[9]||=y(`p`,{class:`text-base font-medium mb-1`},`暂无盘点记录`,-1),n[10]||=y(`p`,{class:`text-sm text-muted-foreground mb-4`},`开始创建您的第一条盘点记录吧`,-1),s(x(e),{size:`sm`,onClick:n[4]||=e=>Q.value=!0},{default:_(()=>[s(x(o),{class:`h-4 w-4 mr-1`}),n[8]||=S(` 新增盘点 `,-1)]),_:1})])]),_:1},8,[`data`,`schema`])]),_:1})]),_:1})]))}});export{G as default};
import"./ScrollArea-DFVXjTz0.js";import"./RovingFocusItem-CVjkq2qt.js";import{a as e,c as t,i as ee,n as te,o as ne,r as n,s as r,t as i}from"./AvatarImage-BPltKCZ9.js";import"./nullish-aN8fRbtt.js";import"./Presence-3Lrzvetv.js";import"./defu-DUbmuhNq.js";import{t as a}from"./Label-8o82ohg6.js";import{t as o}from"./Separator-CZCag7UD.js";import"./TabsTrigger-DqwypIQj.js";import{Ca as s,Fi as c,Gi as l,Gn as u,Hi as d,Ii as f,Ka as p,L as re,Li as m,Ma as h,N as g,Na as _,Ri as v,Ti as y,Ua as b,Ui as x,Va as S,Xt as C,Yt as w,Zt as T,at as E,bt as ie,la as D,m as ae,n as O,nt as oe,oa as k,ot as A,ra as j,rt as M,sn as N,tr as P,u as F,wa as I,zi as L}from"./index-D6Cod0pL.js";import"./en_US-LGbIKe0x.js";import"./common-HQCQB71w.js";import"./zh_CN-Cgumeokr.js";import"./_plugin-vue_export-helper-Dey4FfNi.js";import{z as R}from"./dist-D3XftLPo.js";import"./theme-shared-BpTdpb0d.js";import"./TTable-B13ZnM5N.js";import"./useTableColumns-qs-cYpaB.js";import"./TForm-Drq7Qn9R.js";import{r as z}from"./TIcon-C-hNhMC1.js";import"./TModal-OyBXzO5K.js";import{n as B,t as V}from"./CardContent-CMuL0LxG.js";import{t as H}from"./CardDescription-DXNpEJau.js";import{n as U,t as W}from"./CardTitle-D06OZslX.js";import"./business-DYFIcNWr.js";import"./TStatusBadge-DZzFEG5C.js";import{t as G}from"./TPageHeader-CTxQMWSB.js";import"./TEmptyState-B9XitPgC.js";import"./TBatchActions-CX-6FAVm.js";var K=l({__name:`DialogFooter`,props:{class:{}},setup(e){let t=e;return(e,ee)=>(k(),L(`div`,{"data-slot":`dialog-footer`,class:b(S(N)(`flex flex-col-reverse gap-2 sm:flex-row sm:justify-end`,t.class))},[D(e.$slots,`default`)],2))}}),q={class:`space-y-6`},J={class:`grid grid-cols-1 lg:grid-cols-3 gap-6`},se={class:`lg:col-span-2 space-y-6`},ce={class:`flex items-center gap-4`},le={class:`relative`},ue={key:0,class:`absolute inset-0 flex items-center justify-center bg-black/50 rounded-full`},de={class:`grid grid-cols-1 md:grid-cols-2 gap-4`},fe={class:`space-y-2`},pe={key:0,class:`text-xs text-destructive`},me={class:`space-y-2`},he={class:`space-y-2`},ge={key:0,class:`text-xs text-destructive`},_e={class:`space-y-2`},ve={class:`space-y-2`},ye={class:`space-y-2`},be={class:`space-y-2`},xe={class:`flex justify-end`},Se={class:`space-y-6`},Ce={class:`flex items-center gap-3 text-sm`},we={class:`flex items-center gap-3 text-sm`},Te={class:`flex items-center gap-3 text-sm`},Ee={class:`flex items-center gap-3 text-sm`},De={class:`space-y-4 py-4`},Oe={class:`space-y-2`},ke={key:0,class:`text-xs text-destructive`},Ae={class:`space-y-2`},je={key:0,class:`text-xs text-destructive`},Me={class:`space-y-2`},Ne={key:0,class:`text-xs text-destructive`},Y=l({__name:`index`,setup(l){let D=u(),N=h({}),Y=h({name:``,email:``,phone:``,avatar:``,address:``,department:``,position:``,bio:``}),X=h({profile:!1,avatar:!1,password:!1}),Z=h({open:!1,oldPassword:``,newPassword:``,confirmPassword:``}),Q=h({}),$=_(null),Pe=()=>{let e=D.user;e&&(Y.name=e.name||``,Y.email=e.email||``,Y.phone=e.phone||``,Y.avatar=e.avatar||``,Y.address=e.address||``,Y.department=e.department||``,Y.position=e.position||``,Y.bio=e.bio||``)},Fe=()=>{N.name=``,N.phone=``,N.email=``;let e=!0;return Y.name.trim()?(Y.name.length<2||Y.name.length>20)&&(N.name=`姓名长度应在 2-20 个字符之间`,e=!1):(N.name=`请输入姓名`,e=!1),Y.phone&&!/^1[3-9]\d{9}$/.test(Y.phone)&&(N.phone=`请输入有效的手机号码`,e=!1),Y.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(Y.email)&&(N.email=`请输入有效的邮箱地址`,e=!1),e},Ie=async()=>{if(Fe()){X.profile=!0;try{let e=await P.updateProfile({name:Y.name,phone:Y.phone,address:Y.address,department:Y.department,position:Y.position,bio:Y.bio,avatar:Y.avatar});D.user={...D.user,...e},R.success(`个人资料保存成功`)}catch(e){console.error(`保存个人资料失败:`,e),R.error(`保存失败，请稍后重试`)}finally{X.profile=!1}}},Le=()=>{$.value?.click()},Re=async e=>{let t=e.target.files?.[0];if(t){if(!t.type.startsWith(`image/`)){R.error(`请选择图片文件`);return}if(t.size>2*1024*1024){R.error(`图片大小不能超过 2MB`);return}X.avatar=!0;try{let{avatarUrl:e}=await P.uploadAvatar(t);Y.avatar=e,await P.updateProfile({avatar:e}),D.user&&(D.user.avatar=e),R.success(`头像上传成功`)}catch(e){console.error(`上传头像失败:`,e),R.error(`上传失败，请稍后重试`)}finally{X.avatar=!1,$.value&&($.value.value=``)}}},ze=()=>{Z.open=!0,Z.oldPassword=``,Z.newPassword=``,Z.confirmPassword=``,Q.oldPassword=``,Q.newPassword=``,Q.confirmPassword=``},Be=()=>{Q.oldPassword=``,Q.newPassword=``,Q.confirmPassword=``;let e=!0;return Z.oldPassword||(Q.oldPassword=`请输入当前密码`,e=!1),Z.newPassword?Z.newPassword.length<6&&(Q.newPassword=`密码长度至少为 6 位`,e=!1):(Q.newPassword=`请输入新密码`,e=!1),Z.confirmPassword?Z.newPassword!==Z.confirmPassword&&(Q.confirmPassword=`两次输入的密码不一致`,e=!1):(Q.confirmPassword=`请确认新密码`,e=!1),e},Ve=async()=>{if(Be()){X.password=!0;try{await P.changePassword({oldPassword:Z.oldPassword,newPassword:Z.newPassword}),R.success(`密码修改成功`),Z.open=!1}catch(e){console.error(`修改密码失败:`,e),R.error(`修改密码失败，请检查当前密码是否正确`)}finally{X.password=!1}}},He=c(()=>Y.name?.charAt(0).toUpperCase()||`U`),Ue=e=>e?new Date(e).toLocaleDateString(`zh-CN`):`-`;return j(()=>{Pe()}),(c,l)=>(k(),L(`div`,q,[x(S(G),{title:`个人资料`,subtitle:`管理您的个人信息和账户安全`}),f(`div`,J,[f(`div`,se,[x(S(B),{class:`bg-muted/40 border border-border/50 rounded-xl`},{default:s(()=>[x(S(U),null,{default:s(()=>[x(S(W),{class:`flex items-center gap-2`},{default:s(()=>[x(S(F),{class:`h-5 w-5`}),l[12]||=d(` 基本信息 `,-1)]),_:1}),x(S(H),null,{default:s(()=>[...l[13]||=[d(`更新您的个人信息`,-1)]]),_:1})]),_:1}),x(S(V),{class:`space-y-6`},{default:s(()=>[f(`div`,ce,[f(`div`,le,[x(S(n),{class:`h-24 w-24`},{default:s(()=>[Y.avatar?(k(),m(S(i),{key:0,src:Y.avatar},null,8,[`src`])):v(``,!0),x(S(te),{class:`text-3xl bg-primary text-primary-foreground`},{default:s(()=>[d(p(He.value),1)]),_:1})]),_:1}),X.avatar?(k(),L(`button`,ue,[x(S(A),{class:`h-8 w-8 text-white animate-spin`})])):v(``,!0)]),f(`div`,null,[f(`input`,{ref_key:`avatarInputRef`,ref:$,type:`file`,accept:`image/*`,class:`hidden`,onChange:Re},null,544),x(S(O),{variant:`outline`,disabled:X.avatar,onClick:Le},{default:s(()=>[x(S(ae),{class:`h-4 w-4 mr-2`}),l[14]||=d(` 更换头像 `,-1)]),_:1},8,[`disabled`]),l[15]||=f(`p`,{class:`text-xs text-muted-foreground mt-2`},` 支持 JPG、PNG 格式，文件大小不超过 2MB `,-1)])]),x(S(o)),f(`div`,de,[f(`div`,fe,[x(S(a),{for:`name`},{default:s(()=>[...l[16]||=[d(` 姓名 `,-1),f(`span`,{class:`text-destructive`},`*`,-1)]]),_:1}),x(S(z),{id:`name`,modelValue:Y.name,"onUpdate:modelValue":l[0]||=e=>Y.name=e,class:b({"border-destructive":N.name}),placeholder:`请输入姓名`},null,8,[`modelValue`,`class`]),N.name?(k(),L(`p`,pe,p(N.name),1)):v(``,!0)]),f(`div`,me,[x(S(a),{for:`email`},{default:s(()=>[...l[17]||=[d(`邮箱`,-1)]]),_:1}),x(S(z),{id:`email`,modelValue:Y.email,"onUpdate:modelValue":l[1]||=e=>Y.email=e,type:`email`,disabled:``},null,8,[`modelValue`]),l[18]||=f(`p`,{class:`text-xs text-muted-foreground`},`邮箱不可修改`,-1)]),f(`div`,he,[x(S(a),{for:`phone`},{default:s(()=>[...l[19]||=[d(`电话`,-1)]]),_:1}),x(S(z),{id:`phone`,modelValue:Y.phone,"onUpdate:modelValue":l[2]||=e=>Y.phone=e,type:`tel`,class:b({"border-destructive":N.phone}),placeholder:`请输入手机号码`},null,8,[`modelValue`,`class`]),N.phone?(k(),L(`p`,ge,p(N.phone),1)):v(``,!0)]),f(`div`,_e,[x(S(a),{for:`department`},{default:s(()=>[x(S(C),{class:`h-3.5 w-3.5 inline mr-1`}),l[20]||=d(` 部门 `,-1)]),_:1}),x(S(z),{id:`department`,modelValue:Y.department,"onUpdate:modelValue":l[3]||=e=>Y.department=e,placeholder:`请输入部门`},null,8,[`modelValue`])]),f(`div`,ve,[x(S(a),{for:`position`},{default:s(()=>[x(S(T),{class:`h-3.5 w-3.5 inline mr-1`}),l[21]||=d(` 职位 `,-1)]),_:1}),x(S(z),{id:`position`,modelValue:Y.position,"onUpdate:modelValue":l[4]||=e=>Y.position=e,placeholder:`请输入职位`},null,8,[`modelValue`])]),f(`div`,ye,[x(S(a),{for:`address`},{default:s(()=>[x(S(oe),{class:`h-3.5 w-3.5 inline mr-1`}),l[22]||=d(` 地址 `,-1)]),_:1}),x(S(z),{id:`address`,modelValue:Y.address,"onUpdate:modelValue":l[5]||=e=>Y.address=e,placeholder:`请输入地址`},null,8,[`modelValue`])])]),f(`div`,be,[x(S(a),{for:`bio`},{default:s(()=>[x(S(ie),{class:`h-3.5 w-3.5 inline mr-1`}),l[23]||=d(` 个人简介 `,-1)]),_:1}),I(f(`textarea`,{id:`bio`,"onUpdate:modelValue":l[6]||=e=>Y.bio=e,rows:`4`,class:`w-full px-3 py-2 rounded-md border border-input bg-background text-sm resize-none focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2`,placeholder:`请输入个人简介`},null,512),[[y,Y.bio]])]),f(`div`,xe,[x(S(O),{onClick:Ie,disabled:X.profile},{default:s(()=>[X.profile?(k(),m(S(A),{key:0,class:`h-4 w-4 mr-2 animate-spin`})):(k(),m(S(re),{key:1,class:`h-4 w-4 mr-2`})),d(` `+p(X.profile?`保存中...`:`保存更改`),1)]),_:1},8,[`disabled`])])]),_:1})]),_:1})]),f(`div`,Se,[x(S(B),{class:`bg-muted/40 border border-border/50 rounded-xl`},{default:s(()=>[x(S(U),null,{default:s(()=>[x(S(W),null,{default:s(()=>[...l[24]||=[d(`账户信息`,-1)]]),_:1})]),_:1}),x(S(V),{class:`space-y-4`},{default:s(()=>[f(`div`,Ce,[x(S(M),{class:`h-4 w-4 text-muted-foreground`}),f(`div`,null,[l[25]||=f(`p`,{class:`text-xs text-muted-foreground`},`邮箱`,-1),f(`p`,null,p(S(D).user?.email),1)])]),x(S(o)),f(`div`,we,[x(S(g),{class:`h-4 w-4 text-muted-foreground`}),f(`div`,null,[l[26]||=f(`p`,{class:`text-xs text-muted-foreground`},`角色`,-1),f(`p`,null,p(S(D).user?.role),1)])]),x(S(o)),f(`div`,Te,[x(S(F),{class:`h-4 w-4 text-muted-foreground`}),f(`div`,null,[l[27]||=f(`p`,{class:`text-xs text-muted-foreground`},`状态`,-1),f(`p`,null,p(S(D).user?.status===`active`?`正常`:`停用`),1)])]),x(S(o)),f(`div`,Ee,[x(S(w),{class:`h-4 w-4 text-muted-foreground`}),f(`div`,null,[l[28]||=f(`p`,{class:`text-xs text-muted-foreground`},`注册时间`,-1),f(`p`,null,p(Ue(S(D).user?.createdAt)),1)])])]),_:1})]),_:1}),x(S(B),{class:`bg-muted/40 border border-border/50 rounded-xl`},{default:s(()=>[x(S(U),null,{default:s(()=>[x(S(W),null,{default:s(()=>[...l[29]||=[d(`安全设置`,-1)]]),_:1})]),_:1}),x(S(V),{class:`space-y-3`},{default:s(()=>[x(S(O),{variant:`outline`,class:`w-full`,onClick:ze},{default:s(()=>[x(S(E),{class:`h-4 w-4 mr-2`}),l[30]||=d(` 修改密码 `,-1)]),_:1})]),_:1})]),_:1}),x(S(B),{class:`bg-muted/40 border border-border/50 rounded-xl border-destructive/50`},{default:s(()=>[x(S(U),null,{default:s(()=>[x(S(W),{class:`text-destructive`},{default:s(()=>[...l[31]||=[d(`危险区域`,-1)]]),_:1}),x(S(H),null,{default:s(()=>[...l[32]||=[d(`不可逆的操作`,-1)]]),_:1})]),_:1}),x(S(V),null,{default:s(()=>[x(S(O),{variant:`destructive`,class:`w-full`},{default:s(()=>[...l[33]||=[d(` 删除账户 `,-1)]]),_:1})]),_:1})]),_:1})])]),x(S(t),{open:Z.open,"onUpdate:open":l[11]||=e=>Z.open=e},{default:s(()=>[x(S(r),{class:`sm:max-w-[425px]`},{default:s(()=>[x(S(e),null,{default:s(()=>[x(S(ee),{class:`flex items-center gap-2`},{default:s(()=>[x(S(E),{class:`h-5 w-5`}),l[34]||=d(` 修改密码 `,-1)]),_:1}),x(S(ne),null,{default:s(()=>[...l[35]||=[d(` 请输入当前密码和新密码来修改您的登录密码 `,-1)]]),_:1})]),_:1}),f(`div`,De,[f(`div`,Oe,[x(S(a),{for:`oldPassword`},{default:s(()=>[...l[36]||=[d(` 当前密码 `,-1),f(`span`,{class:`text-destructive`},`*`,-1)]]),_:1}),x(S(z),{id:`oldPassword`,modelValue:Z.oldPassword,"onUpdate:modelValue":l[7]||=e=>Z.oldPassword=e,type:`password`,class:b({"border-destructive":Q.oldPassword}),placeholder:`请输入当前密码`},null,8,[`modelValue`,`class`]),Q.oldPassword?(k(),L(`p`,ke,p(Q.oldPassword),1)):v(``,!0)]),f(`div`,Ae,[x(S(a),{for:`newPassword`},{default:s(()=>[...l[37]||=[d(` 新密码 `,-1),f(`span`,{class:`text-destructive`},`*`,-1)]]),_:1}),x(S(z),{id:`newPassword`,modelValue:Z.newPassword,"onUpdate:modelValue":l[8]||=e=>Z.newPassword=e,type:`password`,class:b({"border-destructive":Q.newPassword}),placeholder:`请输入新密码（至少6位）`},null,8,[`modelValue`,`class`]),Q.newPassword?(k(),L(`p`,je,p(Q.newPassword),1)):v(``,!0)]),f(`div`,Me,[x(S(a),{for:`confirmPassword`},{default:s(()=>[...l[38]||=[d(` 确认新密码 `,-1),f(`span`,{class:`text-destructive`},`*`,-1)]]),_:1}),x(S(z),{id:`confirmPassword`,modelValue:Z.confirmPassword,"onUpdate:modelValue":l[9]||=e=>Z.confirmPassword=e,type:`password`,class:b({"border-destructive":Q.confirmPassword}),placeholder:`请再次输入新密码`},null,8,[`modelValue`,`class`]),Q.confirmPassword?(k(),L(`p`,Ne,p(Q.confirmPassword),1)):v(``,!0)])]),x(S(K),null,{default:s(()=>[x(S(O),{variant:`outline`,onClick:l[10]||=e=>Z.open=!1},{default:s(()=>[...l[39]||=[d(` 取消 `,-1)]]),_:1}),x(S(O),{onClick:Ve,disabled:X.password},{default:s(()=>[X.password?(k(),m(S(A),{key:0,class:`h-4 w-4 mr-2 animate-spin`})):v(``,!0),d(` `+p(X.password?`修改中...`:`确认修改`),1)]),_:1},8,[`disabled`])]),_:1})]),_:1})]),_:1},8,[`open`])]))}});export{Y as default};
import{Bi as e,Gn as t,Ha as n,Ii as r,Ki as i,La as a,Li as o,Pa as s,Ri as c,Ui as l,Vi as u,Wa as d,Wi as f,ar as p,ba as m,ir as h,ji as g,la as _,qa as v,sa as y,sn as b,ua as x,va as S,wa as C,zi as w}from"./index-Bdnse1ke.js";import{B as T,c as E,t as D}from"./dist-CIVP1JAM.js";import{i as O,n as k,r as A,t as j}from"./theme-shared-CKGE9ZaP.js";import{t as M}from"./useTableColumns-ClPoF4Nv.js";import{t as N}from"./useResponsive-Drj8-vqi.js";function P(){let e=t();return r(()=>{let t=e.currentColors,n=e.layoutConfig.radius,r=e.currentMode===`dark`,i=k(r),a=j(n),o=A(t);return{algorithm:r?D.darkAlgorithm:D.defaultAlgorithm,token:{colorPrimary:O(t.primary),colorBgContainer:O(t.background),colorBgElevated:O(t.card),colorText:O(t.foreground),colorTextSecondary:O(t.mutedForeground),colorBorder:O(t.border),colorError:O(t.destructive),borderRadius:a.borderRadius,borderRadiusSM:a.borderRadiusSM,borderRadiusLG:a.borderRadiusLG,boxShadow:i.boxShadow,boxShadowSecondary:i.boxShadowSecondary,paddingSM:8,padding:12,paddingMD:16,paddingLG:20,paddingXL:24,fontSizeSM:12,fontSize:14,fontSizeLG:16,fontSizeXL:18},components:{...o,Table:{colorBgContainer:O(t.background),colorText:O(t.foreground),colorTextHeading:O(t.foreground),colorBorder:O(t.border),colorSplit:O(t.border),colorBgTextHover:O(t.muted),colorFillAlter:O(t.muted),colorFillContent:O(t.card),boxShadow:i.boxShadow,borderRadius:a.borderRadius},Pagination:{colorBgContainer:O(t.background),colorBgTextHover:O(t.muted),colorText:O(t.foreground),colorTextDisabled:O(t.mutedForeground),colorBorder:O(t.border),colorPrimary:O(t.primary),borderRadius:a.borderRadius}}}})}var F={class:`flex items-center gap-3`},I={key:2,class:`text-xs text-muted-foreground bg-muted px-2 py-0.5 rounded-full`},L={class:`flex flex-col items-center justify-center py-8 text-muted-foreground`},R=i({name:`TTable`,__name:`TTable`,props:{schema:{},data:{default:()=>[]},loading:{type:Boolean,default:!1}},emits:[`update:data`,`change`,`selectChange`,`expand`,`update:expandedRowKeys`],setup(t,{expose:i,emit:D}){let O=t,k=D,{t:A,locale:j}=p(),{currentBreakpoint:R,isMobile:ee,smallerThan:z}=N(),B=r(()=>O.schema.responsive||{enabled:!0}),V=r(()=>B.value.enabled!==!1),H=r(()=>B.value.mobileBreakpoint||`md`),U=r(()=>V.value?z(H.value):!1),W=P(),G=s(null);async function K(){let e=j.value;G.value=await h(e)}m(j,K,{immediate:!0});let q=S(),J=a(null),Y=s({selectedRowKeys:[],selectedRows:[],expandedRowKeys:[],pagination:{current:1,pageSize:10,total:0}}),X=r({get:()=>O.data||[],set:e=>k(`update:data`,e)}),Z=r(()=>typeof O.schema.rowKey==`function`?O.schema.rowKey:O.schema.rowKey||`id`);function Q(e){if(typeof Z.value==`function`)return Z.value(e);if(typeof Z.value==`string`){let t=e[Z.value];if(t!==void 0)return t}return e.id===void 0?e.key===void 0?JSON.stringify(e):e.key:e.id}let{tableColumns:$,showActionColumn:te}=M({columns:r(()=>O.schema.columns||[]),actions:r(()=>O.schema.actions||[]),actionTitle:r(()=>O.schema.actionTitle),actionWidth:r(()=>O.schema.actionWidth||150),actionFixed:r(()=>O.schema.actionFixed||`right`)}),ne=r(()=>{if(!V.value||!U.value||B.value.enableHorizontalScrollOnMobile!==!1)return $.value;let e=B.value.hideColumnsOnMobile||[],t=[`xs`,`sm`,`md`,`lg`,`xl`,`2xl`];return $.value.filter(n=>{let r=n.key||n.dataIndex;if(r&&e.includes(String(r)))return!1;let i=n;if(i.hiddenOn){let e=t.indexOf(R.value);if(i.hiddenOn.some(n=>t.indexOf(n)>=e))return!1}if(i.showOn){let e=t.indexOf(R.value);if(!i.showOn.some(n=>t.indexOf(n)<=e))return!1}return!0})}),re=r(()=>{let e=O.schema.scroll||{};if(!V.value||!U.value)return e;if(B.value.enableHorizontalScrollOnMobile!==!1){if(B.value.scrollXOnMobile!==void 0)return{...e,x:B.value.scrollXOnMobile};let t=$.value.reduce((e,t)=>{let n=t.width,r=t.minWidth;return typeof n==`number`?e+n:typeof r==`number`?e+r:e+120},0);return{...e,x:Math.max(t,600)}}return e}),ie=r(()=>{if(!O.schema.rowSelection||O.schema.rowSelection.show===!1)return;let e=O.schema.rowSelection;return{type:e.type||`checkbox`,selectedRowKeys:Y.value.selectedRowKeys,columnWidth:e.columnWidth,columnTitle:e.columnTitle,fixed:e.fixed,hideSelectAll:e.hideSelectAll,selections:e.selections,getCheckboxProps:e.getCheckboxProps,preserveSelectedRowKeys:e.preserveSelectedRowKeys,checkStrictly:e.checkStrictly,onChange:(e,t)=>{Y.value.selectedRowKeys=e,Y.value.selectedRows=t,k(`selectChange`,e,t)}}}),ae=r(()=>{if(O.schema.pagination===!1)return!1;let e=O.schema.pagination||{},t={current:Y.value.pagination.current,pageSize:Y.value.pagination.pageSize,total:Y.value.pagination.total,pageSizeOptions:e.pageSizeOptions||[`10`,`20`,`50`,`100`],showQuickJumper:e.showQuickJumper??!0,showSizeChanger:e.showSizeChanger??!0,showTotal:e.showTotal===!1?void 0:e=>A(`common.total`,{total:e}),simple:e.simple,...e};return V.value&&U.value&&B.value.simplePaginationOnMobile!==!1?{...t,simple:!0,showQuickJumper:!1,showSizeChanger:!1,showTotal:!1}:t}),oe=r(()=>{if(!O.schema.expandable)return;let e=O.schema.expandable;return{defaultExpandAllRows:e.defaultExpandAllRows,defaultExpandedRowKeys:e.defaultExpandedRowKeys,expandedRowKeys:Y.value.expandedRowKeys,rowExpandable:e.rowExpandable,expandIconColumnIndex:e.expandIconColumnIndex,expandIcon:e.expandIcon,expandedRowRender:e.expandedRowRender||(q.expandedRow,void 0),onExpand:(e,t)=>{let n=Q(t);e?Y.value.expandedRowKeys=[...Y.value.expandedRowKeys,n]:Y.value.expandedRowKeys=Y.value.expandedRowKeys.filter(e=>e!==n),k(`expand`,e,t),k(`update:expandedRowKeys`,Y.value.expandedRowKeys)}}});function se(e,t,n){Y.value.pagination.current=e.current,Y.value.pagination.pageSize=e.pageSize,k(`change`,e,t,{field:n.field,order:n.order,column:O.schema.columns.find(e=>e.dataIndex===n.field)})}return i({getSelectedRows:()=>Y.value.selectedRows,getSelectedRowKeys:()=>Y.value.selectedRowKeys,setSelectedRows:e=>{Y.value.selectedRowKeys=e;let t=typeof Z.value==`string`?Z.value:`id`;Y.value.selectedRows=X.value.filter(n=>e.includes(n[t]))},clearSelection:()=>{Y.value.selectedRowKeys=[],Y.value.selectedRows=[]},getTableInstance:()=>J.value??void 0,refresh:()=>{k(`change`,{...Y.value.pagination},{},{field:``,order:void 0,column:void 0})},getPagination:()=>({...Y.value.pagination}),setPagination:e=>{e.current!==void 0&&(Y.value.pagination.current=e.current),e.pageSize!==void 0&&(Y.value.pagination.pageSize=e.pageSize),e.total!==void 0&&(Y.value.pagination.total=e.total)},expandRow:(e,t=!0)=>{let n=Q(e),r=Y.value.expandedRowKeys.indexOf(n);t&&r===-1?Y.value.expandedRowKeys.push(n):!t&&r>-1&&Y.value.expandedRowKeys.splice(r,1)},expandAllRows:()=>{Y.value.expandedRowKeys=X.value.map(e=>Q(e))},collapseAllRows:()=>{Y.value.expandedRowKeys=[]}}),m(()=>O.data,e=>{if(e){let t=typeof Z.value==`string`?Z.value:`id`;Y.value.selectedRows=e.filter(e=>Y.value.selectedRowKeys.includes(e[t]))}},{deep:!0}),m(()=>{let e=O.schema.pagination;return typeof e==`object`?e.total:void 0},e=>{e!==void 0&&(Y.value.pagination.total=e)},{immediate:!0}),m(()=>O.schema.rowSelection?.selectedRowKeys,e=>{if(e){Y.value.selectedRowKeys=e;let t=typeof Z.value==`string`?Z.value:`id`;Y.value.selectedRows=X.value.filter(n=>e.includes(n[t]))}},{immediate:!0}),m(()=>O.schema.expandable?.expandedRowKeys,e=>{e&&(Y.value.expandedRowKeys=e)},{immediate:!0}),(r,i)=>{let a=E;return G.value?(y(),c(n(T),{key:0,theme:n(W),locale:G.value},{default:C(()=>[f(a,{ref_key:`tableRef`,ref:J,"data-source":X.value,columns:ne.value,"row-key":Z.value,loading:t.loading||t.schema.loading,size:t.schema.size||`middle`,bordered:t.schema.bordered,pagination:ae.value,"row-selection":ie.value,scroll:re.value,"show-header":t.schema.showHeader!==!1,"table-layout":t.schema.tableLayout,virtual:t.schema.virtual,sticky:t.schema.sticky,expandable:oe.value,"children-column-name":t.schema.childrenColumnName||`children`,"indent-size":t.schema.indentSize??15,class:d(n(b)(`t-table`,r.$attrs.class)),onChange:se},u({bodyCell:C(({column:i,text:a,record:o,index:s})=>[(y(!0),e(g,null,_(t.schema.columns,t=>(y(),e(g,{key:t.key||t.dataIndex},[(t.key||t.dataIndex)===i.key&&t.slot&&n(q)[t.slot]?x(r.$slots,t.slot,{key:0,text:a,record:o,index:s,column:t}):w(``,!0)],64))),128))]),headerCell:C(({column:i,text:a,index:o})=>[(y(!0),e(g,null,_(t.schema.columns,t=>(y(),e(g,{key:t.key||t.dataIndex},[(t.key||t.dataIndex)===i.key&&t.headerSlot&&n(q)[t.headerSlot]?x(r.$slots,t.headerSlot,{key:0,title:a,column:t,index:o}):w(``,!0)],64))),128))]),_:2},[t.schema.title||n(q).title||t.schema.showTotalBadge?{name:`title`,fn:C(()=>[x(r.$slots,`title`,{data:X.value},()=>[o(`div`,F,[typeof t.schema.title==`function`?(y(),e(g,{key:0},[l(v(t.schema.title(X.value)),1)],64)):(y(),e(g,{key:1},[l(v(t.schema.title),1)],64)),t.schema.showTotalBadge?(y(),e(`span`,I,v(n(A)(`common.total`,{total:X.value.length})),1)):w(``,!0)])])]),key:`0`}:void 0,t.schema.footer||n(q).footer?{name:`footer`,fn:C(()=>[x(r.$slots,`footer`,{data:X.value},()=>[typeof t.schema.footer==`function`?(y(),e(g,{key:0},[l(v(t.schema.footer(X.value)),1)],64)):(y(),e(g,{key:1},[l(v(t.schema.footer),1)],64))])]),key:`1`}:void 0,t.schema.summary?.slot||n(q).summary||t.schema.summary?.render?{name:`summary`,fn:C(()=>[x(r.$slots,`summary`,{data:X.value},()=>[t.schema.summary?.render?(y(),e(g,{key:0},[l(v(t.schema.summary.render(X.value)),1)],64)):w(``,!0)])]),key:`2`}:void 0,t.schema.emptySlot||n(q).emptyText?{name:`emptyText`,fn:C(()=>[x(r.$slots,`emptyText`,{},()=>[o(`div`,L,[i[0]||=o(`svg`,{class:`w-12 h-12 mb-4 text-muted-foreground/50`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},[o(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`1.5`,d:`M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z`})],-1),o(`p`,null,v(t.schema.emptyText||n(A)(`common.noData`)),1)])])]),key:`3`}:void 0,t.schema.expandable?.expandedRowSlot||n(q).expandedRow?{name:`expandedRowRender`,fn:C(({record:e,index:t,indent:n,expanded:i})=>[x(r.$slots,`expandedRow`,{record:e,index:t,indent:n,expanded:i})]),key:`4`}:void 0,n(q).expandIcon?{name:`expandIcon`,fn:C(({expanded:e,onExpand:t,record:n,expandable:i})=>[x(r.$slots,`expandIcon`,{expanded:e,onExpand:t,record:n,expandable:i})]),key:`5`}:void 0]),1032,[`data-source`,`columns`,`row-key`,`loading`,`size`,`bordered`,`pagination`,`row-selection`,`scroll`,`show-header`,`table-layout`,`virtual`,`sticky`,`expandable`,`children-column-name`,`indent-size`,`class`])]),_:3},8,[`theme`,`locale`])):w(``,!0)}}});export{R as t};
import"./ScrollArea-CW0-18Hy.js";import"./RovingFocusItem-DihGLheP.js";import{t as e}from"./button-Bo4o88Eb.js";import"./Presence-CX2vXdhf.js";import"./defu-BJL4Fjh2.js";import"./usePrimitiveElement-bvCn2QxH.js";import"./TabsTrigger-EHjOJe4X.js";import{$n as t,An as n,Ct as r,Di as i,Ea as a,Gi as ee,It as o,K as te,M as s,Oa as c,Ti as l,Ui as u,Yi as ne,_i as d,bi as re,da as f,fi as ie,ga as p,ka as m,o as h,oa as g,p as _,vi as v,wa as y,wi as b,xi as x,yi as S,z as ae}from"./index-D9LA8apy.js";import"./en_US-N9Q-_HQi.js";import"./common-rttX-sZZ.js";import"./zh_CN-RQJLYl9H.js";import"./useTabBar-WvhELTvw.js";import{t as oe}from"./badge-DoBLqkFL.js";import{n as se,t as ce}from"./CardContent-bGWyUVF7.js";import{n as le,t as ue}from"./CardTitle-9YsRePqj.js";import"./dist-guKItzxh.js";import{t as de}from"./TTable-BJXg8Gts.js";import{t as C}from"./TForm-De-AxzjP.js";import"./Input-DxyLxkUT.js";import"./TIcon-DpsAxes7.js";import{t as w}from"./TModal-l0DmcJma.js";import{n as T,r as E}from"./composables-B_2v-ght.js";import"./constants-BrhrixW3.js";var D={class:`space-y-6`},O={class:`flex flex-col sm:flex-row sm:items-center justify-between gap-4`},k={class:`flex flex-wrap gap-3`},A={class:`flex items-baseline gap-2`},j={class:`text-lg font-semibold`},M={class:`text-xs text-muted-foreground`},N={class:`bg-muted/30 rounded-lg p-4`},P={class:`flex flex-col lg:flex-row lg:items-center gap-4`},F={class:`flex-1`},I={class:`flex items-center gap-3`},L={class:`text-xs text-muted-foreground bg-muted px-2 py-0.5 rounded-full`},R={class:`flex items-center gap-2`},z={class:`font-medium`},B={class:`flex items-center gap-1 text-sm`},V={class:`flex items-center gap-1 text-sm`},H={class:`space-y-1`},fe={class:`flex justify-between text-xs`},pe={class:`h-1.5 bg-muted rounded-full overflow-hidden`},me={class:`flex flex-col items-center justify-center py-12 text-muted-foreground`},he={class:`w-16 h-16 rounded-full bg-muted flex items-center justify-center mb-4`},ge=i({__name:`Warehouse`,setup(i){let{data:ge,loading:_e,searchQuery:U,filters:W,filteredData:ve,paginatedData:ye,total:be,statistics:xe,fetchData:G}=T({apiCall:()=>n.getWarehouses(),filterFn:(e,t,n)=>{let r=e;if(t){let e=t.toLowerCase();r=r.filter(t=>t.name.toLowerCase().includes(e)||t.code.toLowerCase().includes(e))}return n.status&&(r=r.filter(e=>e.status===n.status)),r},statisticsFn:e=>{let n=e.length,r=e.filter(e=>e.status===t.ACTIVE).length,i=e.reduce((e,t)=>e+t.capacity,0),a=e.reduce((e,t)=>e+t.usedCapacity,0);return{total:n,active:r,totalCapacity:i,usedCapacity:a,utilizationRate:i>0?Math.round(a/i*100):0}}}),Se=d(()=>{let e=xe.value||{};return[{title:`仓库总数`,value:e.total||0,icon:o,color:`text-blue-500`},{title:`运营中`,value:e.active||0,icon:r,color:`text-green-500`},{title:`总容量`,value:(e.totalCapacity||0).toLocaleString(),icon:ae,color:`text-purple-500`},{title:`使用率`,value:(e.utilizationRate||0)+`%`,icon:_,color:`text-orange-500`}]}),K=p({keyword:``,status:``}),Ce={layout:`inline`,fields:[{name:`keyword`,type:`input`,label:``,placeholder:`搜索仓库名称、编码...`,className:`w-[240px]`},{name:`status`,type:`select`,label:``,placeholder:`全部状态`,options:[{label:`全部状态`,value:``},{label:`运营中`,value:t.ACTIVE},{label:`已停用`,value:t.INACTIVE}],className:`w-[140px]`}],searchConfig:{enabled:!0,collapsed:!1,showCollapseButton:!1,searchText:`搜索`,resetText:`重置`,showReset:!0,onSearch:e=>{U.value=e.keyword||``,W.value={status:e.status}},onReset:()=>{U.value=``,W.value={}}}},we=d(()=>({columns:[{title:`仓库信息`,dataIndex:`name`,width:200,slot:`name`},{title:`仓库编码`,dataIndex:`code`,width:120},{title:`位置`,dataIndex:`location`,width:180,slot:`location`},{title:`负责人`,dataIndex:`manager`,width:120,slot:`manager`},{title:`容量使用`,dataIndex:`capacity`,width:150,slot:`capacity`},{title:`商品数量`,dataIndex:`productCount`,width:100,sorter:!0},{title:`状态`,dataIndex:`status`,width:100,slot:`status`}],pagination:{pageSize:10,show:!0,showSizeChanger:!0},rowSelection:{type:`checkbox`,show:!0},actions:[{text:`编辑`,type:`primary`,onClick:e=>$(e)},{text:`删除`,type:`danger`,confirm:!0,confirmText:`确定要删除该仓库吗？`,onClick:e=>Ne(e.id)}],actionWidth:150,actionFixed:`right`})),q=d(()=>ye.value.map(e=>({...e,key:e.id}))),J=p(!1),Y=p(!1),X=p(null),Z=p({name:``,code:``,location:``,manager:``,phone:``,capacity:1e3,status:`active`}),Q=p({id:``,name:``,code:``,location:``,manager:``,phone:``,capacity:1e3,status:`active`}),Te={layout:`horizontal`,labelCol:{span:6},wrapperCol:{span:18},fields:[{name:`name`,type:`input`,label:`仓库名称`,placeholder:`请输入仓库名称`,rules:[{required:!0,message:`仓库名称不能为空`}]},{name:`code`,type:`input`,label:`仓库编码`,placeholder:`请输入仓库编码`,rules:[{required:!0,message:`仓库编码不能为空`}]},{name:`location`,type:`input`,label:`仓库位置`,placeholder:`请输入详细地址`,rules:[{required:!0,message:`仓库位置不能为空`}]},{name:`manager`,type:`input`,label:`负责人`,placeholder:`请输入负责人姓名`,rules:[{required:!0,message:`负责人不能为空`}]},{name:`phone`,type:`input`,label:`联系电话`,placeholder:`请输入联系电话`},{name:`capacity`,type:`number`,label:`仓库容量`,placeholder:`请输入容量`,rules:[{required:!0,message:`仓库容量不能为空`}]},{name:`status`,type:`select`,label:`状态`,placeholder:`请选择状态`,options:[{label:`运营中`,value:`active`},{label:`已停用`,value:`inactive`}]}],actions:{showSubmit:!0,showReset:!0,submitText:`添加仓库`,resetText:`取消`,align:`right`,onReset:()=>{J.value=!1}}},Ee={layout:`horizontal`,labelCol:{span:6},wrapperCol:{span:18},fields:[{name:`name`,type:`input`,label:`仓库名称`,placeholder:`请输入仓库名称`,rules:[{required:!0,message:`仓库名称不能为空`}]},{name:`location`,type:`input`,label:`仓库位置`,placeholder:`请输入详细地址`},{name:`manager`,type:`input`,label:`负责人`,placeholder:`请输入负责人姓名`},{name:`phone`,type:`input`,label:`联系电话`,placeholder:`请输入联系电话`},{name:`capacity`,type:`number`,label:`仓库容量`,placeholder:`请输入容量`},{name:`status`,type:`select`,label:`状态`,placeholder:`请选择状态`,options:[{label:`运营中`,value:`active`},{label:`已停用`,value:`inactive`}]}],actions:{showSubmit:!0,showReset:!0,submitText:`保存修改`,resetText:`取消`,align:`right`,onReset:()=>{Y.value=!1}}},{mutate:De}=E({mutationFn:e=>n.createWarehouse({name:e.name,code:e.code,location:e.location,manager:e.manager,phone:e.phone,capacity:Number(e.capacity),status:e.status,productCount:0,usedCapacity:0}),onSuccess:()=>{J.value=!1,Z.value={name:``,code:``,location:``,manager:``,phone:``,capacity:1e3,status:`active`},G()}}),{mutate:Oe,loading:ke}=E({mutationFn:({id:e,values:t})=>n.updateWarehouse(e,{name:t.name,location:t.location,manager:t.manager,phone:t.phone,capacity:Number(t.capacity),status:t.status}),onSuccess:()=>{Y.value=!1,X.value=null,G()}}),{mutate:Ae}=E({mutationFn:e=>n.deleteWarehouse(e),onSuccess:()=>G()});function $(e){X.value=e,Q.value={id:e.id,name:e.name,code:e.code,location:e.location,manager:e.manager,phone:e.phone,capacity:e.capacity,status:e.status},Y.value=!0}function je(e){De(e)}function Me(e){X.value&&Oe({id:X.value.id,values:e})}function Ne(e){Ae(e)}let Pe=p([]);function Fe(e){Pe.value=e}return(n,r)=>(u(),x(`div`,D,[v(`div`,O,[r[9]||=v(`div`,null,[v(`h1`,{class:`text-3xl font-bold tracking-tight`},`仓库管理`),v(`p`,{class:`text-muted-foreground mt-1.5 text-sm`},`管理仓库信息和容量`)],-1),l(y(e),{class:`gap-2`,onClick:r[0]||=e=>J.value=!0},{default:g(()=>[l(y(s),{class:`h-4 w-4`}),r[8]||=b(` 添加仓库 `,-1)]),_:1})]),l(y(w),{open:y(J),"onUpdate:open":r[2]||=e=>f(J)?J.value=e:null,title:`添加仓库`,width:`560`,footer:null},{default:g(()=>[l(y(C),{modelValue:y(Z),"onUpdate:modelValue":r[1]||=e=>f(Z)?Z.value=e:null,schema:Te,onSubmit:je},null,8,[`modelValue`])]),_:1},8,[`open`]),l(y(w),{open:y(Y),"onUpdate:open":r[4]||=e=>f(Y)?Y.value=e:null,title:`编辑仓库`,width:`560`,footer:null},{default:g(()=>[y(X)?(u(),S(y(C),{key:0,modelValue:y(Q),"onUpdate:modelValue":r[3]||=e=>f(Q)?Q.value=e:null,schema:Ee,onSubmit:Me},null,8,[`modelValue`])):re(``,!0)]),_:1},8,[`open`]),v(`div`,k,[(u(!0),x(ie,null,ee(y(Se),e=>(u(),x(`div`,{key:e.title,class:`flex items-center gap-3 px-4 py-2.5 bg-muted/50 rounded-lg hover:bg-muted/70 transition-colors`},[(u(),S(ne(e.icon),{class:a([`h-4 w-4`,e.color])},null,8,[`class`])),v(`div`,A,[v(`span`,j,m(e.value),1),v(`span`,M,m(e.title),1)])]))),128))]),v(`div`,N,[v(`div`,P,[v(`div`,F,[l(y(C),{modelValue:y(K),"onUpdate:modelValue":r[5]||=e=>f(K)?K.value=e:null,schema:Ce},null,8,[`modelValue`])])])]),l(y(se),{class:`border-0 shadow-sm`},{default:g(()=>[l(y(le),{class:`pb-4`},{default:g(()=>[v(`div`,I,[l(y(ue),{class:`text-base font-semibold`},{default:g(()=>[...r[10]||=[b(`仓库列表`,-1)]]),_:1}),v(`span`,L,` 共 `+m(y(q).length)+` 个 `,1)])]),_:1}),l(y(ce),{class:`pt-0`},{default:g(()=>[l(y(de),{ref:`tableRef`,data:y(q),"onUpdate:data":r[7]||=e=>f(q)?q.value=e:null,schema:y(we),onSelectChange:Fe},{name:g(e=>[v(`div`,R,[l(y(o),{class:`h-4 w-4 text-blue-500`}),v(`span`,z,m(e.text),1)])]),location:g(e=>[v(`div`,B,[l(y(te),{class:`h-3 w-3 text-muted-foreground`}),v(`span`,null,m(e.text),1)])]),manager:g(e=>[v(`div`,V,[l(y(h),{class:`h-3 w-3 text-muted-foreground`}),v(`span`,null,m(e.text),1)])]),capacity:g(e=>[v(`div`,H,[v(`div`,fe,[v(`span`,null,m(e.record.usedCapacity)+` / `+m(e.text),1),v(`span`,null,m(Math.round(e.record.usedCapacity/e.text*100))+`%`,1)]),v(`div`,pe,[v(`div`,{class:`h-full bg-primary rounded-full`,style:c({width:`${Math.min(e.record.usedCapacity/e.text*100,100)}%`})},null,4)])])]),status:g(e=>[l(y(oe),{class:a({"bg-green-500/10 text-green-500 border-green-500/20":e.text===y(t).ACTIVE,"bg-gray-500/10 text-gray-500 border-gray-500/20":e.text===y(t).INACTIVE}),variant:`outline`},{default:g(()=>[b(m(e.text===y(t).ACTIVE?`运营中`:`已停用`),1)]),_:2},1032,[`class`])]),emptyText:g(()=>[v(`div`,me,[v(`div`,he,[l(y(o),{class:`w-8 h-8 text-muted-foreground/50`})]),r[12]||=v(`p`,{class:`text-base font-medium mb-1`},`暂无仓库数据`,-1),r[13]||=v(`p`,{class:`text-sm text-muted-foreground mb-4`},`开始添加您的第一个仓库吧`,-1),l(y(e),{size:`sm`,onClick:r[6]||=e=>J.value=!0},{default:g(()=>[l(y(s),{class:`h-4 w-4 mr-1`}),r[11]||=b(` 添加仓库 `,-1)]),_:1})])]),_:1},8,[`data`,`schema`])]),_:1})]),_:1})]))}});export{ge as default};
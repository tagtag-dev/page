import"./ScrollArea-BHIjOMNw.js";import"./RovingFocusItem-0I5l88nS.js";import{a as e,c as t,i as n,n as r,o as i,r as a,s as ee,t as te}from"./AvatarImage-BkzNfgq2.js";import"./nullish-DL6NfjKe.js";import"./Presence-jUNGdmIs.js";import{t as o}from"./Label-DQu5-Ke8.js";import{t as s}from"./Separator-7sq3l2Q0.js";import"./TabsTrigger-CXLxDRQL.js";import{Bi as c,Ei as l,Ha as u,Ii as d,Ki as f,Kn as ne,L as re,Li as p,N as m,Na as h,Pa as g,Ri as _,Ta as v,Ui as y,Wa as b,Wi as x,Xt as S,Yt as C,Zt as w,at as T,bt as E,ia as ie,m as ae,n as D,nr as O,nt as oe,ot as k,qa as A,rt as j,sa as M,sn as N,u as P,ua as F,wa as I,zi as L}from"./index-DX59uxwP.js";import"./en_US-B-0xvqcl.js";import"./common-B6eu2cAW.js";import"./zh_CN-o6dt8jMH.js";import"./_plugin-vue_export-helper-CuErARa7.js";import{z as R}from"./dist-C2ERyVuF.js";import"./theme-shared-Cg7vXLFh.js";import"./TTable-CkpzGCtr.js";import"./useTableColumns-D4Iah3In.js";import"./useResponsive-BcMiRh3c.js";import"./TForm-9yrohHqo.js";import{r as z}from"./TIcon-Bi65ixMm.js";import"./TModal-CdyAUA57.js";import{n as B,t as V}from"./CardContent-DuACdMkv.js";import{t as H}from"./CardDescription-CEQa-hsl.js";import{n as U,t as W}from"./CardTitle-Bo9EKq0R.js";import"./business-BVSdW6dz.js";import"./TStatusBadge-f3R66_N2.js";import{t as G}from"./TPageHeader-CJkosdMS.js";import"./TEmptyState-BRRb5Xhi.js";import"./TBatchActions-C1BbakMa.js";var K=f({__name:`DialogFooter`,props:{class:{}},setup(e){let t=e;return(e,n)=>(M(),c(`div`,{"data-slot":`dialog-footer`,class:b(u(N)(`flex flex-col-reverse gap-2 sm:flex-row sm:justify-end`,t.class))},[F(e.$slots,`default`)],2))}}),q={class:`space-y-6`},J={class:`grid grid-cols-1 lg:grid-cols-3 gap-6`},se={class:`lg:col-span-2 space-y-6`},ce={class:`flex items-center gap-4`},le={class:`relative`},ue={key:0,class:`absolute inset-0 flex items-center justify-center bg-black/50 rounded-full`},de={class:`grid grid-cols-1 md:grid-cols-2 gap-4`},fe={class:`space-y-2`},pe={key:0,class:`text-xs text-destructive`},me={class:`space-y-2`},he={class:`space-y-2`},ge={key:0,class:`text-xs text-destructive`},_e={class:`space-y-2`},ve={class:`space-y-2`},ye={class:`space-y-2`},be={class:`space-y-2`},xe={class:`flex justify-end`},Se={class:`space-y-6`},Ce={class:`flex items-center gap-3 text-sm`},we={class:`flex items-center gap-3 text-sm`},Te={class:`flex items-center gap-3 text-sm`},Ee={class:`flex items-center gap-3 text-sm`},De={class:`space-y-4 py-4`},Oe={class:`space-y-2`},ke={key:0,class:`text-xs text-destructive`},Ae={class:`space-y-2`},je={key:0,class:`text-xs text-destructive`},Me={class:`space-y-2`},Ne={key:0,class:`text-xs text-destructive`},Y=f({__name:`index`,setup(f){let N=ne(),F=h({}),Y=h({name:``,email:``,phone:``,avatar:``,address:``,department:``,position:``,bio:``}),X=h({profile:!1,avatar:!1,password:!1}),Z=h({open:!1,oldPassword:``,newPassword:``,confirmPassword:``}),Q=h({}),$=g(null),Pe=()=>{let e=N.user;e&&(Y.name=e.name||``,Y.email=e.email||``,Y.phone=e.phone||``,Y.avatar=e.avatar||``,Y.address=e.address||``,Y.department=e.department||``,Y.position=e.position||``,Y.bio=e.bio||``)},Fe=()=>{F.name=``,F.phone=``,F.email=``;let e=!0;return Y.name.trim()?(Y.name.length<2||Y.name.length>20)&&(F.name=`姓名长度应在 2-20 个字符之间`,e=!1):(F.name=`请输入姓名`,e=!1),Y.phone&&!/^1[3-9]\d{9}$/.test(Y.phone)&&(F.phone=`请输入有效的手机号码`,e=!1),Y.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(Y.email)&&(F.email=`请输入有效的邮箱地址`,e=!1),e},Ie=async()=>{if(Fe()){X.profile=!0;try{let e=await O.updateProfile({name:Y.name,phone:Y.phone,address:Y.address,department:Y.department,position:Y.position,bio:Y.bio,avatar:Y.avatar});N.user={...N.user,...e},R.success(`个人资料保存成功`)}catch(e){console.error(`保存个人资料失败:`,e),R.error(`保存失败，请稍后重试`)}finally{X.profile=!1}}},Le=()=>{$.value?.click()},Re=async e=>{let t=e.target.files?.[0];if(t){if(!t.type.startsWith(`image/`)){R.error(`请选择图片文件`);return}if(t.size>2*1024*1024){R.error(`图片大小不能超过 2MB`);return}X.avatar=!0;try{let{avatarUrl:e}=await O.uploadAvatar(t);Y.avatar=e,await O.updateProfile({avatar:e}),N.user&&(N.user.avatar=e),R.success(`头像上传成功`)}catch(e){console.error(`上传头像失败:`,e),R.error(`上传失败，请稍后重试`)}finally{X.avatar=!1,$.value&&($.value.value=``)}}},ze=()=>{Z.open=!0,Z.oldPassword=``,Z.newPassword=``,Z.confirmPassword=``,Q.oldPassword=``,Q.newPassword=``,Q.confirmPassword=``},Be=()=>{Q.oldPassword=``,Q.newPassword=``,Q.confirmPassword=``;let e=!0;return Z.oldPassword||(Q.oldPassword=`请输入当前密码`,e=!1),Z.newPassword?Z.newPassword.length<6&&(Q.newPassword=`密码长度至少为 6 位`,e=!1):(Q.newPassword=`请输入新密码`,e=!1),Z.confirmPassword?Z.newPassword!==Z.confirmPassword&&(Q.confirmPassword=`两次输入的密码不一致`,e=!1):(Q.confirmPassword=`请确认新密码`,e=!1),e},Ve=async()=>{if(Be()){X.password=!0;try{await O.changePassword({oldPassword:Z.oldPassword,newPassword:Z.newPassword}),R.success(`密码修改成功`),Z.open=!1}catch(e){console.error(`修改密码失败:`,e),R.error(`修改密码失败，请检查当前密码是否正确`)}finally{X.password=!1}}},He=d(()=>Y.name?.charAt(0).toUpperCase()||`U`),Ue=e=>e?new Date(e).toLocaleDateString(`zh-CN`):`-`;return ie(()=>{Pe()}),(d,f)=>(M(),c(`div`,q,[x(u(G),{title:`个人资料`,subtitle:`管理您的个人信息和账户安全`}),p(`div`,J,[p(`div`,se,[x(u(B),{class:`bg-muted/40 border border-border/50 rounded-xl`},{default:I(()=>[x(u(U),null,{default:I(()=>[x(u(W),{class:`flex items-center gap-2`},{default:I(()=>[x(u(P),{class:`h-5 w-5`}),f[12]||=y(` 基本信息 `,-1)]),_:1}),x(u(H),null,{default:I(()=>[...f[13]||=[y(`更新您的个人信息`,-1)]]),_:1})]),_:1}),x(u(V),{class:`space-y-6`},{default:I(()=>[p(`div`,ce,[p(`div`,le,[x(u(a),{class:`h-24 w-24`},{default:I(()=>[Y.avatar?(M(),_(u(te),{key:0,src:Y.avatar},null,8,[`src`])):L(``,!0),x(u(r),{class:`text-3xl bg-primary text-primary-foreground`},{default:I(()=>[y(A(He.value),1)]),_:1})]),_:1}),X.avatar?(M(),c(`button`,ue,[x(u(k),{class:`h-8 w-8 text-white animate-spin`})])):L(``,!0)]),p(`div`,null,[p(`input`,{ref_key:`avatarInputRef`,ref:$,type:`file`,accept:`image/*`,class:`hidden`,onChange:Re},null,544),x(u(D),{variant:`outline`,disabled:X.avatar,onClick:Le},{default:I(()=>[x(u(ae),{class:`h-4 w-4 mr-2`}),f[14]||=y(` 更换头像 `,-1)]),_:1},8,[`disabled`]),f[15]||=p(`p`,{class:`text-xs text-muted-foreground mt-2`},` 支持 JPG、PNG 格式，文件大小不超过 2MB `,-1)])]),x(u(s)),p(`div`,de,[p(`div`,fe,[x(u(o),{for:`name`},{default:I(()=>[...f[16]||=[y(` 姓名 `,-1),p(`span`,{class:`text-destructive`},`*`,-1)]]),_:1}),x(u(z),{id:`name`,modelValue:Y.name,"onUpdate:modelValue":f[0]||=e=>Y.name=e,class:b({"border-destructive":F.name}),placeholder:`请输入姓名`},null,8,[`modelValue`,`class`]),F.name?(M(),c(`p`,pe,A(F.name),1)):L(``,!0)]),p(`div`,me,[x(u(o),{for:`email`},{default:I(()=>[...f[17]||=[y(`邮箱`,-1)]]),_:1}),x(u(z),{id:`email`,modelValue:Y.email,"onUpdate:modelValue":f[1]||=e=>Y.email=e,type:`email`,disabled:``},null,8,[`modelValue`]),f[18]||=p(`p`,{class:`text-xs text-muted-foreground`},`邮箱不可修改`,-1)]),p(`div`,he,[x(u(o),{for:`phone`},{default:I(()=>[...f[19]||=[y(`电话`,-1)]]),_:1}),x(u(z),{id:`phone`,modelValue:Y.phone,"onUpdate:modelValue":f[2]||=e=>Y.phone=e,type:`tel`,class:b({"border-destructive":F.phone}),placeholder:`请输入手机号码`},null,8,[`modelValue`,`class`]),F.phone?(M(),c(`p`,ge,A(F.phone),1)):L(``,!0)]),p(`div`,_e,[x(u(o),{for:`department`},{default:I(()=>[x(u(S),{class:`h-3.5 w-3.5 inline mr-1`}),f[20]||=y(` 部门 `,-1)]),_:1}),x(u(z),{id:`department`,modelValue:Y.department,"onUpdate:modelValue":f[3]||=e=>Y.department=e,placeholder:`请输入部门`},null,8,[`modelValue`])]),p(`div`,ve,[x(u(o),{for:`position`},{default:I(()=>[x(u(w),{class:`h-3.5 w-3.5 inline mr-1`}),f[21]||=y(` 职位 `,-1)]),_:1}),x(u(z),{id:`position`,modelValue:Y.position,"onUpdate:modelValue":f[4]||=e=>Y.position=e,placeholder:`请输入职位`},null,8,[`modelValue`])]),p(`div`,ye,[x(u(o),{for:`address`},{default:I(()=>[x(u(oe),{class:`h-3.5 w-3.5 inline mr-1`}),f[22]||=y(` 地址 `,-1)]),_:1}),x(u(z),{id:`address`,modelValue:Y.address,"onUpdate:modelValue":f[5]||=e=>Y.address=e,placeholder:`请输入地址`},null,8,[`modelValue`])])]),p(`div`,be,[x(u(o),{for:`bio`},{default:I(()=>[x(u(E),{class:`h-3.5 w-3.5 inline mr-1`}),f[23]||=y(` 个人简介 `,-1)]),_:1}),v(p(`textarea`,{id:`bio`,"onUpdate:modelValue":f[6]||=e=>Y.bio=e,rows:`4`,class:`w-full px-3 py-2 rounded-md border border-input bg-background text-sm resize-none focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2`,placeholder:`请输入个人简介`},null,512),[[l,Y.bio]])]),p(`div`,xe,[x(u(D),{onClick:Ie,disabled:X.profile},{default:I(()=>[X.profile?(M(),_(u(k),{key:0,class:`h-4 w-4 mr-2 animate-spin`})):(M(),_(u(re),{key:1,class:`h-4 w-4 mr-2`})),y(` `+A(X.profile?`保存中...`:`保存更改`),1)]),_:1},8,[`disabled`])])]),_:1})]),_:1})]),p(`div`,Se,[x(u(B),{class:`bg-muted/40 border border-border/50 rounded-xl`},{default:I(()=>[x(u(U),null,{default:I(()=>[x(u(W),null,{default:I(()=>[...f[24]||=[y(`账户信息`,-1)]]),_:1})]),_:1}),x(u(V),{class:`space-y-4`},{default:I(()=>[p(`div`,Ce,[x(u(j),{class:`h-4 w-4 text-muted-foreground`}),p(`div`,null,[f[25]||=p(`p`,{class:`text-xs text-muted-foreground`},`邮箱`,-1),p(`p`,null,A(u(N).user?.email),1)])]),x(u(s)),p(`div`,we,[x(u(m),{class:`h-4 w-4 text-muted-foreground`}),p(`div`,null,[f[26]||=p(`p`,{class:`text-xs text-muted-foreground`},`角色`,-1),p(`p`,null,A(u(N).user?.role),1)])]),x(u(s)),p(`div`,Te,[x(u(P),{class:`h-4 w-4 text-muted-foreground`}),p(`div`,null,[f[27]||=p(`p`,{class:`text-xs text-muted-foreground`},`状态`,-1),p(`p`,null,A(u(N).user?.status===`active`?`正常`:`停用`),1)])]),x(u(s)),p(`div`,Ee,[x(u(C),{class:`h-4 w-4 text-muted-foreground`}),p(`div`,null,[f[28]||=p(`p`,{class:`text-xs text-muted-foreground`},`注册时间`,-1),p(`p`,null,A(Ue(u(N).user?.createdAt)),1)])])]),_:1})]),_:1}),x(u(B),{class:`bg-muted/40 border border-border/50 rounded-xl`},{default:I(()=>[x(u(U),null,{default:I(()=>[x(u(W),null,{default:I(()=>[...f[29]||=[y(`安全设置`,-1)]]),_:1})]),_:1}),x(u(V),{class:`space-y-3`},{default:I(()=>[x(u(D),{variant:`outline`,class:`w-full`,onClick:ze},{default:I(()=>[x(u(T),{class:`h-4 w-4 mr-2`}),f[30]||=y(` 修改密码 `,-1)]),_:1})]),_:1})]),_:1}),x(u(B),{class:`bg-muted/40 border border-border/50 rounded-xl border-destructive/50`},{default:I(()=>[x(u(U),null,{default:I(()=>[x(u(W),{class:`text-destructive`},{default:I(()=>[...f[31]||=[y(`危险区域`,-1)]]),_:1}),x(u(H),null,{default:I(()=>[...f[32]||=[y(`不可逆的操作`,-1)]]),_:1})]),_:1}),x(u(V),null,{default:I(()=>[x(u(D),{variant:`destructive`,class:`w-full`},{default:I(()=>[...f[33]||=[y(` 删除账户 `,-1)]]),_:1})]),_:1})]),_:1})])]),x(u(t),{open:Z.open,"onUpdate:open":f[11]||=e=>Z.open=e},{default:I(()=>[x(u(ee),{class:`sm:max-w-[425px]`},{default:I(()=>[x(u(e),null,{default:I(()=>[x(u(n),{class:`flex items-center gap-2`},{default:I(()=>[x(u(T),{class:`h-5 w-5`}),f[34]||=y(` 修改密码 `,-1)]),_:1}),x(u(i),null,{default:I(()=>[...f[35]||=[y(` 请输入当前密码和新密码来修改您的登录密码 `,-1)]]),_:1})]),_:1}),p(`div`,De,[p(`div`,Oe,[x(u(o),{for:`oldPassword`},{default:I(()=>[...f[36]||=[y(` 当前密码 `,-1),p(`span`,{class:`text-destructive`},`*`,-1)]]),_:1}),x(u(z),{id:`oldPassword`,modelValue:Z.oldPassword,"onUpdate:modelValue":f[7]||=e=>Z.oldPassword=e,type:`password`,class:b({"border-destructive":Q.oldPassword}),placeholder:`请输入当前密码`},null,8,[`modelValue`,`class`]),Q.oldPassword?(M(),c(`p`,ke,A(Q.oldPassword),1)):L(``,!0)]),p(`div`,Ae,[x(u(o),{for:`newPassword`},{default:I(()=>[...f[37]||=[y(` 新密码 `,-1),p(`span`,{class:`text-destructive`},`*`,-1)]]),_:1}),x(u(z),{id:`newPassword`,modelValue:Z.newPassword,"onUpdate:modelValue":f[8]||=e=>Z.newPassword=e,type:`password`,class:b({"border-destructive":Q.newPassword}),placeholder:`请输入新密码（至少6位）`},null,8,[`modelValue`,`class`]),Q.newPassword?(M(),c(`p`,je,A(Q.newPassword),1)):L(``,!0)]),p(`div`,Me,[x(u(o),{for:`confirmPassword`},{default:I(()=>[...f[38]||=[y(` 确认新密码 `,-1),p(`span`,{class:`text-destructive`},`*`,-1)]]),_:1}),x(u(z),{id:`confirmPassword`,modelValue:Z.confirmPassword,"onUpdate:modelValue":f[9]||=e=>Z.confirmPassword=e,type:`password`,class:b({"border-destructive":Q.confirmPassword}),placeholder:`请再次输入新密码`},null,8,[`modelValue`,`class`]),Q.confirmPassword?(M(),c(`p`,Ne,A(Q.confirmPassword),1)):L(``,!0)])]),x(u(K),null,{default:I(()=>[x(u(D),{variant:`outline`,onClick:f[10]||=e=>Z.open=!1},{default:I(()=>[...f[39]||=[y(` 取消 `,-1)]]),_:1}),x(u(D),{onClick:Ve,disabled:X.password},{default:I(()=>[X.password?(M(),_(u(k),{key:0,class:`h-4 w-4 mr-2 animate-spin`})):L(``,!0),y(` `+A(X.password?`修改中...`:`确认修改`),1)]),_:1},8,[`disabled`])]),_:1})]),_:1})]),_:1},8,[`open`])]))}});export{Y as default};
import"./ScrollArea-DFVXjTz0.js";import"./RovingFocusItem-CVjkq2qt.js";import"./Presence-3Lrzvetv.js";import"./defu-DUbmuhNq.js";import"./TabsTrigger-DqwypIQj.js";import{Ai as e,Ca as t,Fi as n,Gi as r,Hi as i,Ii as a,J as o,Ka as s,Li as c,Lt as l,Na as u,Oa as d,Ri as f,Ua as p,Ui as m,Va as h,_ as g,c as _,ca as v,fa as y,oa as b,qn as ee,zi as x}from"./index-D6Cod0pL.js";import"./en_US-LGbIKe0x.js";import"./common-HQCQB71w.js";import"./zh_CN-Cgumeokr.js";import"./useFullscreen-lrjpQVTw.js";import"./_plugin-vue_export-helper-Dey4FfNi.js";import{t as S}from"./badge-O2q4qI2Q.js";import"./dist-D3XftLPo.js";import"./theme-shared-BpTdpb0d.js";import{t as C}from"./TTable-B13ZnM5N.js";import"./useTableColumns-qs-cYpaB.js";import{t as w}from"./TForm-Drq7Qn9R.js";import"./TIcon-C-hNhMC1.js";import{n as T,t as E}from"./CardContent-CMuL0LxG.js";import{n as D}from"./composables-CTAVZAup.js";var O={class:`space-y-6`},k={class:`flex flex-wrap gap-3`},A={class:`flex items-baseline gap-2`},j={class:`text-lg font-semibold`},M={class:`text-xs text-muted-foreground`},N={class:`bg-muted/40 border border-border/50 rounded-xl px-3 py-3`},P={class:`flex flex-col lg:flex-row lg:items-center gap-4`},F={class:`flex-1`},I={key:0,class:`flex items-center gap-2 lg:border-l lg:pl-4`},L={class:`text-sm text-muted-foreground`},R={class:`font-medium`},z={class:`text-xs text-muted-foreground font-mono`},B={class:`flex flex-col items-center justify-center py-12 text-muted-foreground`},V={class:`w-16 h-16 rounded-full bg-muted flex items-center justify-center mb-4`},H=r({__name:`index`,setup(r){let{data:H,loading:te,searchQuery:U,filters:W,total:ne,statistics:G,fetchData:re}=D({apiCall:()=>ee.getStock(),statisticsFn:e=>{let t=new Set(e.map(e=>e.warehouseId)).size;return{totalWarehouses:t,activeWarehouses:t,totalProducts:e.reduce((e,t)=>e+t.quantity,0),lowStockItems:e.filter(e=>e.available<e.minStock).length}}}),K=n(()=>{let e=new Set(H.value.map(e=>e.warehouseId));return Array.from(e).map(e=>({id:e,name:H.value.find(t=>t.warehouseId===e)?.warehouseName||`仓库 ${e}`}))}),q=n(()=>{let e=G.value||{};return[{title:`仓库总数`,value:e.totalWarehouses||0,icon:_,color:`text-blue-500`},{title:`运营中`,value:e.activeWarehouses||0,icon:l,color:`text-green-500`},{title:`库存总量`,value:e.totalProducts||0,icon:o,color:`text-purple-500`},{title:`库存预警`,value:e.lowStockItems||0,icon:g,color:`text-red-500`}]}),J=u({keyword:``,warehouse:``}),Y={layout:`inline`,fields:[{name:`keyword`,type:`input`,label:``,placeholder:`搜索商品名称、SKU...`,className:`w-[240px]`},{name:`warehouse`,type:`select`,label:``,placeholder:`全部仓库`,options:[{label:`全部仓库`,value:``},...K.value.map(e=>({label:e.name,value:e.id}))],className:`w-[140px]`}],searchConfig:{enabled:!0,collapsed:!1,showCollapseButton:!1,searchText:`搜索`,resetText:`重置`,showReset:!0,onSearch:e=>{U.value=e.keyword||``,W.value={warehouseId:e.warehouse}},onReset:()=>{U.value=``,W.value={}}}},X=n(()=>({columns:[{title:`商品信息`,dataIndex:`productName`,width:200,slot:`product`},{title:`仓库`,dataIndex:`warehouseName`,width:120},{title:`总库存`,dataIndex:`quantity`,width:100,sorter:!0},{title:`预留`,dataIndex:`reserved`,width:100},{title:`可用`,dataIndex:`available`,width:100,slot:`available`},{title:`库存状态`,dataIndex:`available`,width:120,slot:`status`},{title:`更新时间`,dataIndex:`lastUpdated`,width:120}],pagination:{pageSize:10,show:!0,showSizeChanger:!0},rowSelection:{type:`checkbox`,show:!0},showTotalBadge:!0})),Z=n(()=>H.value.map(e=>({...e,key:e.id}))),Q=u([]);function $(e){Q.value=e}return(n,r)=>(b(),x(`div`,O,[r[4]||=a(`div`,{class:`flex flex-col sm:flex-row sm:items-center justify-between gap-4`},[a(`div`,null,[a(`h1`,{class:`text-3xl font-bold tracking-tight`},`库存管理`),a(`p`,{class:`text-muted-foreground mt-1.5 text-sm`},`管理仓库和库存分布`)])],-1),a(`div`,k,[(b(!0),x(e,null,v(h(q),e=>(b(),x(`div`,{key:e.title,class:`flex items-center gap-3 px-4 py-2.5 bg-muted/50 rounded-lg hover:bg-muted/70 transition-colors`},[(b(),c(y(e.icon),{class:p([`h-4 w-4`,e.color])},null,8,[`class`])),a(`div`,A,[a(`span`,j,s(e.value),1),a(`span`,M,s(e.title),1)])]))),128))]),a(`div`,N,[a(`div`,P,[a(`div`,F,[m(h(w),{modelValue:h(J),"onUpdate:modelValue":r[0]||=e=>d(J)?J.value=e:null,schema:Y},null,8,[`modelValue`])]),h(Q).length>0?(b(),x(`div`,I,[a(`span`,L,`已选 `+s(h(Q).length)+` 项`,1)])):f(``,!0)])]),m(h(T),{class:`bg-muted/40 border border-border/50 rounded-xl`},{default:t(()=>[m(h(E),{class:`pt-6`},{default:t(()=>[m(h(C),{ref:`tableRef`,data:h(Z),"onUpdate:data":r[1]||=e=>d(Z)?Z.value=e:null,schema:h(X),onSelectChange:$},{product:t(e=>[a(`div`,null,[a(`div`,R,s(e.text),1),a(`div`,z,s(e.record.sku),1)])]),available:t(e=>[a(`span`,{class:p([`font-medium`,e.record.available<=e.record.minStock?`text-red-500`:`text-green-500`])},s(e.text),3)]),status:t(e=>[m(h(S),{class:p({"bg-red-500/10 text-red-500 border-red-500/20":e.record.available<=e.record.minStock,"bg-yellow-500/10 text-yellow-500 border-yellow-500/20":e.record.available>e.record.minStock&&e.record.available<=e.record.minStock*1.5,"bg-green-500/10 text-green-500 border-green-500/20":e.record.available>e.record.minStock*1.5}),variant:`outline`},{default:t(()=>[i(s(e.record.available<=e.record.minStock?`库存不足`:e.record.available<=e.record.minStock*1.5?`库存偏低`:`库存充足`),1)]),_:2},1032,[`class`])]),emptyText:t(()=>[a(`div`,B,[a(`div`,V,[m(h(o),{class:`w-8 h-8 text-muted-foreground/50`})]),r[2]||=a(`p`,{class:`text-base font-medium mb-1`},`暂无库存数据`,-1),r[3]||=a(`p`,{class:`text-sm text-muted-foreground`},`请先添加仓库和商品`,-1)])]),_:1},8,[`data`,`schema`])]),_:1})]),_:1})]))}});export{H as default};
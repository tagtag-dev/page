import"./ScrollArea-DFVXjTz0.js";import"./RovingFocusItem-CVjkq2qt.js";import"./Presence-3Lrzvetv.js";import"./defu-DUbmuhNq.js";import"./TabsTrigger-DqwypIQj.js";import{Ai as e,Ca as t,Fi as n,Gi as r,Hi as i,Ii as a,Ka as o,Li as s,Lt as c,Mt as l,Na as u,Oa as d,Ua as f,Ui as p,V as m,Va as h,_ as g,ca as _,fa as v,ht as y,mr as b,n as x,oa as S,qn as C,zi as w}from"./index-D6Cod0pL.js";import"./en_US-LGbIKe0x.js";import"./common-HQCQB71w.js";import"./zh_CN-Cgumeokr.js";import"./useFullscreen-lrjpQVTw.js";import"./_plugin-vue_export-helper-Dey4FfNi.js";import{t as T}from"./badge-O2q4qI2Q.js";import"./dist-D3XftLPo.js";import"./theme-shared-BpTdpb0d.js";import{t as E}from"./TTable-B13ZnM5N.js";import"./useTableColumns-qs-cYpaB.js";import{t as D}from"./TForm-Drq7Qn9R.js";import"./TIcon-C-hNhMC1.js";import{t as O}from"./TModal-OyBXzO5K.js";import{n as k,t as A}from"./CardContent-CMuL0LxG.js";import{n as j}from"./composables-CTAVZAup.js";import"./constants-OTiF8S51.js";var M={class:`space-y-6`},N={class:`flex flex-col sm:flex-row sm:items-center justify-between gap-4`},P={class:`flex flex-wrap gap-3`},F={class:`flex items-baseline gap-2`},I={class:`text-lg font-semibold`},L={class:`text-xs text-muted-foreground`},R={class:`bg-muted/40 border border-border/50 rounded-xl px-3 py-3`},z={class:`flex flex-col lg:flex-row lg:items-center gap-4`},B={class:`flex-1`},V={class:`font-medium`},H={class:`text-xs text-muted-foreground font-mono`},U={class:`flex flex-col items-center justify-center py-12 text-muted-foreground`},W={class:`w-16 h-16 rounded-full bg-muted flex items-center justify-center mb-4`},G=r({__name:`Stock`,setup(r){let{data:G}=j({apiCall:()=>C.getStock()}),K=n(()=>{let e=new Set(G.value.map(e=>e.warehouseId));return Array.from(e).map(e=>({id:e,name:G.value.find(t=>t.warehouseId===e)?.warehouseName||`仓库 ${e}`}))}),q=u([{id:`1`,productName:`高级无线耳机`,sku:`SKU-001`,warehouseName:`北京仓库`,systemStock:45,actualStock:43,difference:-2,reason:`损坏报废`,operator:`张三`,checkTime:`2024-02-01 10:30`,status:`adjusted`},{id:`2`,productName:`智能手表 Pro`,sku:`SKU-002`,warehouseName:`北京仓库`,systemStock:23,actualStock:25,difference:2,reason:`入库未登记`,operator:`张三`,checkTime:`2024-02-01 11:00`,status:`adjusted`},{id:`3`,productName:`便携式充电宝`,sku:`SKU-003`,warehouseName:`上海仓库`,systemStock:156,actualStock:156,difference:0,reason:`-`,operator:`李四`,checkTime:`2024-02-02 09:00`,status:`confirmed`}]),J=n(()=>{let e=q.value.length,t=q.value.filter(e=>e.status===`pending`).length,n=q.value.filter(e=>e.status===`adjusted`).length,r=q.value.filter(e=>e.status===`confirmed`).length;return[{title:`盘点记录`,value:e,icon:l,color:`text-blue-500`},{title:`待确认`,value:t,icon:g,color:`text-yellow-500`},{title:`已调整`,value:n,icon:y,color:`text-purple-500`},{title:`已确认`,value:r,icon:c,color:`text-green-500`}]}),Y=u({keyword:``,warehouse:``}),X={layout:`inline`,fields:[{name:`keyword`,type:`input`,label:``,placeholder:`搜索商品名称、SKU...`,className:`w-[240px]`},{name:`warehouse`,type:`select`,label:``,placeholder:`全部仓库`,options:[{label:`全部仓库`,value:``},...K.value.map(e=>({label:e.name,value:e.id}))],className:`w-[140px]`}],searchConfig:{enabled:!0,collapsed:!1,showCollapseButton:!1,searchText:`搜索`,resetText:`重置`,showReset:!0}},Z=n(()=>({columns:[{title:`商品信息`,dataIndex:`productName`,width:200,slot:`product`},{title:`仓库`,dataIndex:`warehouseName`,width:120},{title:`系统库存`,dataIndex:`systemStock`,width:100},{title:`实际库存`,dataIndex:`actualStock`,width:100},{title:`差异`,dataIndex:`difference`,width:100,slot:`difference`},{title:`原因`,dataIndex:`reason`,width:150},{title:`盘点时间`,dataIndex:`checkTime`,width:150},{title:`状态`,dataIndex:`status`,width:100,slot:`status`}],pagination:{pageSize:10,show:!0,showSizeChanger:!0},rowSelection:{type:`checkbox`,show:!0},showTotalBadge:!0})),Q=u(!1),$=u({productId:``,warehouseId:``,actualStock:0,reason:``}),ee={layout:`horizontal`,labelCol:{span:6},wrapperCol:{span:18},fields:[{name:`productId`,type:`select`,label:`商品`,placeholder:`请选择商品`,options:G.value.map(e=>({label:e.productName,value:e.id})),rules:[{required:!0,message:`请选择商品`}]},{name:`warehouseId`,type:`select`,label:`仓库`,placeholder:`请选择仓库`,options:K.value.map(e=>({label:e.name,value:e.id})),rules:[{required:!0,message:`请选择仓库`}]},{name:`actualStock`,type:`number`,label:`实际库存`,placeholder:`请输入实际库存数量`,rules:[{required:!0,message:`请输入实际库存`}]},{name:`reason`,type:`textarea`,label:`差异原因`,placeholder:`请输入差异原因（可选）`}],actions:{showSubmit:!0,showReset:!0,submitText:`提交盘点`,resetText:`取消`,align:`right`,onReset:()=>{Q.value=!1}}};function te(e){Q.value=!1,$.value={productId:``,warehouseId:``,actualStock:0,reason:``}}let ne=u([]);function re(e){ne.value=e}return(n,r)=>(S(),w(`div`,M,[a(`div`,N,[r[7]||=a(`div`,null,[a(`h1`,{class:`text-3xl font-bold tracking-tight`},`库存盘点`),a(`p`,{class:`text-muted-foreground mt-1.5 text-sm`},`定期盘点库存，确保账实相符`)],-1),p(h(x),{class:`gap-2`,onClick:r[0]||=e=>Q.value=!0},{default:t(()=>[p(h(m),{class:`h-4 w-4`}),r[6]||=i(` 新增盘点 `,-1)]),_:1})]),p(h(O),{open:h(Q),"onUpdate:open":r[2]||=e=>d(Q)?Q.value=e:null,title:`新增盘点`,width:`560`,footer:null},{default:t(()=>[p(h(D),{modelValue:h($),"onUpdate:modelValue":r[1]||=e=>d($)?$.value=e:null,schema:ee,onSubmit:te},null,8,[`modelValue`])]),_:1},8,[`open`]),a(`div`,P,[(S(!0),w(e,null,_(h(J),e=>(S(),w(`div`,{key:e.title,class:`flex items-center gap-3 px-4 py-2.5 bg-muted/50 rounded-lg hover:bg-muted/70 transition-colors`},[(S(),s(v(e.icon),{class:f([`h-4 w-4`,e.color])},null,8,[`class`])),a(`div`,F,[a(`span`,I,o(e.value),1),a(`span`,L,o(e.title),1)])]))),128))]),a(`div`,R,[a(`div`,z,[a(`div`,B,[p(h(D),{modelValue:h(Y),"onUpdate:modelValue":r[3]||=e=>d(Y)?Y.value=e:null,schema:X},null,8,[`modelValue`])])])]),p(h(k),{class:`bg-muted/40 border border-border/50 rounded-xl`},{default:t(()=>[p(h(A),{class:`pt-6`},{default:t(()=>[p(h(E),{ref:`tableRef`,data:h(q),"onUpdate:data":r[5]||=e=>d(q)?q.value=e:null,schema:h(Z),onSelectChange:re},{product:t(e=>[a(`div`,null,[a(`div`,V,o(e.text),1),a(`div`,H,o(e.record.sku),1)])]),difference:t(e=>[a(`span`,{class:f([`font-medium`,e.text>0?`text-green-500`:e.text<0?`text-red-500`:`text-gray-500`])},o(e.text>0?`+`:``)+o(e.text),3)]),status:t(e=>[p(h(T),{class:f({"bg-yellow-500/10 text-yellow-500 border-yellow-500/20":e.text===h(b).PENDING,"bg-purple-500/10 text-purple-500 border-purple-500/20":e.text===h(b).ADJUSTED,"bg-green-500/10 text-green-500 border-green-500/20":e.text===h(b).CONFIRMED}),variant:`outline`},{default:t(()=>[i(o(e.text===h(b).PENDING?`待确认`:e.text===h(b).ADJUSTED?`已调整`:`已确认`),1)]),_:2},1032,[`class`])]),emptyText:t(()=>[a(`div`,U,[a(`div`,W,[p(h(l),{class:`w-8 h-8 text-muted-foreground/50`})]),r[9]||=a(`p`,{class:`text-base font-medium mb-1`},`暂无盘点记录`,-1),r[10]||=a(`p`,{class:`text-sm text-muted-foreground mb-4`},`开始创建您的第一条盘点记录吧`,-1),p(h(x),{size:`sm`,onClick:r[4]||=e=>Q.value=!0},{default:t(()=>[p(h(m),{class:`h-4 w-4 mr-1`}),r[8]||=i(` 新增盘点 `,-1)]),_:1})])]),_:1},8,[`data`,`schema`])]),_:1})]),_:1})]))}});export{G as default};
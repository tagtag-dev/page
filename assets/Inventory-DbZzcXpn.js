import"./ScrollArea-CW0-18Hy.js";import"./RovingFocusItem-DihGLheP.js";import"./button-Bo4o88Eb.js";import"./Presence-CX2vXdhf.js";import"./defu-BJL4Fjh2.js";import"./usePrimitiveElement-bvCn2QxH.js";import"./TabsTrigger-EHjOJe4X.js";import{An as e,Ct as t,Di as n,Ea as r,Gi as i,Ti as a,Ui as o,Yi as s,_i as c,bi as l,da as u,f as d,fi as f,ga as p,i as m,ka as h,oa as g,vi as _,wa as v,wi as y,xi as b,yi as ee,z as x}from"./index-D9LA8apy.js";import"./en_US-N9Q-_HQi.js";import"./common-rttX-sZZ.js";import"./zh_CN-RQJLYl9H.js";import"./useTabBar-WvhELTvw.js";import{t as S}from"./badge-DoBLqkFL.js";import{n as C,t as w}from"./CardContent-bGWyUVF7.js";import"./dist-guKItzxh.js";import{t as T}from"./TTable-BJXg8Gts.js";import{t as E}from"./TForm-De-AxzjP.js";import"./Input-DxyLxkUT.js";import"./TIcon-DpsAxes7.js";import{n as D}from"./composables-B_2v-ght.js";var O={class:`space-y-6`},k={class:`flex flex-wrap gap-3`},A={class:`flex items-baseline gap-2`},j={class:`text-lg font-semibold`},M={class:`text-xs text-muted-foreground`},N={class:`bg-muted/30 rounded-lg p-4`},P={class:`flex flex-col lg:flex-row lg:items-center gap-4`},F={class:`flex-1`},I={key:0,class:`flex items-center gap-2 lg:border-l lg:pl-4`},L={class:`text-sm text-muted-foreground`},R={class:`font-medium`},z={class:`text-xs text-muted-foreground font-mono`},B={class:`flex flex-col items-center justify-center py-12 text-muted-foreground`},V={class:`w-16 h-16 rounded-full bg-muted flex items-center justify-center mb-4`},H=n({__name:`Inventory`,setup(n){let{data:H,loading:te,searchQuery:U,filters:W,total:ne,statistics:G,fetchData:re}=D({apiCall:()=>e.getStock(),statisticsFn:e=>{let t=new Set(e.map(e=>e.warehouseId)).size;return{totalWarehouses:t,activeWarehouses:t,totalProducts:e.reduce((e,t)=>e+t.quantity,0),lowStockItems:e.filter(e=>e.available<e.minStock).length}}}),K=c(()=>{let e=new Set(H.value.map(e=>e.warehouseId));return Array.from(e).map(e=>({id:e,name:H.value.find(t=>t.warehouseId===e)?.warehouseName||`仓库 ${e}`}))}),q=c(()=>{let e=G.value||{};return[{title:`仓库总数`,value:e.totalWarehouses||0,icon:m,color:`text-blue-500`},{title:`运营中`,value:e.activeWarehouses||0,icon:t,color:`text-green-500`},{title:`库存总量`,value:e.totalProducts||0,icon:x,color:`text-purple-500`},{title:`库存预警`,value:e.lowStockItems||0,icon:d,color:`text-red-500`}]}),J=p({keyword:``,warehouse:``}),Y={layout:`inline`,fields:[{name:`keyword`,type:`input`,label:``,placeholder:`搜索商品名称、SKU...`,className:`w-[240px]`},{name:`warehouse`,type:`select`,label:``,placeholder:`全部仓库`,options:[{label:`全部仓库`,value:``},...K.value.map(e=>({label:e.name,value:e.id}))],className:`w-[140px]`}],searchConfig:{enabled:!0,collapsed:!1,showCollapseButton:!1,searchText:`搜索`,resetText:`重置`,showReset:!0,onSearch:e=>{U.value=e.keyword||``,W.value={warehouseId:e.warehouse}},onReset:()=>{U.value=``,W.value={}}}},X=c(()=>({columns:[{title:`商品信息`,dataIndex:`productName`,width:200,slot:`product`},{title:`仓库`,dataIndex:`warehouseName`,width:120},{title:`总库存`,dataIndex:`quantity`,width:100,sorter:!0},{title:`预留`,dataIndex:`reserved`,width:100},{title:`可用`,dataIndex:`available`,width:100,slot:`available`},{title:`库存状态`,dataIndex:`available`,width:120,slot:`status`},{title:`更新时间`,dataIndex:`lastUpdated`,width:120}],pagination:{pageSize:10,show:!0,showSizeChanger:!0},rowSelection:{type:`checkbox`,show:!0},showTotalBadge:!0})),Z=c(()=>H.value.map(e=>({...e,key:e.id}))),Q=p([]);function $(e){Q.value=e}return(e,t)=>(o(),b(`div`,O,[t[4]||=_(`div`,{class:`flex flex-col sm:flex-row sm:items-center justify-between gap-4`},[_(`div`,null,[_(`h1`,{class:`text-3xl font-bold tracking-tight`},`库存管理`),_(`p`,{class:`text-muted-foreground mt-1.5 text-sm`},`管理仓库和库存分布`)])],-1),_(`div`,k,[(o(!0),b(f,null,i(v(q),e=>(o(),b(`div`,{key:e.title,class:`flex items-center gap-3 px-4 py-2.5 bg-muted/50 rounded-lg hover:bg-muted/70 transition-colors`},[(o(),ee(s(e.icon),{class:r([`h-4 w-4`,e.color])},null,8,[`class`])),_(`div`,A,[_(`span`,j,h(e.value),1),_(`span`,M,h(e.title),1)])]))),128))]),_(`div`,N,[_(`div`,P,[_(`div`,F,[a(v(E),{modelValue:v(J),"onUpdate:modelValue":t[0]||=e=>u(J)?J.value=e:null,schema:Y},null,8,[`modelValue`])]),v(Q).length>0?(o(),b(`div`,I,[_(`span`,L,`已选 `+h(v(Q).length)+` 项`,1)])):l(``,!0)])]),a(v(C),{class:`border-0 shadow-sm`},{default:g(()=>[a(v(w),{class:`pt-6`},{default:g(()=>[a(v(T),{ref:`tableRef`,data:v(Z),"onUpdate:data":t[1]||=e=>u(Z)?Z.value=e:null,schema:v(X),onSelectChange:$},{product:g(e=>[_(`div`,null,[_(`div`,R,h(e.text),1),_(`div`,z,h(e.record.sku),1)])]),available:g(e=>[_(`span`,{class:r([`font-medium`,e.record.available<=e.record.minStock?`text-red-500`:`text-green-500`])},h(e.text),3)]),status:g(e=>[a(v(S),{class:r({"bg-red-500/10 text-red-500 border-red-500/20":e.record.available<=e.record.minStock,"bg-yellow-500/10 text-yellow-500 border-yellow-500/20":e.record.available>e.record.minStock&&e.record.available<=e.record.minStock*1.5,"bg-green-500/10 text-green-500 border-green-500/20":e.record.available>e.record.minStock*1.5}),variant:`outline`},{default:g(()=>[y(h(e.record.available<=e.record.minStock?`库存不足`:e.record.available<=e.record.minStock*1.5?`库存偏低`:`库存充足`),1)]),_:2},1032,[`class`])]),emptyText:g(()=>[_(`div`,B,[_(`div`,V,[a(v(x),{class:`w-8 h-8 text-muted-foreground/50`})]),t[2]||=_(`p`,{class:`text-base font-medium mb-1`},`暂无库存数据`,-1),t[3]||=_(`p`,{class:`text-sm text-muted-foreground`},`请先添加仓库和商品`,-1)])]),_:1},8,[`data`,`schema`])]),_:1})]),_:1})]))}});export{H as default};
import"./ScrollArea-u7vgQcwr.js";import"./RovingFocusItem-tfPyown7.js";import"./Presence-CTcpkTiJ.js";import"./TabsTrigger-BVA-KY5p.js";import{Bi as e,Dt as t,Ha as n,Ii as r,J as i,Ki as a,Li as o,Lt as s,M as ee,Pa as c,Pt as te,Ri as l,Ui as u,Wi as d,Xn as f,fr as p,ji as ne,jt as m,ka as h,la as re,mr as g,n as ie,pa as ae,qa as _,sa as v,wa as y,zi as b}from"./index-Bdnse1ke.js";import"./en_US-B-0xvqcl.js";import"./common-B6eu2cAW.js";import"./zh_CN-o6dt8jMH.js";import"./useFullscreen-Cz-fRWjR.js";import"./_plugin-vue_export-helper-CuErARa7.js";import{s as oe,w as x}from"./dist-CIVP1JAM.js";import"./theme-shared-CKGE9ZaP.js";import{t as se}from"./TTable-BqF1vWP0.js";import"./useTableColumns-ClPoF4Nv.js";import"./useResponsive-Drj8-vqi.js";import{t as S}from"./TForm-D3MGp7pF.js";import"./TIcon-BqmThimp.js";import{t as C}from"./TModal-C-7FBAha.js";import{n as ce,t as le}from"./CardContent-CE0o8nDP.js";import{n as ue,t as de}from"./CardTitle-BRqhnrl0.js";import{n as fe,r as w}from"./composables-cmucIgPx.js";import"./constants-OTiF8S51.js";import"./business-Ca3ePTT7.js";import{t as pe}from"./TDataCard-CaW7oY6O.js";import{t as me}from"./TStatusBadge-ByNmjsZv.js";import{t as T}from"./TPageHeader-B7msJezu.js";import{t as E}from"./TEmptyState-CimpC4Hh.js";import{t as D}from"./TBatchActions-CBzH8d8g.js";var O={class:`space-y-6`},he={class:`flex flex-wrap gap-3`},k={class:`bg-muted/40 border border-border/50 rounded-xl px-3 py-3`},A={class:`flex items-center justify-between`},j={class:`flex items-center gap-3`},M={class:`text-xs text-muted-foreground bg-muted px-2 py-0.5 rounded-full`},N={class:`flex items-center gap-4`},P={class:`flex items-center gap-2 text-sm text-muted-foreground`},F={class:`font-mono font-medium`},I={class:`font-medium`},L={class:`text-xs text-muted-foreground`},R={class:`font-medium text-primary`},ge={key:0,class:`space-y-6`},_e={class:`flex items-center justify-between p-4 bg-muted/50 rounded-lg`},ve={class:`font-mono font-medium`},ye={class:`space-y-3`},be={class:`grid grid-cols-2 gap-4 text-sm`},xe={class:`col-span-2`},Se={class:`space-y-3`},Ce={class:`grid grid-cols-2 gap-4 text-sm`},we={class:`font-medium text-primary`},Te={class:`col-span-2`},Ee={key:0,class:`space-y-3`},De={class:`text-sm text-muted-foreground p-3 bg-muted/50 rounded-lg`},Oe={class:`flex justify-end gap-2 pt-4 border-t`},z=a({__name:`Orders`,setup(a){let{data:z,loading:ke,searchQuery:B,filters:V,currentPage:Ae,pageSize:je,total:Me,statistics:H,fetchData:U,goToPage:Ne,setPageSize:Pe,addData:Fe,updateData:Ie,removeData:Le,batchRemoveData:Re}=fe({apiCall:async e=>await f.getOrders(e)||{list:[],total:0,page:1,pageSize:10},apiCallParams:e=>({page:e.page,pageSize:e.pageSize,search:e.searchQuery,status:e.filters.status}),statisticsFn:e=>({total:e.length,pending:e.filter(e=>e.status===p.PENDING).length,processing:e.filter(e=>e.status===p.PROCESSING).length,completed:e.filter(e=>e.status===p.COMPLETED).length,cancelled:e.filter(e=>e.status===p.CANCELLED).length,totalAmount:e.reduce((e,t)=>e+(t.total||0),0)})}),{mutate:ze}=w({mutationFn:e=>f.createOrder({customer:e.customer,email:e.email,phone:e.phone,address:e.address,total:Number(e.total),items:Number(e.items),status:e.status,note:e.note}),onSuccess:()=>{q.value=!1,X.value={customer:``,email:``,phone:``,address:``,total:0,items:1,status:p.PENDING,note:``},U()}}),{mutate:Be,loading:Ve}=w({mutationFn:e=>f.deleteOrder(e),onSuccess:()=>U()}),{mutate:He}=w({mutationFn:e=>f.batchDeleteOrders(e),onSuccess:()=>{G.value?.clearSelection(),U()}}),Ue=r(()=>{let e=H.value||{};return[{title:`总订单`,value:e.total||0,icon:ee,color:`text-blue-500`,bgColor:`bg-blue-50`},{title:`待处理`,value:e.pending||0,icon:m,color:`text-yellow-500`,bgColor:`bg-yellow-50`},{title:`处理中`,value:e.processing||0,icon:i,color:`text-purple-500`,bgColor:`bg-purple-50`},{title:`已完成`,value:e.completed||0,icon:s,color:`text-green-500`,bgColor:`bg-green-50`}]}),W=c({keyword:``,status:``}),We={layout:`inline`,fields:[{name:`keyword`,type:`input`,label:``,placeholder:`搜索订单号、客户...`,className:`w-[240px]`},{name:`status`,type:`select`,label:``,placeholder:`全部状态`,options:[{label:`全部状态`,value:``},{label:g.ORDER.PENDING.text,value:g.ORDER.PENDING.value},{label:g.ORDER.PROCESSING.text,value:g.ORDER.PROCESSING.value},{label:g.ORDER.COMPLETED.text,value:g.ORDER.COMPLETED.value},{label:g.ORDER.CANCELLED.text,value:g.ORDER.CANCELLED.value}],className:`w-[140px]`}],searchConfig:{enabled:!0,collapsed:!1,collapseThreshold:3,showCollapseButton:!1,searchText:`搜索`,resetText:`重置`,showReset:!0,onSearch:e=>{B.value=e.keyword||``,V.value={status:e.status}},onReset:()=>{B.value=``,V.value={}}}},G=c(),Ge=r(()=>({columns:[{title:`订单号`,dataIndex:`orderNo`,width:150,slot:`orderNo`},{title:`客户信息`,dataIndex:`customer`,width:180,slot:`customer`},{title:`商品数量`,dataIndex:`items`,width:100,align:`center`},{title:`订单金额`,dataIndex:`total`,width:120,slot:`total`,sorter:!0},{title:`状态`,dataIndex:`status`,width:120,slot:`status`,filters:[{text:g.ORDER.PENDING.text,value:g.ORDER.PENDING.value},{text:g.ORDER.PROCESSING.text,value:g.ORDER.PROCESSING.value},{text:g.ORDER.COMPLETED.text,value:g.ORDER.COMPLETED.value},{text:g.ORDER.CANCELLED.text,value:g.ORDER.CANCELLED.value}]},{title:`下单日期`,dataIndex:`date`,width:120,sorter:!0},{title:`收货地址`,dataIndex:`address`,width:200,ellipsis:!0}],pagination:{pageSize:10,show:!0,showSizeChanger:!0,showQuickJumper:!0},rowSelection:{type:`checkbox`,show:!0},actions:[{text:`查看`,type:`primary`,onClick:e=>Z(e)},{text:`删除`,type:`danger`,confirm:!0,confirmText:`确定要删除该订单吗？此操作不可恢复。`,onClick:e=>Je(e.id)}],actionWidth:150,actionFixed:`right`})),K=r(()=>z.value.map(e=>({...e,key:e.id}))),q=c(!1),J=c(!1),Y=c(null),X=c({customer:``,email:``,phone:``,address:``,total:0,items:1,status:p.PENDING,note:``}),Ke={layout:`horizontal`,labelCol:{span:6},wrapperCol:{span:18},fields:[{name:`customer`,type:`input`,label:`客户姓名`,placeholder:`请输入客户姓名`,rules:[{required:!0,message:`客户姓名不能为空`}]},{name:`email`,type:`input`,label:`邮箱`,placeholder:`请输入邮箱`,rules:[{required:!0,message:`邮箱不能为空`},{type:`email`,message:`邮箱格式不正确`}]},{name:`phone`,type:`input`,label:`电话`,placeholder:`请输入电话`,rules:[{required:!0,message:`电话不能为空`}]},{name:`address`,type:`input`,label:`收货地址`,placeholder:`请输入收货地址`,rules:[{required:!0,message:`收货地址不能为空`}]},{name:`total`,type:`number`,label:`订单金额`,placeholder:`请输入订单金额`,rules:[{required:!0,message:`订单金额不能为空`}]},{name:`items`,type:`number`,label:`商品数量`,placeholder:`请输入商品数量`,rules:[{required:!0,message:`商品数量不能为空`}]},{name:`status`,type:`select`,label:`订单状态`,placeholder:`请选择状态`,options:[{label:g.ORDER.PENDING.text,value:g.ORDER.PENDING.value},{label:g.ORDER.PROCESSING.text,value:g.ORDER.PROCESSING.value},{label:g.ORDER.COMPLETED.text,value:g.ORDER.COMPLETED.value},{label:g.ORDER.CANCELLED.text,value:g.ORDER.CANCELLED.value}],rules:[{required:!0,message:`请选择订单状态`}]},{name:`note`,type:`textarea`,label:`备注`,placeholder:`请输入备注（可选）`}],actions:{showSubmit:!0,showReset:!0,submitText:`创建订单`,resetText:`取消`,align:`right`,onReset:()=>{q.value=!1}}};function Z(e){Y.value=e,J.value=!0}function qe(e){ze(e)}function Je(e){Be(e)}let Q=c([]),$=c([]);function Ye(e,t){Q.value=e,$.value=t}function Xe(){Q.value=[],$.value=[],G.value?.clearSelection()}function Ze(){if(Q.value.length===0){alert(`请先选择要删除的订单`);return}confirm(`确定要删除选中的 ${Q.value.length} 个订单吗？`)&&He(Q.value.map(String))}function Qe(e){e.current!==void 0&&Ne(e.current),e.pageSize!==void 0&&Pe(e.pageSize)}return(r,a)=>(v(),e(`div`,O,[d(n(T),{title:`订单管理`,subtitle:`查看和管理所有订单`,actions:[{text:`创建订单`,type:`primary`,iconName:`Plus`,onClick:()=>q.value=!0}]},null,8,[`actions`]),d(n(C),{ref:`addModalRef`,open:n(q),"onUpdate:open":a[1]||=e=>h(q)?q.value=e:null,title:`创建新订单`,width:`560`,footer:null},{default:y(()=>[d(n(S),{ref:`formRef`,modelValue:n(X),"onUpdate:modelValue":a[0]||=e=>h(X)?X.value=e:null,schema:Ke,onSubmit:qe},null,8,[`modelValue`])]),_:1},8,[`open`]),o(`div`,he,[(v(!0),e(ne,null,re(n(Ue),e=>(v(),l(n(pe),{key:e.title,title:e.title,value:e.value,icon:e.icon,color:e.color,size:`sm`},null,8,[`title`,`value`,`icon`,`color`]))),128))]),o(`div`,k,[d(n(S),{modelValue:n(W),"onUpdate:modelValue":a[2]||=e=>h(W)?W.value=e:null,schema:We},null,8,[`modelValue`])]),d(n(ce),{class:`bg-muted/40 border border-border/50 rounded-xl`},{default:y(()=>[d(n(ue),null,{default:y(()=>[o(`div`,A,[o(`div`,j,[d(n(de),{class:`text-base font-semibold`},{default:y(()=>[...a[6]||=[u(`订单列表`,-1)]]),_:1}),o(`span`,M,` 共 `+_(n(K).length)+` 单 `,1)]),o(`div`,N,[d(n(D),{count:n(Q).length,"item-name":`订单`,"class-name":`border-0 bg-transparent shadow-none px-0 py-0`,actions:[{text:`批量删除`,type:`danger`,confirm:!0,confirmText:`确定要删除选中的订单吗？此操作不可恢复。`,onClick:Ze}],onClear:Xe},null,8,[`count`,`actions`]),o(`div`,P,[d(n(t),{class:`h-4 w-4`}),o(`span`,null,`总金额: ¥`+_((n(H).value?.totalAmount||0).toFixed(2)),1)])])])]),_:1}),d(n(le),{class:`pt-0`},{default:y(()=>[d(n(se),{ref_key:`tableRef`,ref:G,data:n(K),"onUpdate:data":a[3]||=e=>h(K)?K.value=e:null,schema:n(Ge),onSelectChange:Ye,onChange:Qe},{orderNo:y(e=>[o(`span`,F,_(e.text),1)]),customer:y(e=>[d(n(x),{direction:`vertical`,size:`small`},{default:y(()=>[o(`span`,I,_(e.record.customer),1),o(`span`,L,_(e.record.phone),1)]),_:2},1024)]),total:y(e=>[o(`span`,R,`¥`+_(Number(e.text).toFixed(2)),1)]),status:y(e=>[d(n(me),{status:e.text,"status-map":{[n(p).PENDING]:{text:`待处理`,color:`pending`},[n(p).PROCESSING]:{text:`处理中`,color:`processing`},[n(p).COMPLETED]:{text:`已完成`,color:`success`},[n(p).CANCELLED]:{text:`已取消`,color:`error`}}},null,8,[`status`,`status-map`])]),emptyText:y(()=>[d(n(E),{type:`data`,title:`暂无订单数据`,description:`开始创建您的第一个订单吧`,action:{text:`创建订单`,type:`primary`,iconName:`Plus`,onClick:()=>q.value=!0}},null,8,[`action`])]),_:1},8,[`data`,`schema`])]),_:1})]),_:1}),d(n(C),{ref:`viewModalRef`,open:n(J),"onUpdate:open":a[5]||=e=>h(J)?J.value=e:null,title:`订单详情`,width:`560`,footer:null},{default:y(()=>[n(Y)?(v(),e(`div`,ge,[o(`div`,_e,[o(`div`,null,[a[7]||=o(`p`,{class:`text-sm text-muted-foreground`},`订单号`,-1),o(`p`,ve,_(n(Y).orderNo),1)]),d(n(oe),{color:n(Y).status===n(p).PENDING?`warning`:n(Y).status===n(p).PROCESSING?`processing`:n(Y).status===n(p).COMPLETED?`success`:`error`},{default:y(()=>[d(n(x),null,{default:y(()=>[(v(),l(ae(n(Y).status===n(p).PENDING?n(m):n(Y).status===n(p).PROCESSING?n(i):n(Y).status===n(p).COMPLETED?n(s):n(te)),{class:`h-3 w-3`})),u(` `+_(n(g).ORDER[n(Y).status]?.text||n(Y).status),1)]),_:1})]),_:1},8,[`color`])]),o(`div`,ye,[a[11]||=o(`h4`,{class:`font-medium`},`客户信息`,-1),o(`div`,be,[o(`div`,null,[a[8]||=o(`p`,{class:`text-muted-foreground`},`姓名`,-1),o(`p`,null,_(n(Y).customer),1)]),o(`div`,null,[a[9]||=o(`p`,{class:`text-muted-foreground`},`电话`,-1),o(`p`,null,_(n(Y).phone),1)]),o(`div`,xe,[a[10]||=o(`p`,{class:`text-muted-foreground`},`邮箱`,-1),o(`p`,null,_(n(Y).email),1)])])]),o(`div`,Se,[a[16]||=o(`h4`,{class:`font-medium`},`订单信息`,-1),o(`div`,Ce,[o(`div`,null,[a[12]||=o(`p`,{class:`text-muted-foreground`},`商品数量`,-1),o(`p`,null,_(n(Y).items)+` 件`,1)]),o(`div`,null,[a[13]||=o(`p`,{class:`text-muted-foreground`},`订单金额`,-1),o(`p`,we,`¥`+_(n(Y).total.toFixed(2)),1)]),o(`div`,null,[a[14]||=o(`p`,{class:`text-muted-foreground`},`下单日期`,-1),o(`p`,null,_(n(Y).date),1)]),o(`div`,Te,[a[15]||=o(`p`,{class:`text-muted-foreground`},`收货地址`,-1),o(`p`,null,_(n(Y).address),1)])])]),n(Y).note?(v(),e(`div`,Ee,[a[17]||=o(`h4`,{class:`font-medium`},`备注`,-1),o(`p`,De,_(n(Y).note),1)])):b(``,!0),o(`div`,Oe,[d(n(ie),{variant:`outline`,onClick:a[4]||=e=>J.value=!1},{default:y(()=>[...a[18]||=[u(` 关闭 `,-1)]]),_:1})])])):b(``,!0)]),_:1},8,[`open`])]))}});export{z as default};
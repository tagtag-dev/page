import"./ScrollArea-DFVXjTz0.js";import"./RovingFocusItem-CVjkq2qt.js";import"./Presence-3Lrzvetv.js";import"./defu-DUbmuhNq.js";import"./TabsTrigger-DqwypIQj.js";import{Ai as e,Ca as t,Dt as ee,Fi as n,Gi as r,Hi as i,Ii as a,J as o,Ka as s,Li as c,Lt as l,M as te,Na as u,Oa as d,Pt as ne,Ri as f,Ui as p,Va as m,Yn as h,ca as re,dr as g,fa as ie,jt as _,n as ae,oa as v,pr as y,zi as b}from"./index-D6Cod0pL.js";import"./en_US-LGbIKe0x.js";import"./common-HQCQB71w.js";import"./zh_CN-Cgumeokr.js";import"./useFullscreen-lrjpQVTw.js";import"./_plugin-vue_export-helper-Dey4FfNi.js";import{s as oe,w as x}from"./dist-D3XftLPo.js";import"./theme-shared-BpTdpb0d.js";import{t as se}from"./TTable-B13ZnM5N.js";import"./useTableColumns-qs-cYpaB.js";import{t as S}from"./TForm-Drq7Qn9R.js";import"./TIcon-C-hNhMC1.js";import{t as C}from"./TModal-OyBXzO5K.js";import{n as ce,t as le}from"./CardContent-CMuL0LxG.js";import{n as ue,t as de}from"./CardTitle-D06OZslX.js";import{n as fe,r as w}from"./composables-CTAVZAup.js";import"./constants-OTiF8S51.js";import"./business-DYFIcNWr.js";import{t as pe}from"./TDataCard-C7I9agpQ.js";import{t as me}from"./TStatusBadge-DZzFEG5C.js";import{t as T}from"./TPageHeader-CTxQMWSB.js";import{t as E}from"./TEmptyState-B9XitPgC.js";import{t as D}from"./TBatchActions-CX-6FAVm.js";var O={class:`space-y-6`},he={class:`flex flex-wrap gap-3`},k={class:`bg-muted/40 border border-border/50 rounded-xl px-3 py-3`},A={class:`flex items-center justify-between`},j={class:`flex items-center gap-3`},M={class:`text-xs text-muted-foreground bg-muted px-2 py-0.5 rounded-full`},N={class:`flex items-center gap-4`},P={class:`flex items-center gap-2 text-sm text-muted-foreground`},F={class:`font-mono font-medium`},I={class:`font-medium`},L={class:`text-xs text-muted-foreground`},R={class:`font-medium text-primary`},ge={key:0,class:`space-y-6`},_e={class:`flex items-center justify-between p-4 bg-muted/50 rounded-lg`},ve={class:`font-mono font-medium`},ye={class:`space-y-3`},be={class:`grid grid-cols-2 gap-4 text-sm`},xe={class:`col-span-2`},Se={class:`space-y-3`},Ce={class:`grid grid-cols-2 gap-4 text-sm`},we={class:`font-medium text-primary`},Te={class:`col-span-2`},Ee={key:0,class:`space-y-3`},De={class:`text-sm text-muted-foreground p-3 bg-muted/50 rounded-lg`},Oe={class:`flex justify-end gap-2 pt-4 border-t`},z=r({__name:`Orders`,setup(r){let{data:z,loading:ke,searchQuery:B,filters:V,currentPage:Ae,pageSize:je,total:Me,statistics:H,fetchData:U,goToPage:Ne,setPageSize:Pe,addData:Fe,updateData:Ie,removeData:Le,batchRemoveData:Re}=fe({apiCall:async e=>await h.getOrders(e)||{list:[],total:0,page:1,pageSize:10},apiCallParams:e=>({page:e.page,pageSize:e.pageSize,search:e.searchQuery,status:e.filters.status}),statisticsFn:e=>({total:e.length,pending:e.filter(e=>e.status===g.PENDING).length,processing:e.filter(e=>e.status===g.PROCESSING).length,completed:e.filter(e=>e.status===g.COMPLETED).length,cancelled:e.filter(e=>e.status===g.CANCELLED).length,totalAmount:e.reduce((e,t)=>e+(t.total||0),0)})}),{mutate:ze}=w({mutationFn:e=>h.createOrder({customer:e.customer,email:e.email,phone:e.phone,address:e.address,total:Number(e.total),items:Number(e.items),status:e.status,note:e.note}),onSuccess:()=>{q.value=!1,X.value={customer:``,email:``,phone:``,address:``,total:0,items:1,status:g.PENDING,note:``},U()}}),{mutate:Be,loading:Ve}=w({mutationFn:e=>h.deleteOrder(e),onSuccess:()=>U()}),{mutate:He}=w({mutationFn:e=>h.batchDeleteOrders(e),onSuccess:()=>{G.value?.clearSelection(),U()}}),Ue=n(()=>{let e=H.value||{};return[{title:`总订单`,value:e.total||0,icon:te,color:`text-blue-500`,bgColor:`bg-blue-50`},{title:`待处理`,value:e.pending||0,icon:_,color:`text-yellow-500`,bgColor:`bg-yellow-50`},{title:`处理中`,value:e.processing||0,icon:o,color:`text-purple-500`,bgColor:`bg-purple-50`},{title:`已完成`,value:e.completed||0,icon:l,color:`text-green-500`,bgColor:`bg-green-50`}]}),W=u({keyword:``,status:``}),We={layout:`inline`,fields:[{name:`keyword`,type:`input`,label:``,placeholder:`搜索订单号、客户...`,className:`w-[240px]`},{name:`status`,type:`select`,label:``,placeholder:`全部状态`,options:[{label:`全部状态`,value:``},{label:y.ORDER.PENDING.text,value:y.ORDER.PENDING.value},{label:y.ORDER.PROCESSING.text,value:y.ORDER.PROCESSING.value},{label:y.ORDER.COMPLETED.text,value:y.ORDER.COMPLETED.value},{label:y.ORDER.CANCELLED.text,value:y.ORDER.CANCELLED.value}],className:`w-[140px]`}],searchConfig:{enabled:!0,collapsed:!1,collapseThreshold:3,showCollapseButton:!1,searchText:`搜索`,resetText:`重置`,showReset:!0,onSearch:e=>{B.value=e.keyword||``,V.value={status:e.status}},onReset:()=>{B.value=``,V.value={}}}},G=u(),Ge=n(()=>({columns:[{title:`订单号`,dataIndex:`orderNo`,width:150,slot:`orderNo`},{title:`客户信息`,dataIndex:`customer`,width:180,slot:`customer`},{title:`商品数量`,dataIndex:`items`,width:100,align:`center`},{title:`订单金额`,dataIndex:`total`,width:120,slot:`total`,sorter:!0},{title:`状态`,dataIndex:`status`,width:120,slot:`status`,filters:[{text:y.ORDER.PENDING.text,value:y.ORDER.PENDING.value},{text:y.ORDER.PROCESSING.text,value:y.ORDER.PROCESSING.value},{text:y.ORDER.COMPLETED.text,value:y.ORDER.COMPLETED.value},{text:y.ORDER.CANCELLED.text,value:y.ORDER.CANCELLED.value}]},{title:`下单日期`,dataIndex:`date`,width:120,sorter:!0},{title:`收货地址`,dataIndex:`address`,width:200,ellipsis:!0}],pagination:{pageSize:10,show:!0,showSizeChanger:!0,showQuickJumper:!0},rowSelection:{type:`checkbox`,show:!0},actions:[{text:`查看`,type:`primary`,onClick:e=>Z(e)},{text:`删除`,type:`danger`,confirm:!0,confirmText:`确定要删除该订单吗？此操作不可恢复。`,onClick:e=>Je(e.id)}],actionWidth:150,actionFixed:`right`})),K=n(()=>z.value.map(e=>({...e,key:e.id}))),q=u(!1),J=u(!1),Y=u(null),X=u({customer:``,email:``,phone:``,address:``,total:0,items:1,status:g.PENDING,note:``}),Ke={layout:`horizontal`,labelCol:{span:6},wrapperCol:{span:18},fields:[{name:`customer`,type:`input`,label:`客户姓名`,placeholder:`请输入客户姓名`,rules:[{required:!0,message:`客户姓名不能为空`}]},{name:`email`,type:`input`,label:`邮箱`,placeholder:`请输入邮箱`,rules:[{required:!0,message:`邮箱不能为空`},{type:`email`,message:`邮箱格式不正确`}]},{name:`phone`,type:`input`,label:`电话`,placeholder:`请输入电话`,rules:[{required:!0,message:`电话不能为空`}]},{name:`address`,type:`input`,label:`收货地址`,placeholder:`请输入收货地址`,rules:[{required:!0,message:`收货地址不能为空`}]},{name:`total`,type:`number`,label:`订单金额`,placeholder:`请输入订单金额`,rules:[{required:!0,message:`订单金额不能为空`}]},{name:`items`,type:`number`,label:`商品数量`,placeholder:`请输入商品数量`,rules:[{required:!0,message:`商品数量不能为空`}]},{name:`status`,type:`select`,label:`订单状态`,placeholder:`请选择状态`,options:[{label:y.ORDER.PENDING.text,value:y.ORDER.PENDING.value},{label:y.ORDER.PROCESSING.text,value:y.ORDER.PROCESSING.value},{label:y.ORDER.COMPLETED.text,value:y.ORDER.COMPLETED.value},{label:y.ORDER.CANCELLED.text,value:y.ORDER.CANCELLED.value}],rules:[{required:!0,message:`请选择订单状态`}]},{name:`note`,type:`textarea`,label:`备注`,placeholder:`请输入备注（可选）`}],actions:{showSubmit:!0,showReset:!0,submitText:`创建订单`,resetText:`取消`,align:`right`,onReset:()=>{q.value=!1}}};function Z(e){Y.value=e,J.value=!0}function qe(e){ze(e)}function Je(e){Be(e)}let Q=u([]),$=u([]);function Ye(e,t){Q.value=e,$.value=t}function Xe(){Q.value=[],$.value=[],G.value?.clearSelection()}function Ze(){if(Q.value.length===0){alert(`请先选择要删除的订单`);return}confirm(`确定要删除选中的 ${Q.value.length} 个订单吗？`)&&He(Q.value.map(String))}function Qe(e){e.current!==void 0&&Ne(e.current),e.pageSize!==void 0&&Pe(e.pageSize)}return(n,r)=>(v(),b(`div`,O,[p(m(T),{title:`订单管理`,subtitle:`查看和管理所有订单`,actions:[{text:`创建订单`,type:`primary`,iconName:`Plus`,onClick:()=>q.value=!0}]},null,8,[`actions`]),p(m(C),{ref:`addModalRef`,open:m(q),"onUpdate:open":r[1]||=e=>d(q)?q.value=e:null,title:`创建新订单`,width:`560`,footer:null},{default:t(()=>[p(m(S),{ref:`formRef`,modelValue:m(X),"onUpdate:modelValue":r[0]||=e=>d(X)?X.value=e:null,schema:Ke,onSubmit:qe},null,8,[`modelValue`])]),_:1},8,[`open`]),a(`div`,he,[(v(!0),b(e,null,re(m(Ue),e=>(v(),c(m(pe),{key:e.title,title:e.title,value:e.value,icon:e.icon,color:e.color,size:`sm`},null,8,[`title`,`value`,`icon`,`color`]))),128))]),a(`div`,k,[p(m(S),{modelValue:m(W),"onUpdate:modelValue":r[2]||=e=>d(W)?W.value=e:null,schema:We},null,8,[`modelValue`])]),p(m(ce),{class:`bg-muted/40 border border-border/50 rounded-xl`},{default:t(()=>[p(m(ue),null,{default:t(()=>[a(`div`,A,[a(`div`,j,[p(m(de),{class:`text-base font-semibold`},{default:t(()=>[...r[6]||=[i(`订单列表`,-1)]]),_:1}),a(`span`,M,` 共 `+s(m(K).length)+` 单 `,1)]),a(`div`,N,[p(m(D),{count:m(Q).length,"item-name":`订单`,"class-name":`border-0 bg-transparent shadow-none px-0 py-0`,actions:[{text:`批量删除`,type:`danger`,confirm:!0,confirmText:`确定要删除选中的订单吗？此操作不可恢复。`,onClick:Ze}],onClear:Xe},null,8,[`count`,`actions`]),a(`div`,P,[p(m(ee),{class:`h-4 w-4`}),a(`span`,null,`总金额: ¥`+s((m(H).value?.totalAmount||0).toFixed(2)),1)])])])]),_:1}),p(m(le),{class:`pt-0`},{default:t(()=>[p(m(se),{ref_key:`tableRef`,ref:G,data:m(K),"onUpdate:data":r[3]||=e=>d(K)?K.value=e:null,schema:m(Ge),onSelectChange:Ye,onChange:Qe},{orderNo:t(e=>[a(`span`,F,s(e.text),1)]),customer:t(e=>[p(m(x),{direction:`vertical`,size:`small`},{default:t(()=>[a(`span`,I,s(e.record.customer),1),a(`span`,L,s(e.record.phone),1)]),_:2},1024)]),total:t(e=>[a(`span`,R,`¥`+s(Number(e.text).toFixed(2)),1)]),status:t(e=>[p(m(me),{status:e.text,"status-map":{[m(g).PENDING]:{text:`待处理`,color:`pending`},[m(g).PROCESSING]:{text:`处理中`,color:`processing`},[m(g).COMPLETED]:{text:`已完成`,color:`success`},[m(g).CANCELLED]:{text:`已取消`,color:`error`}}},null,8,[`status`,`status-map`])]),emptyText:t(()=>[p(m(E),{type:`data`,title:`暂无订单数据`,description:`开始创建您的第一个订单吧`,action:{text:`创建订单`,type:`primary`,iconName:`Plus`,onClick:()=>q.value=!0}},null,8,[`action`])]),_:1},8,[`data`,`schema`])]),_:1})]),_:1}),p(m(C),{ref:`viewModalRef`,open:m(J),"onUpdate:open":r[5]||=e=>d(J)?J.value=e:null,title:`订单详情`,width:`560`,footer:null},{default:t(()=>[m(Y)?(v(),b(`div`,ge,[a(`div`,_e,[a(`div`,null,[r[7]||=a(`p`,{class:`text-sm text-muted-foreground`},`订单号`,-1),a(`p`,ve,s(m(Y).orderNo),1)]),p(m(oe),{color:m(Y).status===m(g).PENDING?`warning`:m(Y).status===m(g).PROCESSING?`processing`:m(Y).status===m(g).COMPLETED?`success`:`error`},{default:t(()=>[p(m(x),null,{default:t(()=>[(v(),c(ie(m(Y).status===m(g).PENDING?m(_):m(Y).status===m(g).PROCESSING?m(o):m(Y).status===m(g).COMPLETED?m(l):m(ne)),{class:`h-3 w-3`})),i(` `+s(m(y).ORDER[m(Y).status]?.text||m(Y).status),1)]),_:1})]),_:1},8,[`color`])]),a(`div`,ye,[r[11]||=a(`h4`,{class:`font-medium`},`客户信息`,-1),a(`div`,be,[a(`div`,null,[r[8]||=a(`p`,{class:`text-muted-foreground`},`姓名`,-1),a(`p`,null,s(m(Y).customer),1)]),a(`div`,null,[r[9]||=a(`p`,{class:`text-muted-foreground`},`电话`,-1),a(`p`,null,s(m(Y).phone),1)]),a(`div`,xe,[r[10]||=a(`p`,{class:`text-muted-foreground`},`邮箱`,-1),a(`p`,null,s(m(Y).email),1)])])]),a(`div`,Se,[r[16]||=a(`h4`,{class:`font-medium`},`订单信息`,-1),a(`div`,Ce,[a(`div`,null,[r[12]||=a(`p`,{class:`text-muted-foreground`},`商品数量`,-1),a(`p`,null,s(m(Y).items)+` 件`,1)]),a(`div`,null,[r[13]||=a(`p`,{class:`text-muted-foreground`},`订单金额`,-1),a(`p`,we,`¥`+s(m(Y).total.toFixed(2)),1)]),a(`div`,null,[r[14]||=a(`p`,{class:`text-muted-foreground`},`下单日期`,-1),a(`p`,null,s(m(Y).date),1)]),a(`div`,Te,[r[15]||=a(`p`,{class:`text-muted-foreground`},`收货地址`,-1),a(`p`,null,s(m(Y).address),1)])])]),m(Y).note?(v(),b(`div`,Ee,[r[17]||=a(`h4`,{class:`font-medium`},`备注`,-1),a(`p`,De,s(m(Y).note),1)])):f(``,!0),a(`div`,Oe,[p(m(ae),{variant:`outline`,onClick:r[4]||=e=>J.value=!1},{default:t(()=>[...r[18]||=[i(` 关闭 `,-1)]]),_:1})])])):f(``,!0)]),_:1},8,[`open`])]))}});export{z as default};
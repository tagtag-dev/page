import{t as e}from"./button-Bo4o88Eb.js";import{Ai as t,Bn as n,C as r,Di as i,Dn as a,Ea as o,Gi as s,Ki as c,Kt as l,N as u,Si as ee,T as te,Ti as d,Ui as f,_i as p,bi as m,ct as h,dt as g,ea as ne,fi as _,ft as re,ga as v,h as y,ht as b,ka as x,na as S,oa as C,st as w,ut as T,vi as E,w as ie,wa as D,wi as O,xi as k,ya as ae,yi as A,zn as j}from"./index-D9LA8apy.js";import{R as M,c as N,f as P,t as F}from"./dist-guKItzxh.js";var I={"oklch(0.205 0 0)":`#171717`,"oklch(0.985 0 0)":`#fafafa`,"oklch(0.97 0 0)":`#f5f5f5`,"oklch(0.145 0 0)":`#262626`,"oklch(1 0 0)":`#ffffff`,"oklch(0.556 0 0)":`#737373`,"oklch(0.922 0 0)":`#e5e5e5`,"oklch(0.708 0 0)":`#a3a3a3`,"oklch(0.577 0.245 27.325)":`#dc2626`,"oklch(0.269 0 0)":`#404040`,"oklch(0.546 0.245 262.881)":`#2563eb`,"oklch(0.527 0.154 150.069)":`#16a34a`,"oklch(0.558 0.288 302.321)":`#9333ea`,"oklch(0.646 0.222 41.116)":`#ea580c`,"oklch(0.606 0.285 349.5)":`#db2777`,"oklch(0.6 0.118 184.704)":`#0891b2`,"oklch(0.511 0.262 276.5)":`#4f46e5`,"oklch(0.769 0.188 70.08)":`#ca8a04`,"oklch(0.696 0.17 162.48)":`#059669`,"oklch(0.75 0.18 85)":`#d97706`,"oklch(1 0 0 / 10%)":`rgba(255, 255, 255, 0.1)`,"oklch(1 0 0 / 15%)":`rgba(255, 255, 255, 0.15)`,"oklch(0.704 0.191 22.216)":`#ef4444`};function L(e){if(I[e])return I[e];if(e.includes(`/`)){let t=e.split(` /`)[0].trim();if(I[t])return I[t]}return console.warn(`[TTable Theme] 无法转换颜色: ${e}，请添加到 colorMap`),e}function R(){let e=a();return p(()=>{let t=e.currentColors,n=e.layoutConfig.radius;return{algorithm:e.currentMode===`dark`?F.darkAlgorithm:F.defaultAlgorithm,token:{colorPrimary:L(t.primary),colorBgContainer:L(t.background),colorBgElevated:L(t.card),colorText:L(t.foreground),colorTextSecondary:L(t.mutedForeground),colorBorder:L(t.border),colorError:L(t.destructive),borderRadius:n*16,borderRadiusSM:n*12,borderRadiusLG:n*20,paddingSM:8,padding:12,paddingMD:16,paddingLG:20,paddingXL:24,fontSizeSM:12,fontSize:14,fontSizeLG:16,fontSizeXL:18},components:{Table:{colorBgContainer:L(t.background),colorText:L(t.foreground),colorTextHeading:L(t.foreground),colorBorder:L(t.border),colorSplit:L(t.border),colorBgTextHover:L(t.muted),colorFillAlter:L(t.muted),colorFillContent:L(t.card)},Pagination:{colorBgContainer:L(t.background),colorBgTextHover:L(t.muted),colorText:L(t.foreground),colorTextDisabled:L(t.mutedForeground),colorBorder:L(t.border),colorPrimary:L(t.primary),colorPrimaryHover:L(t.primary)},Select:{colorBorder:L(t.border),colorBgContainer:L(t.background),colorText:L(t.foreground),colorBgElevated:L(t.popover)},Button:{colorPrimary:L(t.primary),colorPrimaryHover:L(t.primary),colorText:L(t.foreground),colorTextDisabled:L(t.mutedForeground),colorBgContainer:L(t.background),colorBorder:L(t.border)},Checkbox:{colorPrimary:L(t.primary),colorText:L(t.foreground),colorBgContainer:L(t.background),colorBorder:L(t.border)},Radio:{colorPrimary:L(t.primary),colorText:L(t.foreground)},Popconfirm:{colorBgElevated:L(t.popover),colorText:L(t.foreground),colorTextHeading:L(t.foreground)},Tag:{colorText:L(t.foreground),colorBorder:L(t.border),colorBgContainer:L(t.muted)},Switch:{colorPrimary:L(t.primary)},Input:{colorBorder:L(t.input),colorBgContainer:L(t.background),colorText:L(t.foreground),colorTextPlaceholder:L(t.mutedForeground)},Dropdown:{colorBgElevated:L(t.popover),colorText:L(t.foreground)},Menu:{colorBgContainer:L(t.popover),colorText:L(t.foreground),colorItemBgHover:L(t.muted)},Empty:{colorText:L(t.mutedForeground),colorTextDisabled:L(t.mutedForeground)},Spin:{colorPrimary:L(t.primary)},Tooltip:{colorBgSpotlight:L(t.popover),colorTextLightSolid:L(t.foreground)}}}})}var z={class:`flex items-center gap-3`},B={key:2,class:`text-xs text-muted-foreground bg-muted px-2 py-0.5 rounded-full`},V={class:`flex flex-col items-center justify-center py-8 text-muted-foreground`},H=i({name:`TTable`,__name:`TTable`,props:{schema:{},data:{default:()=>[]},loading:{type:Boolean,default:!1}},emits:[`update:data`,`change`,`selectChange`,`expand`,`update:expandedRowKeys`],setup(i,{expose:a,emit:F}){let I=i,L=F,{t:H,locale:U}=n(),W=R(),G=v(null);async function K(){let e=U.value;G.value=await j(e)}S(U,K,{immediate:!0});let q=ne(),J=ae(null),Y=v({selectedRowKeys:[],selectedRows:[],expandedRowKeys:[],pagination:{current:1,pageSize:10,total:0}}),X=p({get:()=>I.data||[],set:e=>L(`update:data`,e)}),Z=p(()=>typeof I.schema.rowKey==`function`?I.schema.rowKey:I.schema.rowKey||`id`);function Q(e){if(typeof Z.value==`function`)return Z.value(e);if(typeof Z.value==`string`){let t=e[Z.value];if(t!==void 0)return t}return e.id===void 0?e.key===void 0?JSON.stringify(e):e.key:e.id}let oe=p(()=>I.schema.actions&&I.schema.actions.length>0),se=p(()=>{let e=I.schema.columns.map((e,t)=>{let n={key:e.key||e.dataIndex||t,dataIndex:e.dataIndex,title:e.title,width:e.width,minWidth:e.minWidth,align:e.align,fixed:e.fixed,ellipsis:e.ellipsis,className:e.className,...e.props};return e.sorter&&(n.sorter=e.sorter,e.defaultSortOrder&&(n.defaultSortOrder=e.defaultSortOrder),e.sortDirections&&(n.sortDirections=e.sortDirections),e.showSorterTooltip!==void 0&&(n.showSorterTooltip=e.showSorterTooltip)),e.filters&&(n.filters=e.filters,e.filterMode&&(n.filterMode=e.filterMode),e.filterMultiple!==void 0&&(n.filterMultiple=e.filterMultiple),e.defaultFilteredValue&&(n.defaultFilteredValue=e.defaultFilteredValue),e.onFilter&&(n.onFilter=e.onFilter)),e.customRender&&(n.customRender=e.customRender),e.customHeaderRender&&(n.customHeaderCell=n=>e.customHeaderRender?.({title:n.title,column:e,index:t})),n});return oe.value&&e.push({key:`action`,title:I.schema.actionTitle||H(`common.actions`),width:I.schema.actionWidth||150,fixed:I.schema.actionFixed||`right`,align:`center`,render:(e,t,n)=>$(t,n)}),e}),ce={编辑:u,修改:u,删除:y,查看:h,详情:g,详情页:w,设置:te,下载:re,分享:ie,复制:b,跳转:T,权限:r};function le(e){return e.icon?e.icon:ce[e.text]||null}function $(n,r){return(I.schema.actions||[]).filter(e=>typeof e.show==`function`?e.show(n,r):e.show!==!1).map((i,a)=>{let o=typeof i.disabled==`function`?i.disabled(n,r):i.disabled,s=le(i),c=l(`h-8 px-3 py-1.5 gap-1.5 text-sm font-medium`,i.variant===`destructive`&&`text-destructive hover:text-destructive hover:bg-destructive/10`,i.variant===`default`&&`text-primary hover:text-primary hover:bg-primary/10`,!i.variant&&i.type===`danger`&&`text-destructive hover:text-destructive hover:bg-destructive/10`,!i.variant&&i.type===`primary`&&`text-primary hover:text-primary hover:bg-primary/10`,!i.variant&&!i.type&&`text-foreground hover:text-accent-foreground hover:bg-accent`),u=t(e,{key:a,variant:i.variant||`ghost`,size:`sm`,disabled:o,class:c,onClick:e=>{e.stopPropagation(),i.confirm||i.onClick(n,r)}},()=>[s?t(s,{class:`size-4`}):null,i.text]);return i.confirm?t(P,{key:a,title:i.confirmText||`确认执行此操作？`,onConfirm:()=>i.onClick(n,r)},()=>u):u})}let ue=p(()=>{if(!I.schema.rowSelection||I.schema.rowSelection.show===!1)return;let e=I.schema.rowSelection;return{type:e.type||`checkbox`,selectedRowKeys:Y.value.selectedRowKeys,columnWidth:e.columnWidth,columnTitle:e.columnTitle,fixed:e.fixed,hideSelectAll:e.hideSelectAll,selections:e.selections,getCheckboxProps:e.getCheckboxProps,preserveSelectedRowKeys:e.preserveSelectedRowKeys,checkStrictly:e.checkStrictly,onChange:(e,t)=>{Y.value.selectedRowKeys=e,Y.value.selectedRows=t,L(`selectChange`,e,t)}}}),de=p(()=>{if(I.schema.pagination===!1)return!1;let e=I.schema.pagination||{};return{current:Y.value.pagination.current,pageSize:Y.value.pagination.pageSize,total:Y.value.pagination.total,pageSizeOptions:e.pageSizeOptions||[`10`,`20`,`50`,`100`],showQuickJumper:e.showQuickJumper??!0,showSizeChanger:e.showSizeChanger??!0,showTotal:e.showTotal===!1?void 0:e=>H(`common.total`,{total:e}),simple:e.simple,...e}}),fe=p(()=>{if(!I.schema.expandable)return;let e=I.schema.expandable;return{defaultExpandAllRows:e.defaultExpandAllRows,defaultExpandedRowKeys:e.defaultExpandedRowKeys,expandedRowKeys:Y.value.expandedRowKeys,rowExpandable:e.rowExpandable,expandIconColumnIndex:e.expandIconColumnIndex,expandIcon:e.expandIcon,expandedRowRender:e.expandedRowRender||(q.expandedRow,void 0),onExpand:(e,t)=>{let n=Q(t);e?Y.value.expandedRowKeys=[...Y.value.expandedRowKeys,n]:Y.value.expandedRowKeys=Y.value.expandedRowKeys.filter(e=>e!==n),L(`expand`,e,t),L(`update:expandedRowKeys`,Y.value.expandedRowKeys)}}});function pe(e,t,n){Y.value.pagination.current=e.current,Y.value.pagination.pageSize=e.pageSize,L(`change`,e,t,{field:n.field,order:n.order,column:I.schema.columns.find(e=>e.dataIndex===n.field)})}return a({getSelectedRows:()=>Y.value.selectedRows,getSelectedRowKeys:()=>Y.value.selectedRowKeys,setSelectedRows:e=>{Y.value.selectedRowKeys=e;let t=typeof Z.value==`string`?Z.value:`id`;Y.value.selectedRows=X.value.filter(n=>e.includes(n[t]))},clearSelection:()=>{Y.value.selectedRowKeys=[],Y.value.selectedRows=[]},getTableInstance:()=>J.value??void 0,refresh:()=>{L(`change`,{...Y.value.pagination},{},{field:``,order:void 0,column:void 0})},getPagination:()=>({...Y.value.pagination}),setPagination:e=>{e.current!==void 0&&(Y.value.pagination.current=e.current),e.pageSize!==void 0&&(Y.value.pagination.pageSize=e.pageSize),e.total!==void 0&&(Y.value.pagination.total=e.total)},expandRow:(e,t=!0)=>{let n=Q(e),r=Y.value.expandedRowKeys.indexOf(n);t&&r===-1?Y.value.expandedRowKeys.push(n):!t&&r>-1&&Y.value.expandedRowKeys.splice(r,1)},expandAllRows:()=>{Y.value.expandedRowKeys=X.value.map(e=>Q(e))},collapseAllRows:()=>{Y.value.expandedRowKeys=[]}}),S(()=>I.data,e=>{if(e){let t=typeof Z.value==`string`?Z.value:`id`;Y.value.selectedRows=e.filter(e=>Y.value.selectedRowKeys.includes(e[t]))}},{deep:!0}),S(()=>{let e=I.schema.pagination;return typeof e==`object`?e.total:void 0},e=>{e!==void 0&&(Y.value.pagination.total=e)},{immediate:!0}),S(()=>I.schema.rowSelection?.selectedRowKeys,e=>{if(e){Y.value.selectedRowKeys=e;let t=typeof Z.value==`string`?Z.value:`id`;Y.value.selectedRows=X.value.filter(n=>e.includes(n[t]))}},{immediate:!0}),S(()=>I.schema.expandable?.expandedRowKeys,e=>{e&&(Y.value.expandedRowKeys=e)},{immediate:!0}),(e,t)=>{let n=N;return G.value?(f(),A(D(M),{key:0,theme:D(W),locale:G.value},{default:C(()=>[d(n,{ref_key:`tableRef`,ref:J,"data-source":X.value,columns:se.value,"row-key":Z.value,loading:i.loading||i.schema.loading,size:i.schema.size||`middle`,bordered:i.schema.bordered,pagination:de.value,"row-selection":ue.value,scroll:i.schema.scroll,"show-header":i.schema.showHeader!==!1,"table-layout":i.schema.tableLayout,virtual:i.schema.virtual,sticky:i.schema.sticky,expandable:fe.value,"children-column-name":i.schema.childrenColumnName||`children`,"indent-size":i.schema.indentSize??15,class:o(D(l)(`t-table`,e.$attrs.class)),onChange:pe},ee({bodyCell:C(({column:t,text:n,record:r,index:a})=>[(f(!0),k(_,null,s(i.schema.columns,i=>(f(),k(_,{key:i.key||i.dataIndex},[(i.key||i.dataIndex)===t.key&&i.slot&&D(q)[i.slot]?c(e.$slots,i.slot,{key:0,text:n,record:r,index:a,column:i}):m(``,!0)],64))),128))]),headerCell:C(({column:t,text:n,index:r})=>[(f(!0),k(_,null,s(i.schema.columns,i=>(f(),k(_,{key:i.key||i.dataIndex},[(i.key||i.dataIndex)===t.key&&i.headerSlot&&D(q)[i.headerSlot]?c(e.$slots,i.headerSlot,{key:0,title:n,column:i,index:r}):m(``,!0)],64))),128))]),_:2},[i.schema.title||D(q).title||i.schema.showTotalBadge?{name:`title`,fn:C(()=>[c(e.$slots,`title`,{data:X.value},()=>[E(`div`,z,[typeof i.schema.title==`function`?(f(),k(_,{key:0},[O(x(i.schema.title(X.value)),1)],64)):(f(),k(_,{key:1},[O(x(i.schema.title),1)],64)),i.schema.showTotalBadge?(f(),k(`span`,B,x(D(H)(`common.total`,{total:X.value.length})),1)):m(``,!0)])])]),key:`0`}:void 0,i.schema.footer||D(q).footer?{name:`footer`,fn:C(()=>[c(e.$slots,`footer`,{data:X.value},()=>[typeof i.schema.footer==`function`?(f(),k(_,{key:0},[O(x(i.schema.footer(X.value)),1)],64)):(f(),k(_,{key:1},[O(x(i.schema.footer),1)],64))])]),key:`1`}:void 0,i.schema.summary?.slot||D(q).summary||i.schema.summary?.render?{name:`summary`,fn:C(()=>[c(e.$slots,`summary`,{data:X.value},()=>[i.schema.summary?.render?(f(),k(_,{key:0},[O(x(i.schema.summary.render(X.value)),1)],64)):m(``,!0)])]),key:`2`}:void 0,i.schema.emptySlot||D(q).emptyText?{name:`emptyText`,fn:C(()=>[c(e.$slots,`emptyText`,{},()=>[E(`div`,V,[t[0]||=E(`svg`,{class:`w-12 h-12 mb-4 text-muted-foreground/50`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},[E(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`1.5`,d:`M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z`})],-1),E(`p`,null,x(i.schema.emptyText||D(H)(`common.noData`)),1)])])]),key:`3`}:void 0,i.schema.expandable?.expandedRowSlot||D(q).expandedRow?{name:`expandedRowRender`,fn:C(({record:t,index:n,indent:r,expanded:i})=>[c(e.$slots,`expandedRow`,{record:t,index:n,indent:r,expanded:i})]),key:`4`}:void 0,D(q).expandIcon?{name:`expandIcon`,fn:C(({expanded:t,onExpand:n,record:r,expandable:i})=>[c(e.$slots,`expandIcon`,{expanded:t,onExpand:n,record:r,expandable:i})]),key:`5`}:void 0]),1032,[`data-source`,`columns`,`row-key`,`loading`,`size`,`bordered`,`pagination`,`row-selection`,`scroll`,`show-header`,`table-layout`,`virtual`,`sticky`,`expandable`,`children-column-name`,`indent-size`,`class`])]),_:3},8,[`theme`,`locale`])):m(``,!0)}}});export{H as t};
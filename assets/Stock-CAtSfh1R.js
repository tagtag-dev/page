import"./ScrollArea-BHIjOMNw.js";import"./RovingFocusItem-0I5l88nS.js";import"./Presence-jUNGdmIs.js";import"./TabsTrigger-CXLxDRQL.js";import{Bi as e,Ha as t,Ii as n,Jn as r,Ki as i,Li as a,Lt as o,Mt as s,Pa as c,Ri as l,Ui as u,V as d,Wa as f,Wi as p,_ as m,hr as h,ht as g,ji as _,ka as v,la as y,n as b,pa as x,qa as S,sa as C,wa as w}from"./index-DX59uxwP.js";import"./en_US-B-0xvqcl.js";import"./common-B6eu2cAW.js";import"./zh_CN-o6dt8jMH.js";import"./useFullscreen-DJ4C29sH.js";import"./_plugin-vue_export-helper-CuErARa7.js";import{t as T}from"./badge-BXmY1uTp.js";import"./dist-C2ERyVuF.js";import"./theme-shared-Cg7vXLFh.js";import{t as E}from"./TTable-CkpzGCtr.js";import"./useTableColumns-D4Iah3In.js";import"./useResponsive-BcMiRh3c.js";import{t as D}from"./TForm-9yrohHqo.js";import"./TIcon-Bi65ixMm.js";import{t as O}from"./TModal-CdyAUA57.js";import{n as k,t as A}from"./CardContent-DuACdMkv.js";import{n as j}from"./composables-lxmcz-q_.js";import"./constants-OTiF8S51.js";var M={class:`space-y-6`},N={class:`flex flex-col sm:flex-row sm:items-center justify-between gap-4`},P={class:`flex flex-wrap gap-3`},F={class:`flex items-baseline gap-2`},I={class:`text-lg font-semibold`},L={class:`text-xs text-muted-foreground`},R={class:`bg-muted/40 border border-border/50 rounded-xl px-3 py-3`},z={class:`flex flex-col lg:flex-row lg:items-center gap-4`},B={class:`flex-1`},ee={class:`font-medium`},V={class:`text-xs text-muted-foreground font-mono`},H={class:`flex flex-col items-center justify-center py-12 text-muted-foreground`},U={class:`w-16 h-16 rounded-full bg-muted flex items-center justify-center mb-4`},W=i({__name:`Stock`,setup(i){let{data:W}=j({apiCall:()=>r.getStock()}),G=n(()=>{let e=new Set(W.value.map(e=>e.warehouseId));return Array.from(e).map(e=>({id:e,name:W.value.find(t=>t.warehouseId===e)?.warehouseName||`仓库 ${e}`}))}),K=c([{id:`1`,productName:`高级无线耳机`,sku:`SKU-001`,warehouseName:`北京仓库`,systemStock:45,actualStock:43,difference:-2,reason:`损坏报废`,operator:`张三`,checkTime:`2024-02-01 10:30`,status:`adjusted`},{id:`2`,productName:`智能手表 Pro`,sku:`SKU-002`,warehouseName:`北京仓库`,systemStock:23,actualStock:25,difference:2,reason:`入库未登记`,operator:`张三`,checkTime:`2024-02-01 11:00`,status:`adjusted`},{id:`3`,productName:`便携式充电宝`,sku:`SKU-003`,warehouseName:`上海仓库`,systemStock:156,actualStock:156,difference:0,reason:`-`,operator:`李四`,checkTime:`2024-02-02 09:00`,status:`confirmed`}]),q=n(()=>{let e=K.value.length,t=K.value.filter(e=>e.status===`pending`).length,n=K.value.filter(e=>e.status===`adjusted`).length,r=K.value.filter(e=>e.status===`confirmed`).length;return[{title:`盘点记录`,value:e,icon:s,color:`text-blue-500`},{title:`待确认`,value:t,icon:m,color:`text-yellow-500`},{title:`已调整`,value:n,icon:g,color:`text-purple-500`},{title:`已确认`,value:r,icon:o,color:`text-green-500`}]}),J=c({keyword:``,warehouse:``}),Y={layout:`inline`,fields:[{name:`keyword`,type:`input`,label:``,placeholder:`搜索商品名称、SKU...`,className:`w-[240px]`},{name:`warehouse`,type:`select`,label:``,placeholder:`全部仓库`,options:[{label:`全部仓库`,value:``},...G.value.map(e=>({label:e.name,value:e.id}))],className:`w-[140px]`}],searchConfig:{enabled:!0,collapsed:!1,showCollapseButton:!1,searchText:`搜索`,resetText:`重置`,showReset:!0}},X=n(()=>({columns:[{title:`商品信息`,dataIndex:`productName`,width:200,slot:`product`},{title:`仓库`,dataIndex:`warehouseName`,width:120},{title:`系统库存`,dataIndex:`systemStock`,width:100},{title:`实际库存`,dataIndex:`actualStock`,width:100},{title:`差异`,dataIndex:`difference`,width:100,slot:`difference`},{title:`原因`,dataIndex:`reason`,width:150},{title:`盘点时间`,dataIndex:`checkTime`,width:150},{title:`状态`,dataIndex:`status`,width:100,slot:`status`}],pagination:{pageSize:10,show:!0,showSizeChanger:!0},rowSelection:{type:`checkbox`,show:!0},showTotalBadge:!0})),Z=c(!1),Q=c({productId:``,warehouseId:``,actualStock:0,reason:``}),$={layout:`horizontal`,labelCol:{span:6},wrapperCol:{span:18},fields:[{name:`productId`,type:`select`,label:`商品`,placeholder:`请选择商品`,options:W.value.map(e=>({label:e.productName,value:e.id})),rules:[{required:!0,message:`请选择商品`}]},{name:`warehouseId`,type:`select`,label:`仓库`,placeholder:`请选择仓库`,options:G.value.map(e=>({label:e.name,value:e.id})),rules:[{required:!0,message:`请选择仓库`}]},{name:`actualStock`,type:`number`,label:`实际库存`,placeholder:`请输入实际库存数量`,rules:[{required:!0,message:`请输入实际库存`}]},{name:`reason`,type:`textarea`,label:`差异原因`,placeholder:`请输入差异原因（可选）`}],actions:{showSubmit:!0,showReset:!0,submitText:`提交盘点`,resetText:`取消`,align:`right`,onReset:()=>{Z.value=!1}}};function te(e){Z.value=!1,Q.value={productId:``,warehouseId:``,actualStock:0,reason:``}}let ne=c([]);function re(e){ne.value=e}return(n,r)=>(C(),e(`div`,M,[a(`div`,N,[r[7]||=a(`div`,null,[a(`h1`,{class:`text-3xl font-bold tracking-tight`},`库存盘点`),a(`p`,{class:`text-muted-foreground mt-1.5 text-sm`},`定期盘点库存，确保账实相符`)],-1),p(t(b),{class:`gap-2`,onClick:r[0]||=e=>Z.value=!0},{default:w(()=>[p(t(d),{class:`h-4 w-4`}),r[6]||=u(` 新增盘点 `,-1)]),_:1})]),p(t(O),{open:t(Z),"onUpdate:open":r[2]||=e=>v(Z)?Z.value=e:null,title:`新增盘点`,width:`560`,footer:null},{default:w(()=>[p(t(D),{modelValue:t(Q),"onUpdate:modelValue":r[1]||=e=>v(Q)?Q.value=e:null,schema:$,onSubmit:te},null,8,[`modelValue`])]),_:1},8,[`open`]),a(`div`,P,[(C(!0),e(_,null,y(t(q),t=>(C(),e(`div`,{key:t.title,class:`flex items-center gap-3 px-4 py-2.5 bg-muted/50 rounded-lg hover:bg-muted/70 transition-colors`},[(C(),l(x(t.icon),{class:f([`h-4 w-4`,t.color])},null,8,[`class`])),a(`div`,F,[a(`span`,I,S(t.value),1),a(`span`,L,S(t.title),1)])]))),128))]),a(`div`,R,[a(`div`,z,[a(`div`,B,[p(t(D),{modelValue:t(J),"onUpdate:modelValue":r[3]||=e=>v(J)?J.value=e:null,schema:Y},null,8,[`modelValue`])])])]),p(t(k),{class:`bg-muted/40 border border-border/50 rounded-xl`},{default:w(()=>[p(t(A),{class:`pt-6`},{default:w(()=>[p(t(E),{ref:`tableRef`,data:t(K),"onUpdate:data":r[5]||=e=>v(K)?K.value=e:null,schema:t(X),onSelectChange:re},{product:w(e=>[a(`div`,null,[a(`div`,ee,S(e.text),1),a(`div`,V,S(e.record.sku),1)])]),difference:w(e=>[a(`span`,{class:f([`font-medium`,e.text>0?`text-green-500`:e.text<0?`text-red-500`:`text-gray-500`])},S(e.text>0?`+`:``)+S(e.text),3)]),status:w(e=>[p(t(T),{class:f({"bg-yellow-500/10 text-yellow-500 border-yellow-500/20":e.text===t(h).PENDING,"bg-purple-500/10 text-purple-500 border-purple-500/20":e.text===t(h).ADJUSTED,"bg-green-500/10 text-green-500 border-green-500/20":e.text===t(h).CONFIRMED}),variant:`outline`},{default:w(()=>[u(S(e.text===t(h).PENDING?`待确认`:e.text===t(h).ADJUSTED?`已调整`:`已确认`),1)]),_:2},1032,[`class`])]),emptyText:w(()=>[a(`div`,H,[a(`div`,U,[p(t(s),{class:`w-8 h-8 text-muted-foreground/50`})]),r[9]||=a(`p`,{class:`text-base font-medium mb-1`},`暂无盘点记录`,-1),r[10]||=a(`p`,{class:`text-sm text-muted-foreground mb-4`},`开始创建您的第一条盘点记录吧`,-1),p(t(b),{size:`sm`,onClick:r[4]||=e=>Z.value=!0},{default:w(()=>[p(t(d),{class:`h-4 w-4 mr-1`}),r[8]||=u(` 新增盘点 `,-1)]),_:1})])]),_:1},8,[`data`,`schema`])]),_:1})]),_:1})]))}});export{W as default};
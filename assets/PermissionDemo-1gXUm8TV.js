import"./RovingFocusItem-DihGLheP.js";import{n as e,t}from"./button-Bo4o88Eb.js";import"./Presence-CX2vXdhf.js";import"./usePrimitiveElement-bvCn2QxH.js";import{t as n}from"./Separator-4cRHDbnN.js";import{n as ee,r as te,t as r}from"./TabsTrigger-EHjOJe4X.js";import{t as i}from"./TabsContent-ei7kIOeP.js";import{C as a,Ct as o,Di as s,Ea as c,Gi as l,Ji as u,Ki as d,Kt as f,On as ne,S as re,Ti as p,Ui as m,_i as h,bt as ie,fi as g,ka as _,o as v,oa as y,sa as b,tt as x,vi as S,wa as C,wi as w,xi as T,yi as E,z as ae}from"./index-D9LA8apy.js";import"./useTabBar-WvhELTvw.js";import{t as D}from"./badge-DoBLqkFL.js";import{n as O,t as k}from"./CardContent-bGWyUVF7.js";import{t as A}from"./CardDescription-B2qzcu3_.js";import{n as j,t as M}from"./CardTitle-9YsRePqj.js";import{t as oe}from"./composables-B_2v-ght.js";import{n as N,r as P,t as F}from"./constants-BrhrixW3.js";var I=s({__name:`Alert`,props:{class:{},variant:{}},setup(e){let t=e;return(n,ee)=>(m(),T(`div`,{"data-slot":`alert`,class:c(C(f)(C(z)({variant:e.variant}),t.class)),role:`alert`},[d(n.$slots,`default`)],2))}}),L=s({__name:`AlertDescription`,props:{class:{}},setup(e){let t=e;return(e,n)=>(m(),T(`div`,{"data-slot":`alert-description`,class:c(C(f)(`text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed`,t.class))},[d(e.$slots,`default`)],2))}}),R=s({__name:`AlertTitle`,props:{class:{}},setup(e){let t=e;return(e,n)=>(m(),T(`div`,{"data-slot":`alert-title`,class:c(C(f)(`col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight`,t.class))},[d(e.$slots,`default`)],2))}});const z=e(`relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current`,{variants:{variant:{default:`bg-card text-card-foreground`,destructive:`text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90`}},defaultVariants:{variant:`default`}});var B={class:`container mx-auto p-6 space-y-6`},V={class:`mt-2 space-y-1 text-sm`},H={class:`flex flex-wrap gap-2`},U={class:`space-y-2`},W={class:`flex flex-wrap gap-2`},G={class:`space-y-2`},K={class:`flex flex-wrap gap-2`},q={class:`space-y-2`},se={class:`flex flex-wrap gap-2`},ce={class:`space-y-2`},le={class:`flex flex-wrap gap-2`},ue={class:`space-y-2`},de={class:`grid gap-2`},fe={class:`text-sm`},pe={class:`space-y-2`},me={class:`grid gap-2`},he={class:`text-sm font-medium`},ge={class:`text-xs text-muted-foreground`},_e={class:`space-y-2`},ve={class:`flex flex-wrap gap-2`},ye={class:`space-y-2`},be={class:`flex flex-wrap gap-2`},xe={class:`space-y-2`},Se={class:`flex flex-wrap gap-2`},Ce={class:`space-y-2`},we={class:`p-4 bg-muted rounded-lg`},Te={class:`text-sm`},J={class:`text-sm`},Y=s({__name:`PermissionDemo`,setup(e){let{hasPermission:s,hasAnyPermission:c,hasAllPermissions:d,hasRole:f,isAdmin:z,isAuthenticated:Y}=oe(),X=ne(),Z=h(()=>X.user),Ee=h(()=>X.user?.permissions||[]),De=[{name:`用户创建权限 (user:create)`,code:P.CREATE},{name:`用户更新权限 (user:update)`,code:P.UPDATE},{name:`用户删除权限 (user:delete)`,code:P.DELETE},{name:`产品创建权限 (product:create)`,code:N.CREATE},{name:`订单审核权限 (order:audit)`,code:F.AUDIT}].map(e=>({name:e.name,code:e.code,hasPermission:h(()=>X.user?.permissions.includes(`*`)||X.user?.permissions.includes(e.code)||!1)})),Q=h(()=>X.user?.permissions.includes(`*`)||X.user?.permissions.includes(P.CREATE)||!1),$=h(()=>X.user?.permissions.includes(`*`)||X.user?.permissions.includes(P.UPDATE)||!1),Oe=h(()=>X.user?.permissions.includes(`*`)||X.user?.permissions.includes(P.DELETE)||!1),ke=[{name:`拥有任意用户权限（创建/更新/删除）`,result:h(()=>Q.value||$.value||Oe.value),description:`hasAnyPermission([user:create, user:update, user:delete])`},{name:`同时拥有用户创建和更新权限`,result:h(()=>Q.value&&$.value),description:`hasAllPermissions([user:create, user:update])`},{name:`是管理员角色`,result:h(()=>X.user?.role===`admin`),description:`hasRole('admin')`},{name:`是管理员（计算属性）`,result:z,description:`isAdmin.value`}],Ae=[{label:`管理员（全部权限）`,role:`admin`,permissions:[`*`]},{label:`编辑者（读写权限）`,role:`editor`,permissions:[`user:read`,`user:update`,`product:read`,`product:update`,`order:read`,`order:update`]},{label:`访客（只读权限）`,role:`viewer`,permissions:[`user:read`,`product:read`,`order:read`]},{label:`无权限`,role:`guest`,permissions:[]}],je=e=>{X.user&&(X.user.role=e.role,X.user.permissions=e.permissions)};return(e,s)=>{let c=u(`permission`),d=u(`role`);return m(),T(`div`,B,[s[49]||=S(`div`,{class:`space-y-2`},[S(`h1`,{class:`text-3xl font-bold tracking-tight`},`权限控制演示 (RBAC Demo)`),S(`p`,{class:`text-muted-foreground`},` 本页面展示如何使用 v-permission 指令和 usePermission 组合式函数进行权限控制 `)],-1),p(C(I),null,{default:y(()=>[p(C(x),{class:`h-4 w-4`}),p(C(R),null,{default:y(()=>[...s[0]||=[w(`当前用户信息`,-1)]]),_:1}),p(C(L),null,{default:y(()=>[S(`div`,V,[S(`p`,null,[s[1]||=S(`strong`,null,`角色:`,-1),w(` `+_(C(Z)?.role||`未登录`),1)]),S(`p`,null,[s[2]||=S(`strong`,null,`权限列表:`,-1),w(` `+_(C(Ee).join(`, `)||`无`),1)]),S(`p`,null,[s[3]||=S(`strong`,null,`是否认证:`,-1),w(` `+_(C(Y)?`是`:`否`),1)])])]),_:1})]),_:1}),p(C(O),null,{default:y(()=>[p(C(j),null,{default:y(()=>[p(C(M),{class:`flex items-center gap-2`},{default:y(()=>[p(C(a),{class:`h-5 w-5`}),s[4]||=w(` 模拟权限切换（演示用） `,-1)]),_:1}),p(C(A),null,{default:y(()=>[...s[5]||=[w(`点击切换不同角色的权限，观察下方按钮和组件的变化`,-1)]]),_:1})]),_:1}),p(C(k),null,{default:y(()=>[S(`div`,H,[(m(),T(g,null,l(Ae,e=>p(C(t),{key:e.label,variant:`outline`,size:`sm`,onClick:t=>je(e)},{default:y(()=>[w(_(e.label),1)]),_:2},1032,[`onClick`])),64))])]),_:1})]),_:1}),p(C(te),{defaultValue:`directive`,class:`w-full`},{default:y(()=>[p(C(ee),{class:`grid w-full grid-cols-3`},{default:y(()=>[p(C(r),{value:`directive`},{default:y(()=>[...s[6]||=[w(`指令方式 (v-permission)`,-1)]]),_:1}),p(C(r),{value:`composable`},{default:y(()=>[...s[7]||=[w(`组合式函数 (usePermission)`,-1)]]),_:1}),p(C(r),{value:`role`},{default:y(()=>[...s[8]||=[w(`角色控制 (v-role)`,-1)]]),_:1})]),_:1}),p(C(i),{value:`directive`,class:`space-y-4`},{default:y(()=>[p(C(O),null,{default:y(()=>[p(C(j),null,{default:y(()=>[p(C(M),null,{default:y(()=>[...s[9]||=[w(`v-permission 指令示例`,-1)]]),_:1}),p(C(A),null,{default:y(()=>[...s[10]||=[w(`使用 v-permission 指令控制按钮和元素的显示/隐藏`,-1)]]),_:1})]),_:1}),p(C(k),{class:`space-y-6`},{default:y(()=>[S(`div`,U,[s[14]||=S(`h4`,{class:`text-sm font-semibold`},`1. 单个权限检查`,-1),S(`div`,W,[b((m(),E(C(t),null,{default:y(()=>[p(C(v),{class:`h-4 w-4 mr-2`}),s[11]||=w(` 创建用户 `,-1)]),_:1})),[[c,C(P).CREATE]]),b((m(),E(C(t),{variant:`secondary`},{default:y(()=>[p(C(v),{class:`h-4 w-4 mr-2`}),s[12]||=w(` 编辑用户 `,-1)]),_:1})),[[c,C(P).UPDATE]]),b((m(),E(C(t),{variant:`destructive`},{default:y(()=>[p(C(v),{class:`h-4 w-4 mr-2`}),s[13]||=w(` 删除用户 `,-1)]),_:1})),[[c,C(P).DELETE]])]),s[15]||=S(`p`,{class:`text-xs text-muted-foreground`},` 代码: v-permission="USER_PERMISSIONS.CREATE" `,-1)]),p(C(n)),S(`div`,G,[s[18]||=S(`h4`,{class:`text-sm font-semibold`},`2. 多个权限 - 任一通过 (v-permission:any)`,-1),S(`div`,K,[b((m(),E(C(t),null,{default:y(()=>[...s[16]||=[w(` 用户管理（创建或编辑） `,-1)]]),_:1})),[[c,[C(P).CREATE,C(P).UPDATE],`any`]]),b((m(),E(C(t),{variant:`secondary`},{default:y(()=>[p(C(ae),{class:`h-4 w-4 mr-2`}),s[17]||=w(` 产品管理 `,-1)]),_:1})),[[c,[C(N).CREATE,C(N).UPDATE],`any`]])]),s[19]||=S(`p`,{class:`text-xs text-muted-foreground`},` 代码: v-permission:any="[USER_PERMISSIONS.CREATE, USER_PERMISSIONS.UPDATE]" `,-1)]),p(C(n)),S(`div`,q,[s[21]||=S(`h4`,{class:`text-sm font-semibold`},`3. 多个权限 - 全部通过 (v-permission:all)`,-1),S(`div`,se,[b((m(),E(C(t),null,{default:y(()=>[...s[20]||=[w(` 完整用户管理（需全部权限） `,-1)]]),_:1})),[[c,[C(P).CREATE,C(P).UPDATE,C(P).DELETE],`all`]])]),s[22]||=S(`p`,{class:`text-xs text-muted-foreground`},` 代码: v-permission:all="[USER_PERMISSIONS.CREATE, USER_PERMISSIONS.UPDATE, USER_PERMISSIONS.DELETE]" `,-1)]),p(C(n)),S(`div`,ce,[s[25]||=S(`h4`,{class:`text-sm font-semibold`},`4. 禁用模式 (v-permission.disabled)`,-1),S(`div`,le,[b((m(),E(C(t),{variant:`destructive`},{default:y(()=>[...s[23]||=[w(` 删除（无权限时禁用） `,-1)]]),_:1})),[[c,C(P).DELETE,void 0,{disabled:!0}]]),b((m(),E(C(t),{variant:`secondary`},{default:y(()=>[p(C(re),{class:`h-4 w-4 mr-2`}),s[24]||=w(` 审核订单 `,-1)]),_:1})),[[c,C(F).AUDIT,void 0,{disabled:!0}]])]),s[26]||=S(`p`,{class:`text-xs text-muted-foreground`},` 代码: v-permission.disabled="USER_PERMISSIONS.DELETE" - 无权限时按钮禁用而非隐藏 `,-1)])]),_:1})]),_:1})]),_:1}),p(C(i),{value:`composable`,class:`space-y-4`},{default:y(()=>[p(C(O),null,{default:y(()=>[p(C(j),null,{default:y(()=>[p(C(M),null,{default:y(()=>[...s[27]||=[w(`usePermission 组合式函数示例`,-1)]]),_:1}),p(C(A),null,{default:y(()=>[...s[28]||=[w(`在 script setup 中使用组合式函数进行权限检查`,-1)]]),_:1})]),_:1}),p(C(k),{class:`space-y-6`},{default:y(()=>[S(`div`,ue,[s[29]||=S(`h4`,{class:`text-sm font-semibold`},`单个权限检查结果`,-1),S(`div`,de,[(m(!0),T(g,null,l(C(De),e=>(m(),T(`div`,{key:e.code,class:`flex items-center justify-between p-2 rounded border`},[S(`span`,fe,_(e.name),1),p(C(D),{variant:e.hasPermission.value?`default`:`secondary`},{default:y(()=>[e.hasPermission.value?(m(),E(C(o),{key:0,class:`h-3 w-3 mr-1`})):(m(),E(C(ie),{key:1,class:`h-3 w-3 mr-1`})),w(` `+_(e.hasPermission.value?`有权限`:`无权限`),1)]),_:2},1032,[`variant`])]))),128))])]),p(C(n)),S(`div`,pe,[s[30]||=S(`h4`,{class:`text-sm font-semibold`},`组合权限检查结果`,-1),S(`div`,me,[(m(),T(g,null,l(ke,e=>S(`div`,{key:e.name,class:`flex items-center justify-between p-2 rounded border`},[S(`div`,null,[S(`p`,he,_(e.name),1),S(`p`,ge,_(e.description),1)]),p(C(D),{variant:e.result.value?`default`:`secondary`},{default:y(()=>[w(_(e.result.value?`通过`:`未通过`),1)]),_:2},1032,[`variant`])])),64))])]),p(C(n)),s[31]||=S(`div`,{class:`space-y-2`},[S(`h4`,{class:`text-sm font-semibold`},`使用示例代码`),S(`pre`,{class:`p-4 bg-muted rounded-lg text-xs overflow-x-auto`},[S(`code`,null,`// 在 script setup 中使用
const { hasPermission, hasAnyPermission, hasAllPermissions } = usePermission()

// 检查单个权限
const canCreate = hasPermission(USER_PERMISSIONS.CREATE)

// 检查任一权限
const canEdit = hasAnyPermission([USER_PERMISSIONS.CREATE, USER_PERMISSIONS.UPDATE])

// 检查全部权限
const canManage = hasAllPermissions([USER_PERMISSIONS.CREATE, USER_PERMISSIONS.UPDATE, USER_PERMISSIONS.DELETE])

// 在模板中使用
<Button :disabled="!canCreate">创建</Button>`)])],-1)]),_:1})]),_:1})]),_:1}),p(C(i),{value:`role`,class:`space-y-4`},{default:y(()=>[p(C(O),null,{default:y(()=>[p(C(j),null,{default:y(()=>[p(C(M),null,{default:y(()=>[...s[32]||=[w(`v-role 角色控制示例`,-1)]]),_:1}),p(C(A),null,{default:y(()=>[...s[33]||=[w(`使用 v-role 指令基于角色控制元素显示`,-1)]]),_:1})]),_:1}),p(C(k),{class:`space-y-6`},{default:y(()=>[S(`div`,_e,[s[36]||=S(`h4`,{class:`text-sm font-semibold`},`1. 单个角色检查`,-1),S(`div`,ve,[b((m(),E(C(t),{variant:`default`},{default:y(()=>[p(C(a),{class:`h-4 w-4 mr-2`}),s[34]||=w(` 仅管理员可见 `,-1)]),_:1})),[[d,`admin`]]),b((m(),E(C(t),{variant:`secondary`},{default:y(()=>[...s[35]||=[w(` 仅编辑者可见 `,-1)]]),_:1})),[[d,`editor`]])]),s[37]||=S(`p`,{class:`text-xs text-muted-foreground`},` 代码: v-role="'admin'" - 仅 admin 角色可见 `,-1)]),p(C(n)),S(`div`,ye,[s[39]||=S(`h4`,{class:`text-sm font-semibold`},`2. 多个角色 - 任一通过 (v-role:any)`,-1),S(`div`,be,[b((m(),E(C(t),{variant:`default`},{default:y(()=>[p(C(a),{class:`h-4 w-4 mr-2`}),s[38]||=w(` 管理员或编辑者可见 `,-1)]),_:1})),[[d,[`admin`,`editor`],`any`]])]),s[40]||=S(`p`,{class:`text-xs text-muted-foreground`},` 代码: v-role:any="['admin', 'editor']" - admin 或 editor 角色可见 `,-1)]),p(C(n)),S(`div`,xe,[s[42]||=S(`h4`,{class:`text-sm font-semibold`},`3. 角色禁用模式 (v-role.disabled)`,-1),S(`div`,Se,[b((m(),E(C(t),{variant:`destructive`},{default:y(()=>[...s[41]||=[w(` 管理员操作（无权限时禁用） `,-1)]]),_:1})),[[d,`admin`,void 0,{disabled:!0}]])]),s[43]||=S(`p`,{class:`text-xs text-muted-foreground`},` 代码: v-role.disabled="'admin'" - 非 admin 角色时按钮禁用 `,-1)]),p(C(n)),S(`div`,Ce,[s[46]||=S(`h4`,{class:`text-sm font-semibold`},`当前角色信息`,-1),S(`div`,we,[S(`p`,Te,[s[44]||=S(`strong`,null,`当前角色:`,-1),w(` `+_(C(Z)?.role||`未登录`),1)]),S(`p`,J,[s[45]||=S(`strong`,null,`是否管理员:`,-1),w(` `+_(C(z)?`是`:`否`),1)])])])]),_:1})]),_:1})]),_:1})]),_:1}),p(C(O),null,{default:y(()=>[p(C(j),null,{default:y(()=>[p(C(M),null,{default:y(()=>[...s[47]||=[w(`使用说明`,-1)]]),_:1})]),_:1}),p(C(k),{class:`space-y-4`},{default:y(()=>[...s[48]||=[S(`div`,{class:`grid gap-4 md:grid-cols-2`},[S(`div`,{class:`space-y-2`},[S(`h4`,{class:`font-semibold`},`指令方式 (模板中直接使用)`),S(`ul`,{class:`text-sm text-muted-foreground space-y-1 list-disc list-inside`},[S(`li`,null,`v-permission="'user:create'" - 单个权限`),S(`li`,null,`v-permission:any="[...]" - 任一权限`),S(`li`,null,`v-permission:all="[...]" - 全部权限`),S(`li`,null,`v-permission.disabled="..." - 禁用模式`),S(`li`,null,`v-role="'admin'" - 角色检查`)])]),S(`div`,{class:`space-y-2`},[S(`h4`,{class:`font-semibold`},`组合式函数方式 (script setup 中使用)`),S(`ul`,{class:`text-sm text-muted-foreground space-y-1 list-disc list-inside`},[S(`li`,null,`hasPermission(permission) - 检查单个权限`),S(`li`,null,`hasAnyPermission([...]) - 任一权限通过`),S(`li`,null,`hasAllPermissions([...]) - 全部权限通过`),S(`li`,null,`hasRole(role) - 检查角色`),S(`li`,null,`isAdmin - 是否管理员`)])])],-1)]]),_:1})]),_:1})])}}});export{Y as default};
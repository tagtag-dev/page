import{i as e,r as t}from"./button-Bo4o88Eb.js";import{i as n,r}from"./Presence-CX2vXdhf.js";import{t as i}from"./usePrimitiveElement-bvCn2QxH.js";import{Ai as a,Bi as o,Cn as s,Di as c,Ii as l,Ki as u,Qi as d,Sa as f,Ti as p,Ui as m,Vi as h,Wi as g,_i as _,fa as v,ga as y,ji as b,na as x,ni as S,oa as C,ra as w,sn as T,wa as E,yi as D}from"./index-D9LA8apy.js";function O(){let e=document.activeElement;if(e==null)return null;for(;e!=null&&e.shadowRoot!=null&&e.shadowRoot.activeElement!=null;)e=e.shadowRoot.activeElement;return e}var k=0;function A(e,t=`reka`){if(e)return e;if(`useId`in S)return`${t}-${d?.()}`;let r=n({useId:void 0});return r.useId?`${t}-${r.useId()}`:`${t}-${++k}`}var j=`data-reka-collection-item`;function M(t={}){let{key:n=``,isProvider:r=!1}=t,o=`${n}CollectionProvider`,s;if(r){let e=y(new Map);s={collectionRef:y(),itemMap:e},g(o,s)}else s=b(o);let l=(e=!1)=>{let t=s.collectionRef.value;if(!t)return[];let n=Array.from(t.querySelectorAll(`[${j}]`)),r=Array.from(s.itemMap.value.values()).sort((e,t)=>n.indexOf(e.ref)-n.indexOf(t.ref));return e?r:r.filter(e=>e.ref.dataset.disabled!==``)},u=c({name:`CollectionSlot`,inheritAttrs:!1,setup(t,{slots:n,attrs:r}){let{primitiveElement:o,currentElement:c}=i();return x(c,()=>{s.collectionRef.value=c.value}),()=>a(e,{ref:o,...r},n)}}),d=c({name:`CollectionItem`,inheritAttrs:!1,props:{value:{validator:()=>!0}},setup(t,{slots:n,attrs:r}){let{primitiveElement:o,currentElement:c}=i();return w(e=>{if(c.value){let n=v(c.value);s.itemMap.value.set(n,{ref:c.value,value:t.value}),e(()=>s.itemMap.value.delete(n))}}),()=>a(e,{...r,[j]:``,ref:o},n)}});return{getItems:l,reactiveItems:_(()=>Array.from(s.itemMap.value.values())),itemMapSize:_(()=>s.itemMap.value.size),CollectionSlot:u,CollectionItem:d}}var N=`rovingFocusGroup.onEntryFocus`,P={bubbles:!1,cancelable:!0},F={ArrowLeft:`prev`,ArrowUp:`prev`,ArrowRight:`next`,ArrowDown:`next`,PageUp:`first`,Home:`first`,PageDown:`last`,End:`last`};function I(e,t){return t===`rtl`?e===`ArrowLeft`?`ArrowRight`:e===`ArrowRight`?`ArrowLeft`:e:e}function L(e,t,n){let r=I(e.key,n);if(!(t===`vertical`&&[`ArrowLeft`,`ArrowRight`].includes(r))&&!(t===`horizontal`&&[`ArrowUp`,`ArrowDown`].includes(r)))return F[r]}function R(e,t=!1){let n=O();for(let r of e)if(r===n||(r.focus({preventScroll:t}),O()!==n))return}function z(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var[B,V]=s(`RovingFocusGroup`),H=c({__name:`RovingFocusGroup`,props:{orientation:{type:String,required:!1,default:void 0},dir:{type:String,required:!1},loop:{type:Boolean,required:!1,default:!1},currentTabStopId:{type:[String,null],required:!1},defaultCurrentTabStopId:{type:String,required:!1},preventScrollOnEntryFocus:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:[`entryFocus`,`update:currentTabStopId`],setup(e,{expose:n,emit:i}){let a=e,o=i,{loop:s,orientation:c,dir:l}=f(a),d=r(l),h=T(a,`currentTabStopId`,o,{defaultValue:a.defaultCurrentTabStopId,passive:a.currentTabStopId===void 0}),g=y(!1),_=y(!1),v=y(0),{getItems:b,CollectionSlot:x}=M({isProvider:!0});function S(e){let t=!_.value;if(e.currentTarget&&e.target===e.currentTarget&&t&&!g.value){let t=new CustomEvent(N,P);if(e.currentTarget.dispatchEvent(t),o(`entryFocus`,t),!t.defaultPrevented){let e=b().map(e=>e.ref).filter(e=>e.dataset.disabled!==``);R([e.find(e=>e.getAttribute(`data-active`)===``),e.find(e=>e.getAttribute(`data-highlighted`)===``),e.find(e=>e.id===h.value),...e].filter(Boolean),a.preventScrollOnEntryFocus)}}_.value=!1}function w(){setTimeout(()=>{_.value=!1},1)}return n({getItems:b}),V({loop:s,dir:d,orientation:c,currentTabStopId:h,onItemFocus:e=>{h.value=e},onItemShiftTab:()=>{g.value=!0},onFocusableItemAdd:()=>{v.value++},onFocusableItemRemove:()=>{v.value--}}),(e,n)=>(m(),D(E(x),null,{default:C(()=>[p(E(t),{tabindex:g.value||v.value===0?-1:0,"data-orientation":E(c),as:e.as,"as-child":e.asChild,dir:E(d),style:{outline:`none`},onMousedown:n[0]||=e=>_.value=!0,onMouseup:w,onFocus:S,onBlur:n[1]||=e=>g.value=!1},{default:C(()=>[u(e.$slots,`default`)]),_:3},8,[`tabindex`,`data-orientation`,`as`,`as-child`,`dir`])]),_:3}))}}),U=c({__name:`RovingFocusItem`,props:{tabStopId:{type:String,required:!1},focusable:{type:Boolean,required:!1,default:!0},active:{type:Boolean,required:!1},allowShiftKey:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:`span`}},setup(e){let n=e,r=B(),i=A(),a=_(()=>n.tabStopId||i),s=_(()=>r.currentTabStopId.value===a.value),{getItems:c,CollectionItem:d}=M();o(()=>{n.focusable&&r.onFocusableItemAdd()}),h(()=>{n.focusable&&r.onFocusableItemRemove()});function f(e){if(e.key===`Tab`&&e.shiftKey){r.onItemShiftTab();return}if(e.target!==e.currentTarget)return;let t=L(e,r.orientation.value,r.dir.value);if(t!==void 0){if(e.metaKey||e.ctrlKey||e.altKey||!n.allowShiftKey&&e.shiftKey)return;e.preventDefault();let i=[...c().map(e=>e.ref).filter(e=>e.dataset.disabled!==``)];if(t===`last`)i.reverse();else if(t===`prev`||t===`next`){t===`prev`&&i.reverse();let n=i.indexOf(e.currentTarget);i=r.loop.value?z(i,n+1):i.slice(n+1)}l(()=>R(i))}}return(e,n)=>(m(),D(E(d),null,{default:C(()=>[p(E(t),{tabindex:s.value?0:-1,"data-orientation":E(r).orientation.value,"data-active":e.active?``:void 0,"data-disabled":e.focusable?void 0:``,as:e.as,"as-child":e.asChild,onMousedown:n[0]||=t=>{e.focusable?E(r).onItemFocus(a.value):t.preventDefault()},onFocus:n[1]||=e=>E(r).onItemFocus(a.value),onKeydown:f},{default:C(()=>[u(e.$slots,`default`)]),_:3},8,[`tabindex`,`data-orientation`,`data-active`,`data-disabled`,`as`,`as-child`])]),_:3}))}});export{A as a,M as i,H as n,O as o,L as r,U as t};
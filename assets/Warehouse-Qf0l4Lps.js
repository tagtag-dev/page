import"./ScrollArea-u7vgQcwr.js";import"./RovingFocusItem-tfPyown7.js";import"./Presence-CTcpkTiJ.js";import"./TabsTrigger-BVA-KY5p.js";import{Bi as e,Ha as t,Ii as n,J as r,Jn as i,Ka as ee,Ki as te,Li as a,Lt as ne,Pa as o,Ri as s,Ui as c,V as l,Wa as u,Wi as d,Xt as f,ji as re,ka as p,la as ie,n as m,nt as ae,pa as h,qa as g,sa as _,u as oe,v as se,wa as v,yr as y,zi as ce}from"./index-Bdnse1ke.js";import"./en_US-B-0xvqcl.js";import"./common-B6eu2cAW.js";import"./zh_CN-o6dt8jMH.js";import"./useFullscreen-Cz-fRWjR.js";import"./_plugin-vue_export-helper-CuErARa7.js";import{t as le}from"./badge-CifgcTtr.js";import"./dist-CIVP1JAM.js";import"./theme-shared-CKGE9ZaP.js";import{t as ue}from"./TTable-BqF1vWP0.js";import"./useTableColumns-ClPoF4Nv.js";import"./useResponsive-Drj8-vqi.js";import{t as b}from"./TForm-D3MGp7pF.js";import"./TIcon-BqmThimp.js";import{t as x}from"./TModal-C-7FBAha.js";import{n as de,t as S}from"./CardContent-CE0o8nDP.js";import{n as C,t as w}from"./CardTitle-BRqhnrl0.js";import{n as T,r as E}from"./composables-cmucIgPx.js";import"./constants-OTiF8S51.js";var D={class:`space-y-6`},O={class:`flex flex-col sm:flex-row sm:items-center justify-between gap-4`},k={class:`flex flex-wrap gap-3`},A={class:`flex items-baseline gap-2`},j={class:`text-lg font-semibold`},M={class:`text-xs text-muted-foreground`},N={class:`bg-muted/40 border border-border/50 rounded-xl px-3 py-3`},P={class:`flex flex-col lg:flex-row lg:items-center gap-4`},F={class:`flex-1`},I={class:`flex items-center gap-3`},L={class:`text-xs text-muted-foreground bg-muted px-2 py-0.5 rounded-full`},R={class:`flex items-center gap-2`},z={class:`font-medium`},B={class:`flex items-center gap-1 text-sm`},V={class:`flex items-center gap-1 text-sm`},H={class:`space-y-1`},fe={class:`flex justify-between text-xs`},pe={class:`h-1.5 bg-muted rounded-full overflow-hidden`},me={class:`flex flex-col items-center justify-center py-12 text-muted-foreground`},he={class:`w-16 h-16 rounded-full bg-muted flex items-center justify-center mb-4`},ge=te({__name:`Warehouse`,setup(te){let{data:ge,loading:_e,searchQuery:U,filters:W,filteredData:ve,paginatedData:ye,total:be,statistics:xe,fetchData:G}=T({apiCall:()=>i.getWarehouses(),filterFn:(e,t,n)=>{let r=e;if(t){let e=t.toLowerCase();r=r.filter(t=>t.name.toLowerCase().includes(e)||t.code.toLowerCase().includes(e))}return n.status&&(r=r.filter(e=>e.status===n.status)),r},statisticsFn:e=>{let t=e.length,n=e.filter(e=>e.status===y.ACTIVE).length,r=e.reduce((e,t)=>e+(t.capacity??0),0),i=e.reduce((e,t)=>e+(t.usedCapacity??0),0);return{total:t,active:n,totalCapacity:r,usedCapacity:i,utilizationRate:r>0?Math.round(i/r*100):0}}}),Se=n(()=>{let e=xe.value||{};return[{title:`仓库总数`,value:e.total||0,icon:f,color:`text-blue-500`},{title:`运营中`,value:e.active||0,icon:ne,color:`text-green-500`},{title:`总容量`,value:(e.totalCapacity||0).toLocaleString(),icon:r,color:`text-purple-500`},{title:`使用率`,value:(e.utilizationRate||0)+`%`,icon:se,color:`text-orange-500`}]}),K=o({keyword:``,status:``}),Ce={layout:`inline`,fields:[{name:`keyword`,type:`input`,label:``,placeholder:`搜索仓库名称、编码...`,className:`w-[240px]`},{name:`status`,type:`select`,label:``,placeholder:`全部状态`,options:[{label:`全部状态`,value:``},{label:`运营中`,value:y.ACTIVE},{label:`已停用`,value:y.INACTIVE}],className:`w-[140px]`}],searchConfig:{enabled:!0,collapsed:!1,showCollapseButton:!1,searchText:`搜索`,resetText:`重置`,showReset:!0,onSearch:e=>{U.value=e.keyword||``,W.value={status:e.status}},onReset:()=>{U.value=``,W.value={}}}},we=n(()=>({columns:[{title:`仓库信息`,dataIndex:`name`,width:200,slot:`name`},{title:`仓库编码`,dataIndex:`code`,width:120},{title:`位置`,dataIndex:`location`,width:180,slot:`location`},{title:`负责人`,dataIndex:`manager`,width:120,slot:`manager`},{title:`容量使用`,dataIndex:`capacity`,width:150,slot:`capacity`},{title:`商品数量`,dataIndex:`productCount`,width:100,sorter:!0},{title:`状态`,dataIndex:`status`,width:100,slot:`status`}],pagination:{pageSize:10,show:!0,showSizeChanger:!0},rowSelection:{type:`checkbox`,show:!0},actions:[{text:`编辑`,type:`primary`,onClick:e=>$(e)},{text:`删除`,type:`danger`,confirm:!0,confirmText:`确定要删除该仓库吗？`,onClick:e=>Ne(e.id)}],actionWidth:150,actionFixed:`right`})),q=n(()=>ye.value.map(e=>({...e,key:e.id}))),J=o(!1),Y=o(!1),X=o(null),Z=o({name:``,code:``,location:``,manager:``,phone:``,capacity:1e3,status:`active`}),Q=o({id:``,name:``,code:``,location:``,manager:``,phone:``,capacity:1e3,status:`active`}),Te={layout:`horizontal`,labelCol:{span:6},wrapperCol:{span:18},fields:[{name:`name`,type:`input`,label:`仓库名称`,placeholder:`请输入仓库名称`,rules:[{required:!0,message:`仓库名称不能为空`}]},{name:`code`,type:`input`,label:`仓库编码`,placeholder:`请输入仓库编码`,rules:[{required:!0,message:`仓库编码不能为空`}]},{name:`location`,type:`input`,label:`仓库位置`,placeholder:`请输入详细地址`,rules:[{required:!0,message:`仓库位置不能为空`}]},{name:`manager`,type:`input`,label:`负责人`,placeholder:`请输入负责人姓名`,rules:[{required:!0,message:`负责人不能为空`}]},{name:`phone`,type:`input`,label:`联系电话`,placeholder:`请输入联系电话`},{name:`capacity`,type:`number`,label:`仓库容量`,placeholder:`请输入容量`,rules:[{required:!0,message:`仓库容量不能为空`}]},{name:`status`,type:`select`,label:`状态`,placeholder:`请选择状态`,options:[{label:`运营中`,value:`active`},{label:`已停用`,value:`inactive`}]}],actions:{showSubmit:!0,showReset:!0,submitText:`添加仓库`,resetText:`取消`,align:`right`,onReset:()=>{J.value=!1}}},Ee={layout:`horizontal`,labelCol:{span:6},wrapperCol:{span:18},fields:[{name:`name`,type:`input`,label:`仓库名称`,placeholder:`请输入仓库名称`,rules:[{required:!0,message:`仓库名称不能为空`}]},{name:`location`,type:`input`,label:`仓库位置`,placeholder:`请输入详细地址`},{name:`manager`,type:`input`,label:`负责人`,placeholder:`请输入负责人姓名`},{name:`phone`,type:`input`,label:`联系电话`,placeholder:`请输入联系电话`},{name:`capacity`,type:`number`,label:`仓库容量`,placeholder:`请输入容量`},{name:`status`,type:`select`,label:`状态`,placeholder:`请选择状态`,options:[{label:`运营中`,value:`active`},{label:`已停用`,value:`inactive`}]}],actions:{showSubmit:!0,showReset:!0,submitText:`保存修改`,resetText:`取消`,align:`right`,onReset:()=>{Y.value=!1}}},{mutate:De}=E({mutationFn:e=>i.createWarehouse({name:e.name,code:e.code,location:e.location,manager:e.manager,phone:e.phone,capacity:Number(e.capacity),status:e.status,productCount:0,usedCapacity:0}),onSuccess:()=>{J.value=!1,Z.value={name:``,code:``,location:``,manager:``,phone:``,capacity:1e3,status:`active`},G()}}),{mutate:Oe,loading:ke}=E({mutationFn:({id:e,values:t})=>i.updateWarehouse(e,{name:t.name,location:t.location,manager:t.manager,phone:t.phone,capacity:Number(t.capacity),status:t.status}),onSuccess:()=>{Y.value=!1,X.value=null,G()}}),{mutate:Ae}=E({mutationFn:e=>i.deleteWarehouse(e),onSuccess:()=>G()});function $(e){X.value=e,Q.value={id:e.id,name:e.name,code:e.code,location:e.location,manager:e.manager,phone:e.phone,capacity:e.capacity,status:e.status},Y.value=!0}function je(e){De(e)}function Me(e){X.value&&Oe({id:X.value.id,values:e})}function Ne(e){Ae(e)}let Pe=o([]);function Fe(e){Pe.value=e}return(n,r)=>(_(),e(`div`,D,[a(`div`,O,[r[9]||=a(`div`,null,[a(`h1`,{class:`text-3xl font-bold tracking-tight`},`仓库管理`),a(`p`,{class:`text-muted-foreground mt-1.5 text-sm`},`管理仓库信息和容量`)],-1),d(t(m),{class:`gap-2`,onClick:r[0]||=e=>J.value=!0},{default:v(()=>[d(t(l),{class:`h-4 w-4`}),r[8]||=c(` 添加仓库 `,-1)]),_:1})]),d(t(x),{open:t(J),"onUpdate:open":r[2]||=e=>p(J)?J.value=e:null,title:`添加仓库`,width:`560`,footer:null},{default:v(()=>[d(t(b),{modelValue:t(Z),"onUpdate:modelValue":r[1]||=e=>p(Z)?Z.value=e:null,schema:Te,onSubmit:je},null,8,[`modelValue`])]),_:1},8,[`open`]),d(t(x),{open:t(Y),"onUpdate:open":r[4]||=e=>p(Y)?Y.value=e:null,title:`编辑仓库`,width:`560`,footer:null},{default:v(()=>[t(X)?(_(),s(t(b),{key:0,modelValue:t(Q),"onUpdate:modelValue":r[3]||=e=>p(Q)?Q.value=e:null,schema:Ee,onSubmit:Me},null,8,[`modelValue`])):ce(``,!0)]),_:1},8,[`open`]),a(`div`,k,[(_(!0),e(re,null,ie(t(Se),t=>(_(),e(`div`,{key:t.title,class:`flex items-center gap-3 px-4 py-2.5 bg-muted/50 rounded-lg hover:bg-muted/70 transition-colors`},[(_(),s(h(t.icon),{class:u([`h-4 w-4`,t.color])},null,8,[`class`])),a(`div`,A,[a(`span`,j,g(t.value),1),a(`span`,M,g(t.title),1)])]))),128))]),a(`div`,N,[a(`div`,P,[a(`div`,F,[d(t(b),{modelValue:t(K),"onUpdate:modelValue":r[5]||=e=>p(K)?K.value=e:null,schema:Ce},null,8,[`modelValue`])])])]),d(t(de),{class:`bg-muted/40 border border-border/50 rounded-xl`},{default:v(()=>[d(t(C),{class:`pb-4`},{default:v(()=>[a(`div`,I,[d(t(w),{class:`text-base font-semibold`},{default:v(()=>[...r[10]||=[c(`仓库列表`,-1)]]),_:1}),a(`span`,L,` 共 `+g(t(q).length)+` 个 `,1)])]),_:1}),d(t(S),{class:`pt-0`},{default:v(()=>[d(t(ue),{ref:`tableRef`,data:t(q),"onUpdate:data":r[7]||=e=>p(q)?q.value=e:null,schema:t(we),onSelectChange:Fe},{name:v(e=>[a(`div`,R,[d(t(f),{class:`h-4 w-4 text-blue-500`}),a(`span`,z,g(e.text),1)])]),location:v(e=>[a(`div`,B,[d(t(ae),{class:`h-3 w-3 text-muted-foreground`}),a(`span`,null,g(e.text),1)])]),manager:v(e=>[a(`div`,V,[d(t(oe),{class:`h-3 w-3 text-muted-foreground`}),a(`span`,null,g(e.text),1)])]),capacity:v(e=>[a(`div`,H,[a(`div`,fe,[a(`span`,null,g(e.record.usedCapacity??0)+` / `+g(e.text),1),a(`span`,null,g(Math.round((e.record.usedCapacity??0)/(e.text||1)*100))+`%`,1)]),a(`div`,pe,[a(`div`,{class:`h-full bg-primary rounded-full`,style:ee({width:`${Math.min((e.record.usedCapacity??0)/(e.text||1)*100,100)}%`})},null,4)])])]),status:v(e=>[d(t(le),{class:u({"bg-green-500/10 text-green-500 border-green-500/20":e.text===t(y).ACTIVE,"bg-gray-500/10 text-gray-500 border-gray-500/20":e.text===t(y).INACTIVE}),variant:`outline`},{default:v(()=>[c(g(e.text===t(y).ACTIVE?`运营中`:`已停用`),1)]),_:2},1032,[`class`])]),emptyText:v(()=>[a(`div`,me,[a(`div`,he,[d(t(f),{class:`w-8 h-8 text-muted-foreground/50`})]),r[12]||=a(`p`,{class:`text-base font-medium mb-1`},`暂无仓库数据`,-1),r[13]||=a(`p`,{class:`text-sm text-muted-foreground mb-4`},`开始添加您的第一个仓库吧`,-1),d(t(m),{size:`sm`,onClick:r[6]||=e=>J.value=!0},{default:v(()=>[d(t(l),{class:`h-4 w-4 mr-1`}),r[11]||=c(` 添加仓库 `,-1)]),_:1})])]),_:1},8,[`data`,`schema`])]),_:1})]),_:1})]))}});export{ge as default};
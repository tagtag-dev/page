import"./ScrollArea-u7vgQcwr.js";import"./RovingFocusItem-tfPyown7.js";import"./Presence-CTcpkTiJ.js";import"./TabsTrigger-BVA-KY5p.js";import{Bi as e,Ha as t,Ii as n,It as r,J as i,Ki as ee,Li as a,Pa as o,Pt as s,Ri as c,Ui as l,V as u,Wa as d,Wi as f,Yn as p,ji as te,ka as m,la as ne,n as h,pa as g,qa as _,sa as v,wa as y,yt as b,zi as x}from"./index-Bdnse1ke.js";import"./en_US-B-0xvqcl.js";import"./common-B6eu2cAW.js";import"./zh_CN-o6dt8jMH.js";import"./useFullscreen-Cz-fRWjR.js";import"./_plugin-vue_export-helper-CuErARa7.js";import{t as re}from"./badge-CifgcTtr.js";import"./dist-CIVP1JAM.js";import"./theme-shared-CKGE9ZaP.js";import{t as ie}from"./TTable-BqF1vWP0.js";import"./useTableColumns-ClPoF4Nv.js";import"./useResponsive-Drj8-vqi.js";import{t as S}from"./TForm-D3MGp7pF.js";import"./TIcon-BqmThimp.js";import{t as C}from"./TModal-C-7FBAha.js";import{n as ae,t as oe}from"./CardContent-CE0o8nDP.js";import{n as se,t as ce}from"./CardTitle-BRqhnrl0.js";import{n as le}from"./composables-cmucIgPx.js";var ue={class:`space-y-6`},w={class:`flex flex-col sm:flex-row sm:items-center justify-between gap-4`},T={class:`flex flex-wrap gap-3`},E={class:`flex items-baseline gap-2`},D={class:`text-lg font-semibold`},O={class:`text-xs text-muted-foreground`},k={class:`bg-muted/40 border border-border/50 rounded-xl px-3 py-3`},A={class:`flex flex-col lg:flex-row lg:items-center gap-4`},j={class:`flex-1`},M={key:0,class:`flex items-center gap-2 lg:border-l lg:pl-4`},N={class:`text-sm text-muted-foreground`},P={class:`flex items-center justify-between`},F={class:`flex items-center gap-3`},I={class:`text-xs text-muted-foreground bg-muted px-2 py-0.5 rounded-full`},L={class:`flex items-center gap-2`},R={class:`font-medium`},z={class:`flex flex-col items-center justify-center py-12 text-muted-foreground`},B={class:`w-16 h-16 rounded-full bg-muted flex items-center justify-center mb-4`},V=ee({__name:`Level1`,setup(ee){let{data:V,loading:de,searchQuery:H,filters:U,filteredData:fe,paginatedData:pe,total:me,statistics:W,fetchData:G}=le({apiCall:()=>p.getCategories(),filterFn:(e,t,n)=>{let r=e.filter(e=>e.level===1);if(t){let e=t.toLowerCase();r=r.filter(t=>t.name.toLowerCase().includes(e)||t.code.toLowerCase().includes(e))}return n.status&&(r=r.filter(e=>e.status===n.status)),r},statisticsFn:e=>{let t=e.filter(e=>e.level===1);return{total:t.length,active:t.filter(e=>e.status===`active`).length,inactive:t.filter(e=>e.status===`inactive`).length,totalProducts:t.reduce((e,t)=>e+t.productCount,0)}}}),K=o({keyword:``,status:``}),he={layout:`inline`,fields:[{name:`keyword`,type:`input`,label:``,placeholder:`搜索分类名称...`,className:`w-[200px]`},{name:`status`,type:`select`,label:``,placeholder:`全部状态`,options:[{label:`全部状态`,value:``},{label:`启用`,value:`active`},{label:`禁用`,value:`inactive`}],className:`w-[140px]`}],searchConfig:{enabled:!0,collapsed:!1,showCollapseButton:!1,searchText:`搜索`,resetText:`重置`,showReset:!0,onSearch:e=>{H.value=e.keyword||``,U.value={status:e.status}},onReset:()=>{H.value=``,U.value={}}}},ge=n(()=>({columns:[{title:`分类名称`,dataIndex:`name`,width:180,slot:`name`},{title:`分类编码`,dataIndex:`code`,width:150},{title:`商品数量`,dataIndex:`productCount`,width:100,sorter:!0},{title:`排序`,dataIndex:`sort`,width:80,sorter:!0},{title:`状态`,dataIndex:`status`,width:100,slot:`status`}],pagination:{pageSize:10,show:!0,showSizeChanger:!0},rowSelection:{type:`checkbox`,show:!0},actions:[{text:`编辑`,type:`primary`,onClick:e=>xe(e)},{text:`删除`,type:`danger`,confirm:!0,confirmText:`确定要删除该分类吗？`,onClick:e=>Ce(e.id)}],actionWidth:150,actionFixed:`right`})),q=n(()=>pe.value.map(e=>({...e,key:e.id}))),_e=n(()=>[{title:`分类总数`,value:W.value.total??0,icon:b,color:`text-blue-500`},{title:`已启用`,value:W.value.active??0,icon:r,color:`text-green-500`},{title:`已禁用`,value:W.value.inactive??0,icon:s,color:`text-gray-500`},{title:`商品总数`,value:W.value.totalProducts??0,icon:i,color:`text-purple-500`}]),J=o(!1),Y=o(!1),X=o(null),Z=o({name:``,code:``,sort:0,status:`active`,description:``}),Q=o({id:``,name:``,code:``,sort:0,status:`active`,description:``}),ve={layout:`horizontal`,labelCol:{span:6},wrapperCol:{span:18},fields:[{name:`name`,type:`input`,label:`分类名称`,placeholder:`请输入分类名称`,rules:[{required:!0,message:`分类名称不能为空`}]},{name:`code`,type:`input`,label:`分类编码`,placeholder:`请输入分类编码`,rules:[{required:!0,message:`分类编码不能为空`}]},{name:`sort`,type:`number`,label:`排序`,placeholder:`请输入排序号`},{name:`status`,type:`select`,label:`状态`,placeholder:`请选择状态`,options:[{label:`启用`,value:`active`},{label:`禁用`,value:`inactive`}]},{name:`description`,type:`textarea`,label:`描述`,placeholder:`请输入描述（可选）`}],actions:{showSubmit:!0,showReset:!0,submitText:`添加分类`,resetText:`取消`,align:`right`,onReset:()=>{J.value=!1}}},ye={layout:`horizontal`,labelCol:{span:6},wrapperCol:{span:18},fields:[{name:`name`,type:`input`,label:`分类名称`,placeholder:`请输入分类名称`,rules:[{required:!0,message:`分类名称不能为空`}]},{name:`code`,type:`input`,label:`分类编码`,placeholder:`请输入分类编码`,rules:[{required:!0,message:`分类编码不能为空`}]},{name:`sort`,type:`number`,label:`排序`,placeholder:`请输入排序号`},{name:`status`,type:`select`,label:`状态`,placeholder:`请选择状态`,options:[{label:`启用`,value:`active`},{label:`禁用`,value:`inactive`}]},{name:`description`,type:`textarea`,label:`描述`,placeholder:`请输入描述（可选）`}],actions:{showSubmit:!0,showReset:!0,submitText:`保存修改`,resetText:`取消`,align:`right`,onReset:()=>{Y.value=!1}}};async function be(e){await p.createCategory({name:e.name,code:e.code,level:1,sort:Number(e.sort)||0,status:e.status,productCount:0,description:e.description}),J.value=!1,Z.value={name:``,code:``,sort:0,status:`active`,description:``},await G()}function xe(e){X.value=e,Q.value={id:e.id,name:e.name,code:e.code,sort:e.sort,status:e.status,description:e.description||``},Y.value=!0}function Se(e){X.value&&(p.updateCategory(X.value.id,{name:e.name,code:e.code,sort:Number(e.sort),status:e.status,description:e.description}),Y.value=!1,X.value=null,G())}async function Ce(e){await p.deleteCategory(e),await G()}let $=o([]);function we(e){$.value=e}async function Te(){if($.value.length===0){alert(`请先选择要删除的分类`);return}confirm(`确定要删除选中的 ${$.value.length} 个分类吗？`)&&(await p.batchDeleteCategories($.value.map(String)),await G())}return(n,r)=>(v(),e(`div`,ue,[a(`div`,w,[r[9]||=a(`div`,null,[a(`h1`,{class:`text-3xl font-bold tracking-tight`},`一级分类`),a(`p`,{class:`text-muted-foreground mt-1.5 text-sm`},`管理商品一级分类`)],-1),f(t(h),{class:`gap-2`,onClick:r[0]||=e=>J.value=!0},{default:y(()=>[f(t(u),{class:`h-4 w-4`}),r[8]||=l(` 添加一级分类 `,-1)]),_:1})]),f(t(C),{open:t(J),"onUpdate:open":r[2]||=e=>m(J)?J.value=e:null,title:`添加一级分类`,width:`560`,footer:null},{default:y(()=>[f(t(S),{modelValue:t(Z),"onUpdate:modelValue":r[1]||=e=>m(Z)?Z.value=e:null,schema:ve,onSubmit:be},null,8,[`modelValue`])]),_:1},8,[`open`]),f(t(C),{open:t(Y),"onUpdate:open":r[4]||=e=>m(Y)?Y.value=e:null,title:`编辑一级分类`,width:`560`,footer:null},{default:y(()=>[t(X)?(v(),c(t(S),{key:0,modelValue:t(Q),"onUpdate:modelValue":r[3]||=e=>m(Q)?Q.value=e:null,schema:ye,onSubmit:Se},null,8,[`modelValue`])):x(``,!0)]),_:1},8,[`open`]),a(`div`,T,[(v(!0),e(te,null,ne(t(_e),t=>(v(),e(`div`,{key:t.title,class:`flex items-center gap-3 px-4 py-2.5 bg-muted/50 rounded-lg hover:bg-muted/70 transition-colors`},[(v(),c(g(t.icon),{class:d([`h-4 w-4`,t.color])},null,8,[`class`])),a(`div`,E,[a(`span`,D,_(t.value),1),a(`span`,O,_(t.title),1)])]))),128))]),a(`div`,k,[a(`div`,A,[a(`div`,j,[f(t(S),{modelValue:t(K),"onUpdate:modelValue":r[5]||=e=>m(K)?K.value=e:null,schema:he},null,8,[`modelValue`])]),t($).length>0?(v(),e(`div`,M,[a(`span`,N,`已选 `+_(t($).length)+` 项`,1),f(t(h),{variant:`outline`,size:`sm`,class:`h-8 text-xs text-destructive hover:text-destructive`,onClick:Te},{default:y(()=>[...r[10]||=[l(` 批量删除 `,-1)]]),_:1})])):x(``,!0)])]),f(t(ae),{class:`bg-muted/40 border border-border/50 rounded-xl`},{default:y(()=>[f(t(se),{class:`pb-4`},{default:y(()=>[a(`div`,P,[a(`div`,F,[f(t(ce),{class:`text-base font-semibold`},{default:y(()=>[...r[11]||=[l(`一级分类列表`,-1)]]),_:1}),a(`span`,I,` 共 `+_(t(q).length)+` 个 `,1)])])]),_:1}),f(t(oe),{class:`pt-0`},{default:y(()=>[f(t(ie),{ref:`tableRef`,data:t(q),"onUpdate:data":r[7]||=e=>m(q)?q.value=e:null,schema:t(ge),onSelectChange:we},{name:y(e=>[a(`div`,L,[f(t(b),{class:`h-4 w-4 text-blue-500`}),a(`span`,R,_(e.text),1)])]),status:y(e=>[f(t(re),{class:d({"bg-green-500/10 text-green-500 border-green-500/20":e.text===`active`,"bg-gray-500/10 text-gray-500 border-gray-500/20":e.text===`inactive`}),variant:`outline`},{default:y(()=>[l(_(e.text===`active`?`启用`:`禁用`),1)]),_:2},1032,[`class`])]),emptyText:y(()=>[a(`div`,z,[a(`div`,B,[f(t(b),{class:`w-8 h-8 text-muted-foreground/50`})]),r[13]||=a(`p`,{class:`text-base font-medium mb-1`},`暂无一级分类`,-1),r[14]||=a(`p`,{class:`text-sm text-muted-foreground mb-4`},`开始添加您的第一个一级分类吧`,-1),f(t(h),{size:`sm`,onClick:r[6]||=e=>J.value=!0},{default:y(()=>[f(t(u),{class:`h-4 w-4 mr-1`}),r[12]||=l(` 添加分类 `,-1)]),_:1})])]),_:1},8,[`data`,`schema`])]),_:1})]),_:1})]))}});export{V as default};
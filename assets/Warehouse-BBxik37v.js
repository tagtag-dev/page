import"./ScrollArea-DFVXjTz0.js";import"./RovingFocusItem-CVjkq2qt.js";import"./Presence-3Lrzvetv.js";import"./defu-DUbmuhNq.js";import"./TabsTrigger-DqwypIQj.js";import{Ai as e,Ca as t,Fi as n,Ga as r,Gi as i,Hi as a,Ii as o,J as s,Ka as c,Li as l,Lt as ee,Na as u,Oa as d,Ri as te,Ua as f,Ui as p,V as m,Va as h,Xt as g,ca as ne,fa as re,n as _,nt as ie,oa as v,qn as y,u as ae,v as oe,vr as b,zi as x}from"./index-D6Cod0pL.js";import"./en_US-LGbIKe0x.js";import"./common-HQCQB71w.js";import"./zh_CN-Cgumeokr.js";import"./useFullscreen-lrjpQVTw.js";import"./_plugin-vue_export-helper-Dey4FfNi.js";import{t as se}from"./badge-O2q4qI2Q.js";import"./dist-D3XftLPo.js";import"./theme-shared-BpTdpb0d.js";import{t as ce}from"./TTable-B13ZnM5N.js";import"./useTableColumns-qs-cYpaB.js";import{t as S}from"./TForm-Drq7Qn9R.js";import"./TIcon-C-hNhMC1.js";import{t as C}from"./TModal-OyBXzO5K.js";import{n as le,t as ue}from"./CardContent-CMuL0LxG.js";import{n as de,t as w}from"./CardTitle-D06OZslX.js";import{n as T,r as E}from"./composables-CTAVZAup.js";import"./constants-OTiF8S51.js";var D={class:`space-y-6`},O={class:`flex flex-col sm:flex-row sm:items-center justify-between gap-4`},k={class:`flex flex-wrap gap-3`},A={class:`flex items-baseline gap-2`},j={class:`text-lg font-semibold`},M={class:`text-xs text-muted-foreground`},N={class:`bg-muted/40 border border-border/50 rounded-xl px-3 py-3`},P={class:`flex flex-col lg:flex-row lg:items-center gap-4`},F={class:`flex-1`},I={class:`flex items-center gap-3`},L={class:`text-xs text-muted-foreground bg-muted px-2 py-0.5 rounded-full`},R={class:`flex items-center gap-2`},z={class:`font-medium`},B={class:`flex items-center gap-1 text-sm`},V={class:`flex items-center gap-1 text-sm`},H={class:`space-y-1`},fe={class:`flex justify-between text-xs`},pe={class:`h-1.5 bg-muted rounded-full overflow-hidden`},me={class:`flex flex-col items-center justify-center py-12 text-muted-foreground`},he={class:`w-16 h-16 rounded-full bg-muted flex items-center justify-center mb-4`},ge=i({__name:`Warehouse`,setup(i){let{data:ge,loading:_e,searchQuery:U,filters:W,filteredData:ve,paginatedData:ye,total:be,statistics:xe,fetchData:G}=T({apiCall:()=>y.getWarehouses(),filterFn:(e,t,n)=>{let r=e;if(t){let e=t.toLowerCase();r=r.filter(t=>t.name.toLowerCase().includes(e)||t.code.toLowerCase().includes(e))}return n.status&&(r=r.filter(e=>e.status===n.status)),r},statisticsFn:e=>{let t=e.length,n=e.filter(e=>e.status===b.ACTIVE).length,r=e.reduce((e,t)=>e+t.capacity,0),i=e.reduce((e,t)=>e+t.usedCapacity,0);return{total:t,active:n,totalCapacity:r,usedCapacity:i,utilizationRate:r>0?Math.round(i/r*100):0}}}),Se=n(()=>{let e=xe.value||{};return[{title:`仓库总数`,value:e.total||0,icon:g,color:`text-blue-500`},{title:`运营中`,value:e.active||0,icon:ee,color:`text-green-500`},{title:`总容量`,value:(e.totalCapacity||0).toLocaleString(),icon:s,color:`text-purple-500`},{title:`使用率`,value:(e.utilizationRate||0)+`%`,icon:oe,color:`text-orange-500`}]}),K=u({keyword:``,status:``}),Ce={layout:`inline`,fields:[{name:`keyword`,type:`input`,label:``,placeholder:`搜索仓库名称、编码...`,className:`w-[240px]`},{name:`status`,type:`select`,label:``,placeholder:`全部状态`,options:[{label:`全部状态`,value:``},{label:`运营中`,value:b.ACTIVE},{label:`已停用`,value:b.INACTIVE}],className:`w-[140px]`}],searchConfig:{enabled:!0,collapsed:!1,showCollapseButton:!1,searchText:`搜索`,resetText:`重置`,showReset:!0,onSearch:e=>{U.value=e.keyword||``,W.value={status:e.status}},onReset:()=>{U.value=``,W.value={}}}},we=n(()=>({columns:[{title:`仓库信息`,dataIndex:`name`,width:200,slot:`name`},{title:`仓库编码`,dataIndex:`code`,width:120},{title:`位置`,dataIndex:`location`,width:180,slot:`location`},{title:`负责人`,dataIndex:`manager`,width:120,slot:`manager`},{title:`容量使用`,dataIndex:`capacity`,width:150,slot:`capacity`},{title:`商品数量`,dataIndex:`productCount`,width:100,sorter:!0},{title:`状态`,dataIndex:`status`,width:100,slot:`status`}],pagination:{pageSize:10,show:!0,showSizeChanger:!0},rowSelection:{type:`checkbox`,show:!0},actions:[{text:`编辑`,type:`primary`,onClick:e=>$(e)},{text:`删除`,type:`danger`,confirm:!0,confirmText:`确定要删除该仓库吗？`,onClick:e=>Ne(e.id)}],actionWidth:150,actionFixed:`right`})),q=n(()=>ye.value.map(e=>({...e,key:e.id}))),J=u(!1),Y=u(!1),X=u(null),Z=u({name:``,code:``,location:``,manager:``,phone:``,capacity:1e3,status:`active`}),Q=u({id:``,name:``,code:``,location:``,manager:``,phone:``,capacity:1e3,status:`active`}),Te={layout:`horizontal`,labelCol:{span:6},wrapperCol:{span:18},fields:[{name:`name`,type:`input`,label:`仓库名称`,placeholder:`请输入仓库名称`,rules:[{required:!0,message:`仓库名称不能为空`}]},{name:`code`,type:`input`,label:`仓库编码`,placeholder:`请输入仓库编码`,rules:[{required:!0,message:`仓库编码不能为空`}]},{name:`location`,type:`input`,label:`仓库位置`,placeholder:`请输入详细地址`,rules:[{required:!0,message:`仓库位置不能为空`}]},{name:`manager`,type:`input`,label:`负责人`,placeholder:`请输入负责人姓名`,rules:[{required:!0,message:`负责人不能为空`}]},{name:`phone`,type:`input`,label:`联系电话`,placeholder:`请输入联系电话`},{name:`capacity`,type:`number`,label:`仓库容量`,placeholder:`请输入容量`,rules:[{required:!0,message:`仓库容量不能为空`}]},{name:`status`,type:`select`,label:`状态`,placeholder:`请选择状态`,options:[{label:`运营中`,value:`active`},{label:`已停用`,value:`inactive`}]}],actions:{showSubmit:!0,showReset:!0,submitText:`添加仓库`,resetText:`取消`,align:`right`,onReset:()=>{J.value=!1}}},Ee={layout:`horizontal`,labelCol:{span:6},wrapperCol:{span:18},fields:[{name:`name`,type:`input`,label:`仓库名称`,placeholder:`请输入仓库名称`,rules:[{required:!0,message:`仓库名称不能为空`}]},{name:`location`,type:`input`,label:`仓库位置`,placeholder:`请输入详细地址`},{name:`manager`,type:`input`,label:`负责人`,placeholder:`请输入负责人姓名`},{name:`phone`,type:`input`,label:`联系电话`,placeholder:`请输入联系电话`},{name:`capacity`,type:`number`,label:`仓库容量`,placeholder:`请输入容量`},{name:`status`,type:`select`,label:`状态`,placeholder:`请选择状态`,options:[{label:`运营中`,value:`active`},{label:`已停用`,value:`inactive`}]}],actions:{showSubmit:!0,showReset:!0,submitText:`保存修改`,resetText:`取消`,align:`right`,onReset:()=>{Y.value=!1}}},{mutate:De}=E({mutationFn:e=>y.createWarehouse({name:e.name,code:e.code,location:e.location,manager:e.manager,phone:e.phone,capacity:Number(e.capacity),status:e.status,productCount:0,usedCapacity:0}),onSuccess:()=>{J.value=!1,Z.value={name:``,code:``,location:``,manager:``,phone:``,capacity:1e3,status:`active`},G()}}),{mutate:Oe,loading:ke}=E({mutationFn:({id:e,values:t})=>y.updateWarehouse(e,{name:t.name,location:t.location,manager:t.manager,phone:t.phone,capacity:Number(t.capacity),status:t.status}),onSuccess:()=>{Y.value=!1,X.value=null,G()}}),{mutate:Ae}=E({mutationFn:e=>y.deleteWarehouse(e),onSuccess:()=>G()});function $(e){X.value=e,Q.value={id:e.id,name:e.name,code:e.code,location:e.location,manager:e.manager,phone:e.phone,capacity:e.capacity,status:e.status},Y.value=!0}function je(e){De(e)}function Me(e){X.value&&Oe({id:X.value.id,values:e})}function Ne(e){Ae(e)}let Pe=u([]);function Fe(e){Pe.value=e}return(n,i)=>(v(),x(`div`,D,[o(`div`,O,[i[9]||=o(`div`,null,[o(`h1`,{class:`text-3xl font-bold tracking-tight`},`仓库管理`),o(`p`,{class:`text-muted-foreground mt-1.5 text-sm`},`管理仓库信息和容量`)],-1),p(h(_),{class:`gap-2`,onClick:i[0]||=e=>J.value=!0},{default:t(()=>[p(h(m),{class:`h-4 w-4`}),i[8]||=a(` 添加仓库 `,-1)]),_:1})]),p(h(C),{open:h(J),"onUpdate:open":i[2]||=e=>d(J)?J.value=e:null,title:`添加仓库`,width:`560`,footer:null},{default:t(()=>[p(h(S),{modelValue:h(Z),"onUpdate:modelValue":i[1]||=e=>d(Z)?Z.value=e:null,schema:Te,onSubmit:je},null,8,[`modelValue`])]),_:1},8,[`open`]),p(h(C),{open:h(Y),"onUpdate:open":i[4]||=e=>d(Y)?Y.value=e:null,title:`编辑仓库`,width:`560`,footer:null},{default:t(()=>[h(X)?(v(),l(h(S),{key:0,modelValue:h(Q),"onUpdate:modelValue":i[3]||=e=>d(Q)?Q.value=e:null,schema:Ee,onSubmit:Me},null,8,[`modelValue`])):te(``,!0)]),_:1},8,[`open`]),o(`div`,k,[(v(!0),x(e,null,ne(h(Se),e=>(v(),x(`div`,{key:e.title,class:`flex items-center gap-3 px-4 py-2.5 bg-muted/50 rounded-lg hover:bg-muted/70 transition-colors`},[(v(),l(re(e.icon),{class:f([`h-4 w-4`,e.color])},null,8,[`class`])),o(`div`,A,[o(`span`,j,c(e.value),1),o(`span`,M,c(e.title),1)])]))),128))]),o(`div`,N,[o(`div`,P,[o(`div`,F,[p(h(S),{modelValue:h(K),"onUpdate:modelValue":i[5]||=e=>d(K)?K.value=e:null,schema:Ce},null,8,[`modelValue`])])])]),p(h(le),{class:`bg-muted/40 border border-border/50 rounded-xl`},{default:t(()=>[p(h(de),{class:`pb-4`},{default:t(()=>[o(`div`,I,[p(h(w),{class:`text-base font-semibold`},{default:t(()=>[...i[10]||=[a(`仓库列表`,-1)]]),_:1}),o(`span`,L,` 共 `+c(h(q).length)+` 个 `,1)])]),_:1}),p(h(ue),{class:`pt-0`},{default:t(()=>[p(h(ce),{ref:`tableRef`,data:h(q),"onUpdate:data":i[7]||=e=>d(q)?q.value=e:null,schema:h(we),onSelectChange:Fe},{name:t(e=>[o(`div`,R,[p(h(g),{class:`h-4 w-4 text-blue-500`}),o(`span`,z,c(e.text),1)])]),location:t(e=>[o(`div`,B,[p(h(ie),{class:`h-3 w-3 text-muted-foreground`}),o(`span`,null,c(e.text),1)])]),manager:t(e=>[o(`div`,V,[p(h(ae),{class:`h-3 w-3 text-muted-foreground`}),o(`span`,null,c(e.text),1)])]),capacity:t(e=>[o(`div`,H,[o(`div`,fe,[o(`span`,null,c(e.record.usedCapacity)+` / `+c(e.text),1),o(`span`,null,c(Math.round(e.record.usedCapacity/e.text*100))+`%`,1)]),o(`div`,pe,[o(`div`,{class:`h-full bg-primary rounded-full`,style:r({width:`${Math.min(e.record.usedCapacity/e.text*100,100)}%`})},null,4)])])]),status:t(e=>[p(h(se),{class:f({"bg-green-500/10 text-green-500 border-green-500/20":e.text===h(b).ACTIVE,"bg-gray-500/10 text-gray-500 border-gray-500/20":e.text===h(b).INACTIVE}),variant:`outline`},{default:t(()=>[a(c(e.text===h(b).ACTIVE?`运营中`:`已停用`),1)]),_:2},1032,[`class`])]),emptyText:t(()=>[o(`div`,me,[o(`div`,he,[p(h(g),{class:`w-8 h-8 text-muted-foreground/50`})]),i[12]||=o(`p`,{class:`text-base font-medium mb-1`},`暂无仓库数据`,-1),i[13]||=o(`p`,{class:`text-sm text-muted-foreground mb-4`},`开始添加您的第一个仓库吧`,-1),p(h(_),{size:`sm`,onClick:i[6]||=e=>J.value=!0},{default:t(()=>[p(h(m),{class:`h-4 w-4 mr-1`}),i[11]||=a(` 添加仓库 `,-1)]),_:1})])]),_:1},8,[`data`,`schema`])]),_:1})]),_:1})]))}});export{ge as default};